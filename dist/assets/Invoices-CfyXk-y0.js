import{j as e,T as n}from"./index-DYLume9J.js";import{r as l}from"./react-vendor-CJgqbvH4.js";import{I as L,a as H}from"./InvoiceReports-BSPmo-K2.js";import{I as U}from"./InvoiceForm-hx3UW63d.js";import{d as P,X as y,j as A}from"./ui-vendor-BUxR0pcK.js";import"./utils-vendor-5vCYNseS.js";import"./query-vendor-GtDMnHGN.js";import"./socket-vendor-TjCxX7sJ.js";import"./DatePicker-qAKHAbTG.js";import"./Modal-CoQB3dYi.js";import"./BarcodeManager-CRNJxaNP.js";import"./SearchableSelect-BHBNN1Xe.js";const E=s=>{switch(s){case"inv-sale":return{title:"فاتورة مبيعات",transactionType:n.INVOICE_SALE,partnerType:"CUSTOMER",partnerLabel:"العميل",isQuote:!1,isReport:!1,color:"teal"};case"inv-purchase":return{title:"فاتورة مشتريات",transactionType:n.INVOICE_PURCHASE,partnerType:"SUPPLIER",partnerLabel:"المورد",isQuote:!1,isReport:!1,color:"slate"};case"inv-ret-sale":return{title:"مرتجع مبيعات",transactionType:n.RETURN_SALE,partnerType:"CUSTOMER",partnerLabel:"العميل",isQuote:!1,isReport:!1,color:"rose"};case"inv-ret-purchase":return{title:"مرتجع مشتريات",transactionType:n.RETURN_PURCHASE,partnerType:"SUPPLIER",partnerLabel:"المورد",isQuote:!1,isReport:!1,color:"indigo"};case"inv-reports":return{title:"تقارير الفواتير",transactionType:n.INVOICE_SALE,partnerType:"CUSTOMER",partnerLabel:"العميل",isQuote:!1,isReport:!0,color:"blue"};default:return{title:"المبيعات",transactionType:n.INVOICE_SALE,partnerType:"CUSTOMER",partnerLabel:"العميل",isQuote:!1,isReport:!1,color:"teal"}}},Y=({viewType:s,partners:v,products:O,productStocks:x,priceLists:b=[],costCenters:I,warehouses:h,onSaveInvoice:g,onDeleteInvoice:p,invoicesHistory:d,systemConfig:T,onAddPartner:S})=>{const[D,o]=l.useState("list"),[r,c]=l.useState(null),[R,a]=l.useState(""),[m,i]=l.useState(""),f=l.useMemo(()=>{if(r){if(r.startsWith("PUR-"))return E("inv-purchase");if(r.startsWith("RET-SALE-"))return E("inv-ret-sale");if(r.startsWith("RET-PUR-"))return E("inv-ret-purchase")}return E(s)},[s,r]);l.useEffect(()=>{if(s.startsWith("inv-edit|")){const t=s.split("|")[1];c(t),o("create")}else o("list"),c(null);a(""),i("")},[s]);const V=()=>{c(null),o("create")},j=t=>{c(t.id),o("create")},B=(t,u)=>{try{if(i(""),!t.partnerId)throw new Error("Partner is required");g(t,u),a("تم حفظ العملية بنجاح"),o("list"),setTimeout(()=>a(""),4e3)}catch(N){throw i(N.message||"حدث خطأ أثناء الحفظ"),window.scrollTo(0,0),N}},C=t=>{if(p)try{p(t),a("تم حذف الفاتورة بنجاح"),setTimeout(()=>a(""),3e3)}catch(u){i(u.message),setTimeout(()=>i(""),5e3)}},F=t=>{confirm("هل تريد تحويل هذا العرض إلى فاتورة مبيعات جديدة؟")&&alert("سيتم تحويلك إلى صفحة المبيعات لإكمال الفاتورة.")};if(f.isReport)return e.jsxDEV(L,{invoices:d},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:116,columnNumber:16},void 0);if(D==="create"){const t=r?d.find(u=>u.id===r):void 0;return e.jsxDEV("div",{className:"h-full relative",children:[m&&e.jsxDEV("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-50 bg-rose-600 text-white px-6 py-3 rounded-xl shadow-xl flex items-center gap-3 animate-bounce",children:[e.jsxDEV(P,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:126,columnNumber:25},void 0)," ",m," ",e.jsxDEV("button",{onClick:()=>i(""),children:e.jsxDEV(y,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:126,columnNumber:98},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:126,columnNumber:61},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:125,columnNumber:21},void 0),e.jsxDEV(U,{config:f,initialData:t,partners:v,priceLists:b,productStocks:x,costCenters:I,warehouses:h,systemConfig:T,invoicesHistory:d,onSave:B,onCancel:()=>o("list"),onAddPartner:S,onDelete:C},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:129,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:123,columnNumber:13},void 0)}return e.jsxDEV("div",{className:"space-y-4 h-full flex flex-col",children:[m&&e.jsxDEV("div",{className:"p-4 bg-rose-50 text-rose-700 rounded-xl flex items-center gap-3 border border-rose-100 animate-fade-in",children:[e.jsxDEV(P,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:152,columnNumber:143},void 0)," ",m]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:152,columnNumber:23},void 0),R&&e.jsxDEV("div",{className:"p-4 bg-emerald-50 text-emerald-700 rounded-xl flex items-center gap-3 border border-emerald-100 animate-fade-in",children:[e.jsxDEV(A,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:153,columnNumber:154},void 0)," ",R]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:153,columnNumber:25},void 0),e.jsxDEV(H,{invoices:d,config:f,onCreate:V,onEdit:j,onDelete:C,onConvertQuote:F},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:155,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/pages/Invoices.tsx",lineNumber:151,columnNumber:9},void 0)};export{Y as Invoices};
