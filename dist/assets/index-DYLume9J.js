const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-DSiDojuC.js","assets/react-vendor-CJgqbvH4.js","assets/utils-vendor-5vCYNseS.js","assets/ui-vendor-BUxR0pcK.js","assets/query-vendor-GtDMnHGN.js","assets/socket-vendor-TjCxX7sJ.js","assets/web-BM8CE2Hq.js","assets/index-DLk8l80k.js","assets/DashboardV2-GMjWRwvh.js","assets/offlineApi-BCxxwElk.js","assets/Invoices-CfyXk-y0.js","assets/InvoiceReports-BSPmo-K2.js","assets/DatePicker-qAKHAbTG.js","assets/Modal-CoQB3dYi.js","assets/InvoiceForm-hx3UW63d.js","assets/BarcodeManager-CRNJxaNP.js","assets/SearchableSelect-BHBNN1Xe.js","assets/InvoicesV2-K41XWRZo.js","assets/DeletedInvoices-BYWnBbFE.js","assets/InventoryV2-BpyJ_Xdm.js","assets/AccountingV2-CgPn016f.js","assets/TreasuryV2-1twIJLVh.js","assets/Customers-CWRHd03Q.js","assets/DiscountManager-BrDqoDlB.js","assets/CustomerAgingReport-D8Psr9Bq.js","assets/CustomersV2-BA1BNIxN.js","assets/Suppliers-DCvOJXqT.js","assets/SupplierAgingReport-CJVZgDq-.js","assets/SuppliersV2-BBYYoH8s.js","assets/Settings-aV1E7TGe.js","assets/PriceListMaster-DQoymQ-K.js","assets/MasterDataV2-CT3l-oxX.js","assets/Manufacturing-BZz3vo-S.js","assets/Employees-DRUCcvOL.js","assets/Attendance-CmPPa6r9.js","assets/Payroll-at1elLZV.js","assets/AdvancesTemplates-CGwJdeGt.js","assets/PayrollTemplates-DcGxtIvG.js","assets/VanSales-kuQ8Gg0T.js","assets/SalesTeam-iQ5xulAW.js","assets/POS-RPHZVnRy.js","assets/POSShifts-D9p0Hv85.js","assets/POSReports-CWFy5HPe.js"])))=>i.map(i=>d[i]);
import{r as b,R as Ns,a as gn,b as xn}from"./react-vendor-CJgqbvH4.js";import{_ as he,v as st}from"./utils-vendor-5vCYNseS.js";import{H as Rs,D as Ss,T as Gt,U as Ht,C as Ds,S as Ot,P as zt,F as As,L as Is,W as ms,a as Wt,b as Fs,c as Cs,d as _t,e as Es,f as Ps,g as fs,h as Qt,A as wn,i as Tn,j as ts,I as Ln,X as ss,B as Sn,k as zs,l as Dn,m as An,n as In,o as js,Z as Fn,p as Ws,R as rs,q as Bs,r as ys,s as ps,t as jn,G as Bn,E as kn,u as ks,v as Ks,M as Vn,w as On,x as Vs,y as ns,z as Hn,J as _n,K as Un,N as $n}from"./ui-vendor-BUxR0pcK.js";import{u as Ae,a as Ys,Q as Mn,b as qn}from"./query-vendor-GtDMnHGN.js";import{l as Xn}from"./socket-vendor-TjCxX7sJ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();var Js={exports:{}},vs={};(function(){var t=b,e=Symbol.for("react.element"),s=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),c=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen"),I=Symbol.iterator,x="@@iterator";function S(i){if(i===null||typeof i!="object")return null;var w=I&&i[I]||i[x];return typeof w=="function"?w:null}var X=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Y(i){{for(var w=arguments.length,j=new Array(w>1?w-1:0),ne=1;ne<w;ne++)j[ne-1]=arguments[ne];U("error",i,j)}}function U(i,w,j){{var ne=X.ReactDebugCurrentFrame,pe=ne.getStackAddendum();pe!==""&&(w+="%s",j=j.concat([pe]));var Re=j.map(function(fe){return String(fe)});Re.unshift("Warning: "+w),Function.prototype.apply.call(console[i],console,Re)}}var te=!1,V=!1,G=!1,ie=!1,ue=!1,h;h=Symbol.for("react.module.reference");function k(i){return!!(typeof i=="string"||typeof i=="function"||i===n||i===r||ue||i===a||i===y||i===C||ie||i===m||te||V||G||typeof i=="object"&&i!==null&&(i.$$typeof===N||i.$$typeof===P||i.$$typeof===d||i.$$typeof===c||i.$$typeof===p||i.$$typeof===h||i.getModuleId!==void 0))}function J(i,w,j){var ne=i.displayName;if(ne)return ne;var pe=w.displayName||w.name||"";return pe!==""?j+"("+pe+")":j}function se(i){return i.displayName||"Context"}function T(i){if(i==null)return null;if(typeof i.tag=="number"&&Y("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case n:return"Fragment";case s:return"Portal";case r:return"Profiler";case a:return"StrictMode";case y:return"Suspense";case C:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case c:var w=i;return se(w)+".Consumer";case d:var j=i;return se(j._context)+".Provider";case p:return J(i,i.render,"ForwardRef");case P:var ne=i.displayName||null;return ne!==null?ne:T(i.type)||"Memo";case N:{var pe=i,Re=pe._payload,fe=pe._init;try{return T(fe(Re))}catch{return null}}}return null}var D=Object.assign,oe=0,ve,ge,Ne,be,Fe,R,K;function Q(){}Q.__reactDisabledLog=!0;function de(){{if(oe===0){ve=console.log,ge=console.info,Ne=console.warn,be=console.error,Fe=console.group,R=console.groupCollapsed,K=console.groupEnd;var i={configurable:!0,enumerable:!0,value:Q,writable:!0};Object.defineProperties(console,{info:i,log:i,warn:i,error:i,group:i,groupCollapsed:i,groupEnd:i})}oe++}}function xe(){{if(oe--,oe===0){var i={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:D({},i,{value:ve}),info:D({},i,{value:ge}),warn:D({},i,{value:Ne}),error:D({},i,{value:be}),group:D({},i,{value:Fe}),groupCollapsed:D({},i,{value:R}),groupEnd:D({},i,{value:K})})}oe<0&&Y("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var je=X.ReactCurrentDispatcher,ke;function nt(i,w,j){{if(ke===void 0)try{throw Error()}catch(pe){var ne=pe.stack.trim().match(/\n( *(at )?)/);ke=ne&&ne[1]||""}return`
`+ke+i}}var _e=!1,Ye;{var jt=typeof WeakMap=="function"?WeakMap:Map;Ye=new jt}function we(i,w){if(!i||_e)return"";{var j=Ye.get(i);if(j!==void 0)return j}var ne;_e=!0;var pe=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Re;Re=je.current,je.current=null,de();try{if(w){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(Ke){ne=Ke}Reflect.construct(i,[],fe)}else{try{fe.call()}catch(Ke){ne=Ke}i.call(fe.prototype)}}else{try{throw Error()}catch(Ke){ne=Ke}i()}}catch(Ke){if(Ke&&ne&&typeof Ke.stack=="string"){for(var ce=Ke.stack.split(`
`),qe=ne.stack.split(`
`),Le=ce.length-1,ye=qe.length-1;Le>=1&&ye>=0&&ce[Le]!==qe[ye];)ye--;for(;Le>=1&&ye>=0;Le--,ye--)if(ce[Le]!==qe[ye]){if(Le!==1||ye!==1)do if(Le--,ye--,ye<0||ce[Le]!==qe[ye]){var tt=`
`+ce[Le].replace(" at new "," at ");return i.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",i.displayName)),typeof i=="function"&&Ye.set(i,tt),tt}while(Le>=1&&ye>=0);break}}}finally{_e=!1,je.current=Re,xe(),Error.prepareStackTrace=pe}var dt=i?i.displayName||i.name:"",pt=dt?nt(dt):"";return typeof i=="function"&&Ye.set(i,pt),pt}function Dt(i,w,j){return we(i,!1)}function Ce(i){var w=i.prototype;return!!(w&&w.isReactComponent)}function Ue(i,w,j){if(i==null)return"";if(typeof i=="function")return we(i,Ce(i));if(typeof i=="string")return nt(i);switch(i){case y:return nt("Suspense");case C:return nt("SuspenseList")}if(typeof i=="object")switch(i.$$typeof){case p:return Dt(i.render);case P:return Ue(i.type,w,j);case N:{var ne=i,pe=ne._payload,Re=ne._init;try{return Ue(Re(pe),w,j)}catch{}}}return""}var ct=Object.prototype.hasOwnProperty,Bt={},yt=X.ReactDebugCurrentFrame;function Rt(i){if(i){var w=i._owner,j=Ue(i.type,i._source,w?w.type:null);yt.setExtraStackFrame(j)}else yt.setExtraStackFrame(null)}function kt(i,w,j,ne,pe){{var Re=Function.call.bind(ct);for(var fe in i)if(Re(i,fe)){var ce=void 0;try{if(typeof i[fe]!="function"){var qe=Error((ne||"React class")+": "+j+" type `"+fe+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof i[fe]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw qe.name="Invariant Violation",qe}ce=i[fe](w,fe,ne,j,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Le){ce=Le}ce&&!(ce instanceof Error)&&(Rt(pe),Y("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",ne||"React class",j,fe,typeof ce),Rt(null)),ce instanceof Error&&!(ce.message in Bt)&&(Bt[ce.message]=!0,Rt(pe),Y("Failed %s type: %s",j,ce.message),Rt(null))}}}var ot=Array.isArray;function at(i){return ot(i)}function vt(i){{var w=typeof Symbol=="function"&&Symbol.toStringTag,j=w&&i[Symbol.toStringTag]||i.constructor.name||"Object";return j}}function rt(i){try{return Ct(i),!1}catch{return!0}}function Ct(i){return""+i}function gt(i){if(rt(i))return Y("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",vt(i)),Ct(i)}var Je=X.ReactCurrentOwner,Be={key:!0,ref:!0,__self:!0,__source:!0},Ze,At,$e;$e={};function It(i){if(ct.call(i,"ref")){var w=Object.getOwnPropertyDescriptor(i,"ref").get;if(w&&w.isReactWarning)return!1}return i.ref!==void 0}function it(i){if(ct.call(i,"key")){var w=Object.getOwnPropertyDescriptor(i,"key").get;if(w&&w.isReactWarning)return!1}return i.key!==void 0}function Vt(i,w){if(typeof i.ref=="string"&&Je.current&&w&&Je.current.stateNode!==w){var j=T(Je.current.type);$e[j]||(Y('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',T(Je.current.type),i.ref),$e[j]=!0)}}function lt(i,w){{var j=function(){Ze||(Ze=!0,Y("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",w))};j.isReactWarning=!0,Object.defineProperty(i,"key",{get:j,configurable:!0})}}function xt(i,w){{var j=function(){At||(At=!0,Y("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",w))};j.isReactWarning=!0,Object.defineProperty(i,"ref",{get:j,configurable:!0})}}var ht=function(i,w,j,ne,pe,Re,fe){var ce={$$typeof:e,type:i,key:w,ref:j,props:fe,_owner:Re};return ce._store={},Object.defineProperty(ce._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(ce,"_self",{configurable:!1,enumerable:!1,writable:!1,value:ne}),Object.defineProperty(ce,"_source",{configurable:!1,enumerable:!1,writable:!1,value:pe}),Object.freeze&&(Object.freeze(ce.props),Object.freeze(ce)),ce};function Yt(i,w,j,ne,pe){{var Re,fe={},ce=null,qe=null;j!==void 0&&(gt(j),ce=""+j),it(w)&&(gt(w.key),ce=""+w.key),It(w)&&(qe=w.ref,Vt(w,pe));for(Re in w)ct.call(w,Re)&&!Be.hasOwnProperty(Re)&&(fe[Re]=w[Re]);if(i&&i.defaultProps){var Le=i.defaultProps;for(Re in Le)fe[Re]===void 0&&(fe[Re]=Le[Re])}if(ce||qe){var ye=typeof i=="function"?i.displayName||i.name||"Unknown":i;ce&&lt(fe,ye),qe&&xt(fe,ye)}return ht(i,ce,qe,pe,ne,Je.current,fe)}}var et=X.ReactCurrentOwner,Et=X.ReactDebugCurrentFrame;function Me(i){if(i){var w=i._owner,j=Ue(i.type,i._source,w?w.type:null);Et.setExtraStackFrame(j)}else Et.setExtraStackFrame(null)}var ft;ft=!1;function We(i){return typeof i=="object"&&i!==null&&i.$$typeof===e}function qt(){{if(et.current){var i=T(et.current.type);if(i)return`

Check the render method of \``+i+"`."}return""}}function u(i){{if(i!==void 0){var w=i.fileName.replace(/^.*[\\\/]/,""),j=i.lineNumber;return`

Check your code at `+w+":"+j+"."}return""}}var v={};function M(i){{var w=qt();if(!w){var j=typeof i=="string"?i:i.displayName||i.name;j&&(w=`

Check the top-level render call using <`+j+">.")}return w}}function Ve(i,w){{if(!i._store||i._store.validated||i.key!=null)return;i._store.validated=!0;var j=M(w);if(v[j])return;v[j]=!0;var ne="";i&&i._owner&&i._owner!==et.current&&(ne=" It was passed a child from "+T(i._owner.type)+"."),Me(i),Y('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',j,ne),Me(null)}}function Z(i,w){{if(typeof i!="object")return;if(at(i))for(var j=0;j<i.length;j++){var ne=i[j];We(ne)&&Ve(ne,w)}else if(We(i))i._store&&(i._store.validated=!0);else if(i){var pe=S(i);if(typeof pe=="function"&&pe!==i.entries)for(var Re=pe.call(i),fe;!(fe=Re.next()).done;)We(fe.value)&&Ve(fe.value,w)}}}function $(i){{var w=i.type;if(w==null||typeof w=="string")return;var j;if(typeof w=="function")j=w.propTypes;else if(typeof w=="object"&&(w.$$typeof===p||w.$$typeof===P))j=w.propTypes;else return;if(j){var ne=T(w);kt(j,i.props,"prop",ne,i)}else if(w.PropTypes!==void 0&&!ft){ft=!0;var pe=T(w);Y("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",pe||"Unknown")}typeof w.getDefaultProps=="function"&&!w.getDefaultProps.isReactClassApproved&&Y("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Pe(i){{for(var w=Object.keys(i.props),j=0;j<w.length;j++){var ne=w[j];if(ne!=="children"&&ne!=="key"){Me(i),Y("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",ne),Me(null);break}}i.ref!==null&&(Me(i),Y("Invalid attribute `ref` supplied to `React.Fragment`."),Me(null))}}var re={};function le(i,w,j,ne,pe,Re){{var fe=k(i);if(!fe){var ce="";(i===void 0||typeof i=="object"&&i!==null&&Object.keys(i).length===0)&&(ce+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var qe=u(pe);qe?ce+=qe:ce+=qt();var Le;i===null?Le="null":at(i)?Le="array":i!==void 0&&i.$$typeof===e?(Le="<"+(T(i.type)||"Unknown")+" />",ce=" Did you accidentally export a JSX literal instead of a component?"):Le=typeof i,Y("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Le,ce)}var ye=Yt(i,w,j,pe,Re);if(ye==null)return ye;if(fe){var tt=w.children;if(tt!==void 0)if(ne)if(at(tt)){for(var dt=0;dt<tt.length;dt++)Z(tt[dt],i);Object.freeze&&Object.freeze(tt)}else Y("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Z(tt,i)}if(ct.call(w,"key")){var pt=T(i),Ke=Object.keys(w).filter(function(cs){return cs!=="key"}),Xt=Ke.length>0?"{key: someKey, "+Ke.join(": ..., ")+": ...}":"{key: someKey}";if(!re[pt+Xt]){var us=Ke.length>0?"{"+Ke.join(": ..., ")+": ...}":"{}";Y(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Xt,pt,us,pt),re[pt+Xt]=!0}}return i===n?Pe(ye):$(ye),ye}}var Ge=le;vs.Fragment=n,vs.jsxDEV=Ge})();Js.exports=vs;var o=Js.exports;const zn={ar:{appName:"DaftriX ERP",dashboard:"الشاشة الرئيسية",home:"الرئيسية",save:"حفظ",cancel:"إلغاء",delete:"حذف",edit:"تعديل",search:"بحث...",export:"تصدير",print:"طباعة",actions:"إجراءات",active:"نشط",inactive:"غير نشط",status:"الحالة",date:"التاريخ",time:"الوقت",total:"الإجمالي",subtotal:"المجموع الفرعي",discount:"الخصم",tax:"الضريبة",amount:"المبلغ",quantity:"الكمية",price:"السعر",name:"الاسم",code:"الرمز",notes:"ملاحظات",add:"إضافة",new:"جديد",view:"عرض",details:"التفاصيل",close:"إغلاق",submit:"إرسال",confirm:"تأكيد",confirmDelete:"تأكيد الحذف",deleteMessage:"هل أنت متأكد من حذف هذا العنصر؟ لا يمكن التراجع عن هذا الإجراء.",successSave:"تم الحفظ بنجاح",errorSave:"حدث خطأ أثناء الحفظ",loading:"جاري التحميل...",noData:"لا توجد بيانات",selectOption:"اختر...",all:"الكل",filter:"تصفية",from:"من",to:"إلى",yes:"نعم",no:"لا",masterData:"البيانات الأساسية",products:"الأصناف",productMaster:"كارت الصنف",categories:"التصنيفات",units:"وحدات القياس",partners:"العملاء والموردين",customers:"العملاء",suppliers:"الموردين",partnerMaster:"كارت عميل/مورد",partnerGroups:"مجموعات الشركاء",sales:"المبيعات",salesInvoices:"فواتير البيع",salesReturns:"مرتجعات المبيعات",quotations:"عروض الأسعار",salesmen:"المندوبين",purchases:"المشتريات",purchaseInvoices:"فواتير الشراء",purchaseReturns:"مرتجعات المشتريات",purchaseOrders:"أوامر الشراء",inventory:"المخزون",warehouses:"المستودعات",stockMovement:"حركة المخزون",stockAdjustment:"تسوية المخزون",inventoryReports:"تقارير المخزون",itemMovement:"حركة صنف",stockPermits:"إذن إضافة",accounting:"الحسابات العامة",chartOfAccounts:"دليل الحسابات",journalEntries:"قيود اليومية",generalLedger:"الأستاذ العام",trialBalance:"ميزان المراجعة",balanceSheet:"الميزانية العمومية",incomeStatement:"قائمة الدخل",accountStatement:"كشف حساب",costCenters:"مراكز التكلفة",treasury:"الخزينة",treasuryJournal:"يومية الخزينة",cashVoucher:"سند صرف/قبض",dailyCash:"اليومية النقدية",partnerPayment:"دفعة عميل/مورد",internalTransfer:"تحويل داخلي",cashCategories:"فئات الحركات النقدية",banks:"البنوك",bankAccounts:"الحسابات البنكية",bankStatement:"كشف حساب بنكي",checks:"الشيكات",checksReceivable:"شيكات برسم التحصيل",checksPayable:"شيكات برسم الدفع",manufacturing:"التصنيع",bomList:"قوائم المكونات (BOM)",productionOrders:"أوامر الإنتاج",workCenters:"مراكز العمل",reports:"التقارير",financialReports:"التقارير المالية",salesReports:"تقارير المبيعات",purchaseReports:"تقارير المشتريات",inventoryReportsMenu:"تقارير المخزون",auditLogs:"سجل المراجعة",settings:"الإعدادات",systemSettings:"إعدادات النظام",companyInfo:"بيانات الشركة",users:"المستخدمين",roles:"الصلاحيات",branches:"الفروع",taxSettings:"إعدادات الضرائب",backup:"النسخ الاحتياطي",newProduct:"صنف جديد",editProduct:"تعديل بيانات الصنف",productName:"اسم الصنف",sku:"كود الصنف",barcode:"الباركود",category:"التصنيف",productType:"نوع الصنف",description:"الوصف",basicInfo:"البيانات الأساسية",pricing:"التسعير والتكلفة",inventoryTab:"المخزون",media:"الصور والملفات",purchasePrice:"سعر الشراء",sellingPrice:"سعر البيع",taxRate:"نسبة الضريبة (%)",unit:"وحدة القياس",minStock:"الحد الأدنى",maxStock:"الحد الأقصى",currentStock:"المخزون الحالي",trackInventory:"تتبع المخزون",priceLists:"قوائم الأسعار",noProducts:"لا توجد أصناف",autoGen:"توليد تلقائي",currency:"ج.م",productList:"قائمة الأصناف",unitPcs:"قطعة",unitKg:"كيلوجرام",unitM:"متر",unitBox:"علبة",unitLiter:"لتر",typeProduct:"منتج مخزني",typeService:"خدمة",typeConsumable:"مستهلك",typeRawMaterial:"مادة خام",invoice:"فاتورة",invoiceNumber:"رقم الفاتورة",invoiceDate:"تاريخ الفاتورة",dueDate:"تاريخ الاستحقاق",customer:"العميل",supplier:"المورد",items:"الأصناف",addItem:"إضافة صنف",totalAmount:"الإجمالي",paid:"مدفوع",unpaid:"غير مدفوع",partial:"مدفوع جزئياً",paymentStatus:"حالة الدفع",paymentMethod:"طريقة الدفع",cash:"نقدي",credit:"آجل",bank:"بنك",partner:"شريك",partnerName:"اسم الشريك",partnerType:"نوع الشريك",phone:"الهاتف",email:"البريد الإلكتروني",address:"العنوان",taxNumber:"الرقم الضريبي",creditLimit:"حد الائتمان",balance:"الرصيد",debit:"مدين",credit2:"دائن",account:"حساب",accountName:"اسم الحساب",accountCode:"رقم الحساب",accountType:"نوع الحساب",parentAccount:"الحساب الأب",debitBalance:"رصيد مدين",creditBalance:"رصيد دائن",journalEntry:"قيد يومية",entryDate:"تاريخ القيد",reference:"المرجع",debitAmount:"المبلغ المدين",creditAmount:"المبلغ الدائن",treasury2:"خزينة",treasuryName:"اسم الخزينة",cashIn:"قبض",cashOut:"صرف",voucherNumber:"رقم السند",voucherType:"نوع السند",receivedFrom:"مقبوض من",paidTo:"مدفوع لـ",bankName:"اسم البنك",accountNumber:"رقم الحساب",iban:"IBAN",swiftCode:"رمز SWIFT",checkNumber:"رقم الشيك",checkDate:"تاريخ الشيك",checkStatus:"حالة الشيك",pending:"معلق",cleared:"محصل",bounced:"مرتد",report:"تقرير",reportName:"اسم التقرير",dateRange:"الفترة الزمنية",generate:"إنشاء",downloadPDF:"تحميل PDF",downloadExcel:"تحميل Excel",login:"تسجيل الدخول",logout:"تسجيل الخروج",username:"اسم المستخدم",password:"كلمة المرور",profile:"الملف الشخصي",changePassword:"تغيير كلمة المرور",user:"مستخدم",role:"الدور",permissions:"الصلاحيات",welcome:"مرحباً",notifications:"التنبيهات",onlineUsers:"المستخدمون المتصلون",searchAnything:"ابحث عن أي شيء...",noResults:"لا توجد نتائج",selectLanguage:"اختر اللغة",arabic:"العربية",english:"الإنجليزية"},en:{appName:"DaftriX ERP",dashboard:"Dashboard",home:"Home",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",search:"Search...",export:"Export",print:"Print",actions:"Actions",active:"Active",inactive:"Inactive",status:"Status",date:"Date",time:"Time",total:"Total",subtotal:"Subtotal",discount:"Discount",tax:"Tax",amount:"Amount",quantity:"Quantity",price:"Price",name:"Name",code:"Code",notes:"Notes",add:"Add",new:"New",view:"View",details:"Details",close:"Close",submit:"Submit",confirm:"Confirm",confirmDelete:"Confirm Delete",deleteMessage:"Are you sure you want to delete this item? This action cannot be undone.",successSave:"Saved successfully",errorSave:"Error saving data",loading:"Loading...",noData:"No data available",selectOption:"Select...",all:"All",filter:"Filter",from:"From",to:"To",yes:"Yes",no:"No",masterData:"Master Data",products:"Products",productMaster:"Product Master",categories:"Categories",units:"Units of Measure",partners:"Partners",customers:"Customers",suppliers:"Suppliers",partnerMaster:"Partner Master",partnerGroups:"Partner Groups",sales:"Sales",salesInvoices:"Sales Invoices",salesReturns:"Sales Returns",quotations:"Quotations",salesmen:"Salesmen",purchases:"Purchases",purchaseInvoices:"Purchase Invoices",purchaseReturns:"Purchase Returns",purchaseOrders:"Purchase Orders",inventory:"Inventory",warehouses:"Warehouses",stockMovement:"Stock Movement",stockAdjustment:"Stock Adjustment",inventoryReports:"Inventory Reports",itemMovement:"Item Movement",stockPermits:"Stock Permits",accounting:"Accounting",chartOfAccounts:"Chart of Accounts",journalEntries:"Journal Entries",generalLedger:"General Ledger",trialBalance:"Trial Balance",balanceSheet:"Balance Sheet",incomeStatement:"Income Statement",accountStatement:"Account Statement",costCenters:"Cost Centers",treasury:"Treasury",treasuryJournal:"Treasury Journal",cashVoucher:"Cash Voucher",dailyCash:"Daily Cash",partnerPayment:"Partner Payment",internalTransfer:"Internal Transfer",cashCategories:"Cash Categories",banks:"Banks",bankAccounts:"Bank Accounts",bankStatement:"Bank Statement",checks:"Checks",checksReceivable:"Checks Receivable",checksPayable:"Checks Payable",manufacturing:"Manufacturing",bomList:"Bill of Materials (BOM)",productionOrders:"Production Orders",workCenters:"Work Centers",reports:"Reports",financialReports:"Financial Reports",salesReports:"Sales Reports",purchaseReports:"Purchase Reports",inventoryReportsMenu:"Inventory Reports",auditLogs:"Audit Logs",settings:"Settings",systemSettings:"System Settings",companyInfo:"Company Information",users:"Users",roles:"Roles",branches:"Branches",taxSettings:"Tax Settings",backup:"Backup",newProduct:"New Product",editProduct:"Edit Product",productName:"Product Name",sku:"SKU",barcode:"Barcode",category:"Category",productType:"Product Type",description:"Description",basicInfo:"Basic Information",pricing:"Pricing & Cost",inventoryTab:"Inventory",media:"Media & Files",purchasePrice:"Purchase Price",sellingPrice:"Selling Price",taxRate:"Tax Rate (%)",unit:"Unit of Measure",minStock:"Minimum Stock",maxStock:"Maximum Stock",currentStock:"Current Stock",trackInventory:"Track Inventory",priceLists:"Price Lists",noProducts:"No products found",autoGen:"Auto-Generate",currency:"EGP",productList:"Product List",unitPcs:"Piece (PCS)",unitKg:"Kilogram (KG)",unitM:"Meter (M)",unitBox:"Box",unitLiter:"Liter",typeProduct:"Stock Product",typeService:"Service",typeConsumable:"Consumable",typeRawMaterial:"Raw Material",invoice:"Invoice",invoiceNumber:"Invoice Number",invoiceDate:"Invoice Date",dueDate:"Due Date",customer:"Customer",supplier:"Supplier",items:"Items",addItem:"Add Item",totalAmount:"Total Amount",paid:"Paid",unpaid:"Unpaid",partial:"Partially Paid",paymentStatus:"Payment Status",paymentMethod:"Payment Method",cash:"Cash",credit:"Credit",bank:"Bank",partner:"Partner",partnerName:"Partner Name",partnerType:"Partner Type",phone:"Phone",email:"Email",address:"Address",taxNumber:"Tax Number",creditLimit:"Credit Limit",balance:"Balance",debit:"Debit",credit2:"Credit",account:"Account",accountName:"Account Name",accountCode:"Account Code",accountType:"Account Type",parentAccount:"Parent Account",debitBalance:"Debit Balance",creditBalance:"Credit Balance",journalEntry:"Journal Entry",entryDate:"Entry Date",reference:"Reference",debitAmount:"Debit Amount",creditAmount:"Credit Amount",treasury2:"Treasury",treasuryName:"Treasury Name",cashIn:"Cash In",cashOut:"Cash Out",voucherNumber:"Voucher Number",voucherType:"Voucher Type",receivedFrom:"Received From",paidTo:"Paid To",bankName:"Bank Name",accountNumber:"Account Number",iban:"IBAN",swiftCode:"SWIFT Code",checkNumber:"Check Number",checkDate:"Check Date",checkStatus:"Check Status",pending:"Pending",cleared:"Cleared",bounced:"Bounced",report:"Report",reportName:"Report Name",dateRange:"Date Range",generate:"Generate",downloadPDF:"Download PDF",downloadExcel:"Download Excel",login:"Login",logout:"Logout",username:"Username",password:"Password",profile:"Profile",changePassword:"Change Password",user:"User",role:"Role",permissions:"Permissions",welcome:"Welcome",notifications:"Notifications",onlineUsers:"Online Users",searchAnything:"Search anything...",noResults:"No results found",selectLanguage:"Select Language",arabic:"Arabic",english:"English"}},Gs=b.createContext(void 0),Wn=({children:t})=>{const[e,s]=b.useState(()=>localStorage.getItem("app_language")||"ar"),n=d=>{s(d),localStorage.setItem("app_language",d),document.documentElement.dir=d==="ar"?"rtl":"ltr",document.documentElement.lang=d};b.useEffect(()=>{document.documentElement.dir=e==="ar"?"rtl":"ltr",document.documentElement.lang=e},[e]);const a=d=>zn[e][d]||d,r=e==="ar"?"rtl":"ltr";return o.jsxDEV(Gs.Provider,{value:{language:e,setLanguage:n,t:a,dir:r},children:t},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/contexts/LanguageContext.tsx",lineNumber:42,columnNumber:9},void 0)},Kn=()=>{const t=b.useContext(Gs);if(t===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return t},Qs=8*60*60*1e3,Yn=5*60*1e3,Jn=(t,e=!1)=>{const s=e?2592e6:Qs,n=Date.now()+s,a={user:t,expiresAt:n,lastActivity:Date.now(),rememberMe:e};localStorage.setItem("session",JSON.stringify(a)),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("currentUser",JSON.stringify(t))},is=()=>{const t=localStorage.getItem("session");if(!t)return null;try{return JSON.parse(t)}catch{return null}},ls=()=>{const t=localStorage.getItem("currentUser");if(!t)return null;try{return JSON.parse(t)}catch{return null}},Gn=()=>{const t=is();return t?Date.now()<t.expiresAt:!1},Qn=()=>{const t=is();t&&(t.lastActivity=Date.now(),localStorage.setItem("session",JSON.stringify(t)))},Zs=()=>{const t=is();return t?Math.max(0,t.expiresAt-Date.now()):0},Zn=()=>{const t=Zs();return t>0&&t<=Yn},gs=()=>{localStorage.removeItem("session"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("currentUser")},eo=()=>{const t=is();if(!t)return;const e=t.rememberMe?30*24*60*60*1e3:Qs;t.expiresAt=Date.now()+e,t.lastActivity=Date.now(),localStorage.setItem("session",JSON.stringify(t))},to=()=>{const e=ls()?.role?.toUpperCase();return e==="ADMIN"||e==="MASTER_ADMIN"},en=t=>{const e=ls();if(!e)return!1;const s=e.role?.toUpperCase();return s==="ADMIN"||s==="MASTER_ADMIN"||e.permissions?.includes("all")?!0:e.permissions?.includes(t)||!1},tn=t=>{const e=ls();if(!e)return!1;const s=e.role?.toUpperCase();return s==="ADMIN"||s==="MASTER_ADMIN"||e.permissions?.includes("all")?!0:t.some(n=>e.permissions?.includes(n))},so=t=>{const e=ls();if(!e)return!1;const s=e.role?.toUpperCase();if(s==="ADMIN"||s==="MASTER_ADMIN")return!0;const a={invoices:["sales.view","sales.create","purchase.view","purchase.create"],inventory:["inventory.view","inventory.manage"],accounting:["accounting.view","accounting.manage"],treasury:["treasury.view","treasury.manage"],customers:["customers.view","customers.manage"],suppliers:["suppliers.view","suppliers.manage"],settings:"system.settings",manufacturing:["manufacturing.view","manufacturing.manage"],reports:"reports.view","master-customers":["customers.view","customers.manage"],"master-suppliers":["suppliers.view","suppliers.manage"],"master-branches":"master.branches","master-warehouses":["inventory.view","master.warehouses"],"master-categories":["inventory.view","master.categories"],"master-price-lists":["sales.view","master.price_lists"],"master-items":["inventory.view","inventory.manage"],"master-banks":["treasury.view","master.banks"],"master-salesmen":["salesteam.view","master.salesmen"],"sup-payments":["suppliers.payments","treasury.payment"],"sup-statement":["suppliers.statement","suppliers.view"],"sup-balances":["suppliers.balances","suppliers.view"],"sup-discount":"suppliers.discount","cust-payments":["customers.payments","treasury.receipt"],"cust-statement":["customers.statement","customers.view"],"cust-balances":["customers.balances","customers.view"],"cust-prices":"customers.prices","cust-discount":"customers.discount","inv-sale":["sales.view","sales.create"],"inv-purchase":["purchase.view","purchase.create"],"inv-ret-sale":["sales.view","sales.return"],"inv-ret-purchase":["purchase.view","purchase.return"],"inv-reports":["sales.view","purchase.view","reports.view"],"inv-deleted":"system.settings","stock-balance":"inventory.view","stock-period-report":"inventory.view","stock-value":"inventory.view_value","item-movement":"inventory.view","item-profits":["inventory.view","sales.view"],"stock-taking":"inventory.stock_taking","permit-in":"inventory.permit_in","permit-out":"inventory.permit_out","permit-transfer-br":"inventory.transfer","barcode-print":"inventory.barcode","low-stock":"inventory.view","manufacturing-dashboard":"manufacturing.view","production-orders":"manufacturing.production","bom-manager":"manufacturing.bom","stock-movements":["manufacturing.view","inventory.view"],"money-transfer":"treasury.transfer",banks:"treasury.view_balance","bank-recon":"treasury.bank_recon",cheques:"treasury.cheques","daily-cash":"treasury.manage","treasury-journal":"treasury.view","treasury-report":["treasury.view","reports.treasury"],"monthly-profit":["treasury.view","reports.financial"],installments:"treasury.manage",journal:"accounting.journal","general-ledger":"accounting.view","fixed-assets":"accounting.assets",coa:"accounting.view","cost-centers":"accounting.cost_centers","trial-balance":["accounting.view","reports.financial"],"balance-sheet":["accounting.view","reports.financial"],"income-statement":["accounting.view","reports.financial"],users:"system.users",config:"system.settings","data-migration":"system.migration","audit-log":"system.audit",backup:"system.backup","hr-employees":["hr.view","hr.manage"],"hr-attendance":"hr.attendance","hr-payroll":"hr.payroll","hr-advances":"hr.advances","van-vehicles":["vansales.view","vansales.manage"],"van-inventory":["vansales.view","vansales.manage"],"van-operations":["vansales.view","vansales.manage"],"van-visits":["vansales.view","vansales.manage"],"van-settlements":["vansales.view","vansales.manage"],"van-routes":["vansales.view","vansales.manage"],"van-reports":["vansales.view","reports.view"],"salesteam-dashboard":"salesteam.view","salesteam-targets":"salesteam.targets","salesteam-performance":["salesteam.view","reports.view"],"salesteam-commissions":"salesteam.commissions","salesteam-commission-report":["salesteam.commissions","reports.view"]}[t];return a?Array.isArray(a)?tn(a):en(a):!0},Os=Ns.memo(({children:t,currentView:e,onChangeView:s,globalData:n,onLogout:a,systemConfig:r,onUpdateConfig:d,onSystemReset:c,onlineUsers:p})=>{const{language:y,setLanguage:C}=Kn(),[P,N]=b.useState(!1),[m,I]=b.useState(()=>localStorage.getItem("sidebarCollapsed")==="true"),x=u=>{I(u),localStorage.setItem("sidebarCollapsed",String(u))},[S,X]=b.useState("inventory"),[Y,U]=b.useState(null),te=[{id:"dashboard",label:"الرئيسية",icon:Rs},{id:"inv-sale",label:"فاتورة",icon:Ot},{id:"stock-balance",label:"المخزون",icon:zt},{id:"treasury-journal",label:"الخزينة",icon:ms}],[V,G]=b.useState(()=>{const u=localStorage.getItem("currentUser");return u?JSON.parse(u):{name:"المدير العام",email:"admin@system.com"}}),ie=b.useMemo(()=>!V||["ADMIN","admin","MANAGER","manager","GENERAL_MANAGER","المدير","المدير العام","مسئول النظام"].includes(V.role)?!1:!!(["SALESMAN","salesman","SALES","sales","مبيعات","مندوب"].includes(V.role)||V.vehicleId),[V]),[ue,h]=b.useState(""),[k,J]=b.useState(!1),[se,T]=b.useState(!1),[D,oe]=b.useState(!1),ve=b.useMemo(()=>{if(!p)return[];const u={};return p.forEach(v=>{const M=v.userName;u[M]||(u[M]={userId:v.userId,userName:v.userName,count:0,views:[]}),u[M].count++,v.currentView&&!u[M].views.includes(v.currentView)&&u[M].views.push(v.currentView)}),Object.values(u).sort((v,M)=>{const Ve=v.userId===(V.id||"admin")||v.userName===V.name,Z=M.userId===(V.id||"admin")||M.userName===V.name;return Ve&&!Z?-1:!Ve&&Z?1:v.userName.localeCompare(M.userName)})},[p,V]),[ge,Ne]=b.useState(!1),[be,Fe]=b.useState(""),R=b.useRef(null),[K,Q]=b.useState(!1),[de,xe]=b.useState(!1),[je,ke]=b.useState(""),[nt,_e]=b.useState(""),[Ye,jt]=b.useState(r?.modules||{sales:!0,purchase:!0,inventory:!0,accounting:!0,treasury:!0,banks:!0,partners:!0,manufacturing:!0,hr:!1,vanSales:!1,pos:!1,suppliers:!0,customers:!0,salesTeam:!0,invoices:!0}),[we,Dt]=b.useState("modules"),[Ce,Ue]=b.useState({licenseKey:r?.licenseKey||"",expiryDate:r?.licenseExpiryDate||"",themeColor:r?.themeColor||"#0f172a"}),[ct,Bt]=b.useState(""),[yt,Rt]=b.useState(!1),[kt,ot]=b.useState(""),[at,vt]=b.useState({show:!1,message:"",type:"info"}),rt=(u,v="success")=>{vt({show:!0,message:u,type:v}),setTimeout(()=>vt({show:!1,message:"",type:"info"}),3e3)};b.useEffect(()=>{K&&r&&(Ue({licenseKey:r.licenseKey||"",expiryDate:r.licenseExpiryDate||"",themeColor:r.themeColor||"#0f172a"}),jt(r.modules||{sales:!0,purchase:!0,inventory:!0,accounting:!0,treasury:!0,banks:!0,partners:!0,manufacturing:!0,hr:!1,vanSales:!1,pos:!1,suppliers:!0,customers:!0,salesTeam:!0,invoices:!0}))},[K,r]);const Ct="myst",[gt,Je]=b.useState(!1),[Be,Ze]=b.useState({name:"",email:"",password:"",confirmPassword:""});b.useEffect(()=>{gt&&Ze({name:V.name||"",email:V.email||"",password:"",confirmPassword:""})},[gt,V]);const At=()=>{if(!Be.name||!Be.email){alert("يرجى إدخال الاسم والبريد الإلكتروني");return}if(Be.password&&Be.password!==Be.confirmPassword){alert("كلمات المرور غير متطابقة");return}const u={...V,name:Be.name,email:Be.email,...Be.password?{password:Be.password}:{}};G(u),localStorage.setItem("currentUser",JSON.stringify(u)),Je(!1),alert("تم تحديث بيانات الحساب بنجاح")},$e=e.split("|")[0];b.useEffect(()=>{const u=()=>{window.innerWidth<1024&&I(!1)};return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),b.useEffect(()=>{const u=v=>{if((v.ctrlKey||v.metaKey)&&v.key==="k"&&(v.preventDefault(),Ne(M=>!M)),v.ctrlKey&&v.shiftKey&&(v.key==="L"||v.key==="l"||v.code==="KeyL")&&(v.preventDefault(),xe(!0),ke(""),_e("")),(v.ctrlKey||v.metaKey)&&v.key==="b"&&(v.preventDefault(),x(!m)),v.altKey&&!v.ctrlKey&&!v.shiftKey){const M={1:"dashboard",2:"inv-sale",3:"stock-balance",4:"treasury-journal",5:"cheques"};M[v.key]&&(v.preventDefault(),s(M[v.key]))}v.key==="Escape"&&(Ne(!1),T(!1),J(!1),Q(!1),xe(!1))};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[r,K]),b.useEffect(()=>{ge&&R.current&&R.current.focus()},[ge]);const It=b.useMemo(()=>{if(!ue||ue.length<2||!n)return{products:[],partners:[],invoices:[]};const u=ue.toLowerCase();return{products:n.products.filter(v=>v.name.toLowerCase().includes(u)||v.sku.toLowerCase().includes(u)).slice(0,3),partners:n.partners.filter(v=>v.name.toLowerCase().includes(u)||v.phone?.includes(u)).slice(0,3),invoices:n.invoices.filter(v=>v.id.toLowerCase().includes(u)||v.partnerName.toLowerCase().includes(u)).slice(0,3)}},[ue,n]);It.products.length>0||It.partners.length>0||It.invoices.length>0;const it=b.useMemo(()=>{const u=[],v=r?.notificationSettings||{enabled:!0,chequesDue:!0,chequesOverdue:!0,lowStock:!0,overdueInvoices:!0,creditLimitExceeded:!0,upcomingPayments:!0,licenseWarning:!0,chequeAlertDays:3,lowStockThreshold:5,licenseWarningDays:30};if(!v.enabled)return[];const M=new Date;if(M.setHours(0,0,0,0),v.licenseWarning!==!1&&r?.licenseExpiryDate){const Z=new Date(r.licenseExpiryDate);Z.setHours(0,0,0,0);const $=Math.ceil((Z.getTime()-M.getTime())/(1e3*60*60*24)),Pe=v.licenseWarningDays||30;if($>0&&$<=Pe){let re="",le=!1;$<=3?(re=`⚠️ ينتهي الترخيص خلال ${$} ${$===1?"يوم":"أيام"}!`,le=!0):$<=7?(re=`تنبيه: ينتهي الترخيص خلال ${$} أيام`,le=!0):re=`تذكير: ينتهي الترخيص خلال ${$} يوم`,u.push({id:"license-expiry",type:"LICENSE_EXPIRY",title:re,desc:`يرجى التواصل مع الدعم الفني لتجديد الترخيص قبل ${Z.toLocaleDateString("ar-EG")}`,action:"config",urgent:le})}}if(!n)return u;const Ve=new Date(M);if(Ve.setDate(M.getDate()+(v.chequeAlertDays||3)),r?.modules?.banks){let Z=0;const $=10;v.chequesDue&&n.cheques.forEach(re=>{if(!(Z>=$)&&(re.status==="PENDING"||re.status==="UNDER_COLLECTION")){const le=new Date(re.dueDate);if(le.setHours(0,0,0,0),le<=Ve&&le>=M){const Ge=Math.ceil((le.getTime()-M.getTime())/864e5);u.push({id:re.id,type:"CHEQUE",title:Ge===0?"شيك مستحق اليوم!":`شيك مستحق خلال ${Ge} يوم`,desc:`${re.amount.toLocaleString()} ج.م - ${re.partnerName}`,action:"cheques",urgent:Ge<=1}),Z++}}}),v.chequesOverdue&&n.cheques.forEach(re=>{if(!(Z>=$)&&(re.status==="PENDING"||re.status==="UNDER_COLLECTION")){const le=new Date(re.dueDate);if(le.setHours(0,0,0,0),le<M){const Ge=Math.ceil((M.getTime()-le.getTime())/864e5);u.push({id:re.id,type:"CHEQUE_OVERDUE",title:"شيك متأخر!",desc:`متأخر ${Ge} يوم - ${re.amount.toLocaleString()} ج.م - ${re.partnerName}`,action:"cheques",urgent:!0}),Z++}}});const Pe=n.cheques.filter(re=>re.status!=="PENDING"&&re.status!=="UNDER_COLLECTION"?!1:new Date(re.dueDate)<=Ve).length;Pe>$&&u.push({id:"more-cheques",type:"CHEQUE",title:`و ${Pe-$} شيك آخر`,desc:`إجمالي الشيكات المستحقة: ${Pe}`,action:"cheques",urgent:!1})}if(r?.modules?.inventory&&v.lowStock){const Z=v.lowStockThreshold||5,$=n.products.filter(re=>re.stock<=(re.minStock||Z)&&re.stock>=0),Pe=n.products.filter(re=>re.stock===0);Pe.length>0&&u.push({id:"critical-stock",type:"STOCK_CRITICAL",title:"أصناف نفدت من المخزون!",desc:`${Pe.length} صنف بمخزون صفر`,action:"low-stock",urgent:!0}),$.length>0&&u.push({id:"stock-alert",type:"STOCK",title:"نواقص المخزون",desc:`${$.length} صنف وصل لحد الطلب`,action:"low-stock",urgent:$.length>50})}if(v.overdueInvoices&&r?.modules?.sales){new Date(M).setDate(M.getDate()-1);const $=n.invoices.filter(Pe=>Pe.status==="PAID"||Pe.status==="VOID"||!Pe.dueDate?!1:new Date(Pe.dueDate)<M&&Pe.type==="INVOICE_SALE");if($.length>0){const Pe=$.reduce((re,le)=>re+(le.total-(le.paidAmount||0)),0);u.push({id:"overdue-invoices",type:"INVOICE_OVERDUE",title:"فواتير متأخرة السداد",desc:`${$.length} فاتورة - ${Pe.toLocaleString()} ج.م`,action:"cust-statement",urgent:$.length>5})}}if(v.creditLimitExceeded&&r?.modules?.partners){const Z=n.partners.filter($=>{if($.type!=="CUSTOMER"&&!$.isCustomer)return!1;const Pe=$.creditLimit||$.limit||0;return Pe<=0?!1:$.balance>Pe});Z.length>0&&u.push({id:"credit-exceeded",type:"CREDIT_LIMIT",title:"تجاوز حد الائتمان",desc:`${Z.length} عميل تجاوز حده الائتماني`,action:"cust-balances",urgent:!0})}if(v.upcomingPayments&&r?.modules?.purchase){const Z=n.partners.filter($=>$.type!=="SUPPLIER"&&!$.isSupplier?!1:$.balance<-1e3);if(Z.length>0){const $=Math.abs(Z.reduce((Pe,re)=>Pe+re.balance,0));u.push({id:"supplier-payments",type:"PAYMENT_DUE",title:"مستحقات موردين",desc:`${Z.length} مورد - ${$.toLocaleString()} ج.م مستحقة`,action:"sup-balances",urgent:!1})}}return u},[n,r]),Vt=[{id:"dashboard",label:"الشاشة الرئيسية",icon:Rs,color:"indigo"},{id:"master-data",label:"البيانات الأساسية",icon:Ss,color:"slate",subItems:[{id:"master-customers",label:"تعريف العملاء",requiredPermission:["customers.view","customers.manage"]},{id:"master-suppliers",label:"تعريف الموردين",requiredPermission:["suppliers.view","suppliers.manage"]},{id:"master-branches",label:"تعريف الفروع",requiredPermission:"master.branches"},{id:"master-warehouses",label:"تعريف المخازن",requiredPermission:["inventory.view","master.warehouses"]},{id:"master-categories",label:"فئات الأصناف",requiredPermission:["inventory.view","master.categories"]},{id:"master-price-lists",label:"قوائم الأسعار",requiredPermission:["sales.view","master.price_lists"]},{id:"master-items",label:"كارت الصنف",requiredPermission:["inventory.view","inventory.manage"]},{id:"master-banks",label:"البنوك",requiredPermission:["treasury.view","master.banks"]},{id:"master-salesmen",label:"المندوبين",requiredPermission:["salesteam.view","master.salesmen"]}]},{id:"suppliers",label:"الموردين",icon:Gt,color:"orange",moduleId:"suppliers",requiredPermission:["suppliers.view","suppliers.manage","purchase.view"],subItems:[{id:"sup-payments",label:"مدفوعات للموردين",requiredPermission:["suppliers.payments","treasury.payment"]},{id:"sup-statement",label:"حسابات الموردين",requiredPermission:["suppliers.statement","suppliers.view"]},{id:"sup-balances",label:"حسابات الموردين الإجمالية",requiredPermission:["suppliers.balances","suppliers.view"]},{id:"sup-discount",label:"خصم مكتسب",requiredPermission:"suppliers.discount"}]},{id:"customers",label:"العملاء",icon:Ht,color:"cyan",moduleId:"customers",requiredPermission:["customers.view","customers.manage","sales.view"],subItems:[{id:"cust-payments",label:"مقبوضات العملاء",requiredPermission:["customers.payments","treasury.receipt"]},{id:"cust-statement",label:"حسابات العملاء",requiredPermission:["customers.statement","customers.view"]},{id:"cust-balances",label:"إجمالي حسابات العملاء",requiredPermission:["customers.balances","customers.view"]},{id:"cust-prices",label:"أسعار العملاء",requiredPermission:"customers.prices"},{id:"cust-discount",label:"خصم مسموح به",requiredPermission:"customers.discount"}]},{id:"sales-team",label:"فريق المبيعات",icon:Ds,color:"rose",moduleId:"salesTeam",requiredPermission:["salesteam.view","salesteam.manage"],subItems:[{id:"salesteam-dashboard",label:"لوحة متابعة المندوبين",requiredPermission:"salesteam.view"},{id:"salesteam-targets",label:"أهداف المندوبين",requiredPermission:"salesteam.targets"},{id:"salesteam-performance",label:"تقارير الأداء",requiredPermission:["salesteam.view","reports.view"]},{id:"salesteam-commissions",label:"العمولات",requiredPermission:"salesteam.commissions"},{id:"salesteam-commission-report",label:"تقرير عمولة المندوب",requiredPermission:["salesteam.commissions","reports.view"]}]},{id:"invoices",label:"الفواتير",icon:Ot,color:"indigo",moduleId:"invoices",subItems:[{id:"inv-sale",label:"فاتورة بيع",requiredPermission:["sales.view","sales.create"]},{id:"inv-purchase",label:"فاتورة شراء",requiredPermission:["purchase.view","purchase.create"]},{id:"inv-ret-sale",label:"مرتجع مبيعات",requiredPermission:["sales.view","sales.return"]},{id:"inv-ret-purchase",label:"مرتجع مشتريات",requiredPermission:["purchase.view","purchase.return"]},{id:"inv-reports",label:"تقارير الفواتير",requiredPermission:["sales.view","purchase.view","reports.view"]},{id:"inv-deleted",label:"الفواتير المحذوفة",requiredPermission:"system.settings"}]},{id:"inventory",label:"المخزون",icon:zt,color:"emerald",moduleId:"inventory",requiredPermission:["inventory.view","inventory.manage"],subItems:[{id:"stock-balance",label:"رصيد المخزن",requiredPermission:"inventory.view"},{id:"stock-period-report",label:"حركة المخزن (فترة)",requiredPermission:"inventory.view"},{id:"stock-value",label:"قيمة المخزون",requiredPermission:"inventory.view_value"},{id:"item-movement",label:"تقرير الحركة المخزنية",requiredPermission:"inventory.view"},{id:"item-profits",label:"أرباح الأصناف",requiredPermission:["inventory.view","sales.view"]},{id:"stock-taking",label:"جرد المخازن",requiredPermission:"inventory.stock_taking"},{id:"permit-in",label:"إذن إضافة مخزني",requiredPermission:"inventory.permit_in"},{id:"permit-out",label:"إذن صرف مخزني",requiredPermission:"inventory.permit_out"},{id:"permit-transfer-br",label:"إذن تحويل مخزني",requiredPermission:"inventory.transfer"},{id:"barcode-print",label:"طباعة الباركود",requiredPermission:"inventory.barcode"},{id:"low-stock",label:"نواقص المخزون",requiredPermission:"inventory.view"}]},{id:"manufacturing",label:"التصنيع",icon:As,color:"amber",moduleId:"manufacturing",requiredPermission:["manufacturing.view","manufacturing.manage"],subItems:[{id:"manufacturing-dashboard",label:"البيانات الأساسية للتصنيع",requiredPermission:"manufacturing.view"},{id:"production-orders",label:"أوامر التصنيع",requiredPermission:"manufacturing.production"},{id:"bom-manager",label:"قوائم المواد",requiredPermission:"manufacturing.bom"},{id:"stock-movements",label:"حركة المخزون",requiredPermission:["manufacturing.view","inventory.view"]}]},{id:"banks-module",label:"بنوك",icon:Is,color:"violet",moduleId:"banks",requiredPermission:["treasury.view","treasury.manage"],subItems:[{id:"money-transfer",label:"تحويل داخلي (Contra)",requiredPermission:"treasury.transfer"},{id:"banks",label:"كشف حساب بنك",requiredPermission:"treasury.view_balance"},{id:"bank-recon",label:"تسوية البنك",requiredPermission:"treasury.bank_recon"},{id:"cheques",label:"إدارة الشيكات",requiredPermission:"treasury.cheques"}]},{id:"treasury",label:"الخزينة",icon:ms,color:"purple",moduleId:"treasury",requiredPermission:["treasury.view","treasury.manage"],subItems:[{id:"daily-cash",label:"تسجيل نقدية",requiredPermission:"treasury.manage"},{id:"treasury-journal",label:"يومية الخزينة",requiredPermission:"treasury.view"},{id:"treasury-report",label:"تقرير الخزينة",requiredPermission:["treasury.view","reports.treasury"]},{id:"monthly-profit",label:"تقرير الأرباح الشهرى",requiredPermission:["treasury.view","reports.financial"]},{id:"installments",label:"التقسيط",requiredPermission:"treasury.manage"}]},{id:"accounting",label:"الحسابات",icon:Wt,color:"slate",moduleId:"accounting",requiredPermission:["accounting.view","accounting.manage"],subItems:[{id:"journal",label:"قيود اليومية",requiredPermission:"accounting.journal"},{id:"general-ledger",label:"الأستاذ العام",requiredPermission:"accounting.view"},{id:"fixed-assets",label:"الأصول الثابتة",requiredPermission:"accounting.assets"},{id:"coa",label:"شجرة الحسابات",requiredPermission:"accounting.view"},{id:"cost-centers",label:"مراكز التكلفة",requiredPermission:"accounting.cost_centers"},{id:"trial-balance",label:"ميزان المراجعة",requiredPermission:["accounting.view","reports.financial"]},{id:"balance-sheet",label:"الميزانية العمومية",requiredPermission:["accounting.view","reports.financial"]},{id:"income-statement",label:"قائمة الدخل",requiredPermission:["accounting.view","reports.financial"]}]},{id:"hr",label:"الموارد البشرية",icon:Fs,color:"rose",moduleId:"hr",requiredPermission:["hr.view","hr.manage"],subItems:[{id:"hr-employees",label:"إدارة الموظفين",requiredPermission:["hr.view","hr.manage"]},{id:"hr-attendance",label:"الحضور والانصراف",requiredPermission:"hr.attendance"},{id:"hr-payroll",label:"مسير الرواتب",requiredPermission:"hr.payroll"},{id:"hr-templates",label:"بنود الراتب",requiredPermission:"hr.manage"},{id:"hr-advances",label:"السلف والقروض",requiredPermission:"hr.advances"}]},{id:"van-sales",label:"المبيعات المتنقلة",icon:Gt,color:"sky",moduleId:"vanSales",requiredPermission:["vansales.view","vansales.manage"],subItems:[{id:"van-vehicles",label:"السيارات",requiredPermission:["vansales.view","vansales.manage"]},{id:"van-inventory",label:"جرد السيارات",requiredPermission:["vansales.view","vansales.manage"]},{id:"van-operations",label:"العمليات",requiredPermission:["vansales.view","vansales.manage"]},{id:"van-visits",label:"الزيارات",requiredPermission:["vansales.view","vansales.manage"]},{id:"van-settlements",label:"التسويات",requiredPermission:["vansales.view","vansales.manage"]},{id:"van-routes",label:"خط السير",requiredPermission:["vansales.view","vansales.manage"]},{id:"van-reports",label:"التقارير",requiredPermission:["vansales.view","reports.view"]}]},{id:"pos",label:"نقطة البيع",icon:Ot,color:"teal",moduleId:"pos",requiredPermission:["pos.access","pos.manage"],subItems:[{id:"pos-screen",label:"شاشة البيع",requiredPermission:"pos.access"},{id:"pos-shifts",label:"الورديات",requiredPermission:"pos.close_shift"},{id:"pos-reports",label:"تقارير نقطة البيع",requiredPermission:"pos.reports"}]},{id:"settings",label:"الإعدادات",icon:Cs,requiredPermission:"system.settings",subItems:[{id:"users",label:"إدارة المستخدمين",requiredPermission:"system.users"},{id:"config",label:"إعدادات النظام",requiredPermission:"system.settings"},{id:"data-migration",label:"استيراد البيانات",requiredPermission:"system.migration"},{id:"audit-log",label:"سجل المراقبة",requiredPermission:"system.audit"},{id:"backup",label:"النسخ الاحتياطي",requiredPermission:"system.backup"}]}],lt=u=>to()||!u?!0:Array.isArray(u)?tn(u):en(u),xt=b.useMemo(()=>{if(!r)return Vt;const v={...{sales:!0,purchase:!0,inventory:!0,accounting:!0,treasury:!0,banks:!0,partners:!0,manufacturing:!0,hr:!1,vanSales:!0,pos:!1,suppliers:!0,customers:!0,salesTeam:!0,invoices:!0},...r.modules||{}},M=[];for(const Ve of Vt){const Z={...Ve,subItems:Ve.subItems?[...Ve.subItems]:void 0};Z.moduleId&&!v[Z.moduleId]||lt(Z.requiredPermission)&&(Z.id==="invoices"&&(!v.sales&&!v.purchase||(Z.subItems=Z.subItems?.filter($=>$.id.includes("sale")&&!v.sales||$.id.includes("purchase")&&!v.purchase?!1:lt($.requiredPermission)),!Z.subItems||Z.subItems.length===0))||(Z.id==="master-data"&&(Z.subItems=Z.subItems?.filter($=>$.id==="master-customers"&&!v.customers||$.id==="master-suppliers"&&!v.suppliers||$.id==="master-salesmen"&&!v.salesTeam||$.id==="master-banks"&&!v.banks?!1:lt($.requiredPermission))),!(Z.subItems&&(Z.subItems=Z.subItems.filter($=>lt($.requiredPermission)),Z.subItems.length===0))&&M.push(Z)))}return M},[r]),ht=u=>{m&&I(!1),X(S===u?null:u)},et=(()=>{for(const u of xt){if(u.id===$e)return[u.label];if(u.subItems){const v=u.subItems.find(M=>M.id===$e);if(v)return[u.label,v.label]}}return["الرئيسية"]})(),Me=b.useMemo(()=>{const u=[];return xt.forEach(v=>{v.subItems?v.subItems.forEach(M=>{u.push({id:M.id,label:M.label,icon:v.icon,parent:v.label})}):u.push({id:v.id,label:v.label,icon:v.icon,parent:""})}),u},[xt]).filter(u=>u.label.toLowerCase().includes(be.toLowerCase())||u.parent.toLowerCase().includes(be.toLowerCase())).slice(0,8),ft=async()=>{if(!ct){ot("يرجى إدخال مفتاح الترخيص");return}Rt(!0),ot("");try{const u=await fetch(`${window.apiBaseUrl||"/api"}/settings/validate-license`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({licenseKey:ct})}),v=await u.json();u.ok&&v.valid?(alert(`تم تفعيل الترخيص بنجاح!
العميل: ${v.client}
الصلاحية حتى: ${v.expiry}`),window.location.reload()):ot(v.error||"مفتاح الترخيص غير صالح")}catch{ot("حدث خطأ أثناء الاتصال بالخادم")}finally{Rt(!1)}},We=()=>{je===Ct?(xe(!1),Q(!0),ke(""),_e(""),r&&jt(r.modules)):_e("كلمة المرور غير صحيحة")};return b.useMemo(()=>{if(!r?.licenseExpiryDate)return!1;const u=new Date().toISOString().split("T")[0];return r.licenseExpiryDate<u},[r])&&!K?o.jsxDEV("div",{className:"flex h-screen w-screen items-center justify-center bg-slate-900 text-white p-8 text-center",dir:"rtl",children:o.jsxDEV("div",{className:"max-w-md space-y-6",children:[o.jsxDEV("div",{className:"w-24 h-24 bg-rose-500/20 text-rose-500 rounded-full flex items-center justify-center mx-auto animate-pulse",children:o.jsxDEV(_t,{size:48},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1009,columnNumber:13},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1008,columnNumber:11},void 0),o.jsxDEV("h1",{className:"text-3xl font-bold",children:"انتهت صلاحية الترخيص"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1011,columnNumber:11},void 0),o.jsxDEV("p",{className:"text-slate-400 text-lg",children:"عذراً، لقد انتهت فترة صلاحية ترخيص النظام. يرجى التواصل مع الدعم الفني لتجديد الاشتراك."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1012,columnNumber:11},void 0),o.jsxDEV("div",{className:"p-4 bg-slate-800 rounded-xl border border-slate-700 font-mono text-sm text-slate-400",children:["License Key: ",r?.licenseKey||"N/A"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1015,columnNumber:11},void 0),o.jsxDEV("div",{className:"bg-slate-800/50 p-6 rounded-2xl border border-slate-700 space-y-4",children:[o.jsxDEV("h3",{className:"font-bold text-lg text-white",children:"تفعيل ترخيص جديد"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1021,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("input",{type:"text",value:ct,onChange:u=>Bt(u.target.value),placeholder:"XXXX-XXXX-XXXX-XXXX",className:"w-full bg-slate-900 border border-slate-600 rounded-xl p-3 text-center font-mono text-lg tracking-widest outline-none focus:border-indigo-500 transition-colors",dir:"ltr"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1023,columnNumber:15},void 0),kt&&o.jsxDEV("p",{className:"text-rose-400 text-sm font-bold animate-pulse",children:kt},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1032,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1022,columnNumber:13},void 0),o.jsxDEV("button",{onClick:ft,disabled:yt,className:`w-full py-3 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${yt?"bg-slate-700 text-slate-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-lg shadow-indigo-500/20"}`,children:yt?o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1045,columnNumber:19},void 0),"جاري التحقق..."]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1044,columnNumber:17},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV(Es,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1050,columnNumber:19},void 0),"تفعيل المفتاح"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1049,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1035,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1020,columnNumber:11},void 0),o.jsxDEV("button",{onClick:()=>{xe(!0)},className:"text-xs text-slate-600 hover:text-slate-400 mt-4 underline",children:"Admin Emergency Access"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1057,columnNumber:11},void 0),de&&o.jsxDEV("div",{className:"fixed inset-0 z-[250] bg-slate-900/90 backdrop-blur-md flex items-center justify-center p-4",children:o.jsxDEV("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-slate-200 text-slate-900",children:[o.jsxDEV("div",{className:"p-6 border-b border-slate-100 bg-gradient-to-r from-indigo-600 to-purple-600 text-white",children:o.jsxDEV("div",{className:"flex items-center gap-3 justify-center",children:[o.jsxDEV(Ps,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1070,columnNumber:21},void 0),o.jsxDEV("h3",{className:"font-bold text-lg",children:"وصول الإدارة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1071,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1069,columnNumber:19},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1068,columnNumber:17},void 0),o.jsxDEV("div",{className:"p-6 space-y-4",children:[o.jsxDEV("input",{type:"password",value:je,onChange:u=>ke(u.target.value),onKeyDown:u=>{u.key==="Enter"&&We()},className:"w-full border border-slate-300 rounded-xl p-3 outline-none focus:ring-2 focus:ring-indigo-100",placeholder:"كلمة المرور",autoFocus:!0},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1075,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex gap-3",children:[o.jsxDEV("button",{onClick:()=>xe(!1),className:"flex-1 py-2 rounded-xl bg-slate-100",children:"إلغاء"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1085,columnNumber:21},void 0),o.jsxDEV("button",{onClick:We,className:"flex-1 py-2 rounded-xl bg-indigo-600 text-white",children:"دخول"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1086,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1084,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1074,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1067,columnNumber:15},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1066,columnNumber:13},void 0),K&&r&&o.jsxDEV("div",{className:"fixed inset-0 z-[300] bg-slate-900 flex items-center justify-center p-4 text-slate-900 text-right",children:o.jsxDEV("div",{className:"bg-white w-full max-w-lg rounded-3xl p-6 space-y-4",children:[o.jsxDEV("h3",{className:"font-bold text-lg",children:"تحديث الترخيص"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1098,columnNumber:17},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-bold mb-1",children:"تاريخ انتهاء الصلاحية الجديد"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1100,columnNumber:19},void 0),o.jsxDEV("input",{type:"date",className:"w-full border p-2 rounded",defaultValue:r.licenseExpiryDate,onChange:u=>{const v={...r,licenseExpiryDate:u.target.value};d(v)}},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1101,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1099,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>window.location.reload(),className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold",children:"حفظ وإعادة التشغيل"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1111,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1097,columnNumber:15},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1095,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1007,columnNumber:9},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1006,columnNumber:7},void 0):o.jsxDEV("div",{className:"flex h-screen overflow-hidden bg-transparent font-sans text-right",dir:"rtl",children:[de&&o.jsxDEV("div",{className:"fixed inset-0 z-[250] bg-slate-900/60 backdrop-blur-md flex items-center justify-center p-4 animate-fade-in",children:o.jsxDEV("div",{className:"bg-white/95 backdrop-blur-xl w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-white/20 ring-1 ring-black/5",children:[o.jsxDEV("div",{className:"p-6 border-b border-slate-100 bg-gradient-to-r from-indigo-600 to-purple-600 text-white",children:[o.jsxDEV("div",{className:"flex items-center gap-3 justify-center",children:[o.jsxDEV(Ps,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1131,columnNumber:17},void 0),o.jsxDEV("h3",{className:"font-bold text-lg",children:"وصول محمي"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1132,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1130,columnNumber:15},void 0),o.jsxDEV("p",{className:"text-xs text-center mt-2 opacity-90",children:"يتطلب دخول إدارة الوحدات كلمة مرور خاصة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1134,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1129,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-6 space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"كلمة المرور"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1139,columnNumber:17},void 0),o.jsxDEV("input",{type:"password",value:je,onChange:u=>{ke(u.target.value),_e("")},onKeyDown:u=>{u.key==="Enter"&&We()},className:`w-full border ${nt?"border-rose-300 bg-rose-50":"border-slate-300"} rounded-xl p-3 outline-none focus:ring-2 focus:ring-indigo-100`,placeholder:"أدخل كلمة المرور",autoFocus:!0},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1140,columnNumber:17},void 0),nt&&o.jsxDEV("p",{className:"text-xs text-rose-600 mt-2 flex items-center gap-1",children:[o.jsxDEV(fs,{size:12},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1156,columnNumber:21},void 0),nt]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1155,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1138,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-3 pt-2",children:[o.jsxDEV("button",{onClick:()=>{xe(!1),ke(""),_e("")},className:"flex-1 py-2.5 rounded-xl font-bold text-slate-600 hover:bg-slate-100 border border-slate-300",children:"إلغاء"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1163,columnNumber:17},void 0),o.jsxDEV("button",{onClick:We,className:"flex-1 py-2.5 rounded-xl font-bold bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg flex items-center justify-center gap-2",children:[o.jsxDEV(Es,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1177,columnNumber:19},void 0),"تأكيد"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1173,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1162,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1137,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1128,columnNumber:11},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1127,columnNumber:9},void 0),ge&&o.jsxDEV("div",{className:"fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm flex items-start justify-center pt-24 animate-fade-in",children:o.jsxDEV("div",{className:"w-full max-w-2xl bg-white/95 backdrop-blur-2xl rounded-3xl shadow-2xl overflow-hidden border border-white/20 ring-1 ring-black/5 transform transition-all scale-100 opacity-100",children:[o.jsxDEV("div",{className:"p-5 border-b border-slate-100 flex items-center gap-4 relative",children:[o.jsxDEV("div",{className:"text-indigo-500 bg-indigo-50 p-2 rounded-xl",children:o.jsxDEV(Qt,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1194,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1193,columnNumber:15},void 0),o.jsxDEV("input",{ref:R,type:"text",placeholder:"ابحث عن صفحة، تقرير، أو إعداد...",className:"flex-1 text-xl font-medium outline-none text-slate-800 placeholder:text-slate-400 bg-transparent h-10",value:be,onChange:u=>Fe(u.target.value)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1196,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>Ne(!1),className:"hidden sm:flex items-center gap-1 px-2 py-1 bg-slate-100 border border-slate-200 rounded-lg text-[10px] font-bold text-slate-500 hover:bg-slate-200 transition-colors font-mono shadow-sm",children:"ESC"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1204,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1192,columnNumber:13},void 0),o.jsxDEV("div",{className:"max-h-[450px] overflow-y-auto p-3 scrollbar-thin scrollbar-thumb-slate-200 scrollbar-track-transparent",children:Me.length===0?o.jsxDEV("div",{className:"py-16 text-center flex flex-col items-center justify-center text-slate-400",children:[o.jsxDEV("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mb-4",children:o.jsxDEV(Qt,{size:32,className:"opacity-20"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1217,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1216,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-lg font-medium text-slate-500",children:"لا توجد نتائج مطابقة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1219,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-sm opacity-70 mt-1",children:"حاول البحث بكلمات مختلفة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1220,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1215,columnNumber:17},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"text-xs font-bold text-indigo-500 px-4 py-2 uppercase tracking-wider opacity-80",children:"نتائج البحث"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1224,columnNumber:19},void 0),o.jsxDEV("div",{className:"space-y-1",children:Me.map(u=>o.jsxDEV("button",{onClick:()=>{s(u.id),Ne(!1),Fe("")},className:"w-full text-right flex items-center justify-between p-3.5 hover:bg-indigo-50/60 hover:shadow-sm rounded-2xl group transition-all duration-200 border border-transparent hover:border-indigo-100",children:[o.jsxDEV("div",{className:"flex items-center gap-4",children:[o.jsxDEV("div",{className:"p-2.5 bg-slate-50 text-slate-500 group-hover:bg-white group-hover:text-indigo-600 group-hover:shadow-md rounded-xl transition-all duration-300",children:o.jsxDEV(u.icon,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1234,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1233,columnNumber:27},void 0),o.jsxDEV("div",{children:[o.jsxDEV("div",{className:"font-bold text-slate-700 group-hover:text-indigo-900 transition-colors text-[15px]",children:u.label},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1237,columnNumber:29},void 0),u.parent&&o.jsxDEV("div",{className:"text-xs text-slate-400 group-hover:text-indigo-400 transition-colors mt-0.5",children:u.parent},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1238,columnNumber:45},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1236,columnNumber:27},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1232,columnNumber:25},void 0),o.jsxDEV("div",{className:"opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-x-2 group-hover:translate-x-0 text-indigo-400 bg-white p-1.5 rounded-lg shadow-sm",children:o.jsxDEV(wn,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1242,columnNumber:27},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1241,columnNumber:25},void 0)]},u.id,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1227,columnNumber:23},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1225,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1223,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1213,columnNumber:13},void 0),o.jsxDEV("div",{className:"px-5 py-3 bg-slate-50/80 border-t border-slate-100 text-[11px] text-slate-400 flex justify-between items-center backdrop-blur-sm",children:[o.jsxDEV("div",{className:"flex items-center gap-4",children:[o.jsxDEV("span",{className:"flex items-center gap-1.5",children:[o.jsxDEV("kbd",{className:"bg-white px-1.5 py-0.5 rounded border border-slate-200 shadow-sm font-sans",children:"↑"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1255,columnNumber:19},void 0),o.jsxDEV("kbd",{className:"bg-white px-1.5 py-0.5 rounded border border-slate-200 shadow-sm font-sans",children:"↓"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1256,columnNumber:19},void 0),o.jsxDEV("span",{children:"للتنقل"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1257,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1254,columnNumber:17},void 0),o.jsxDEV("span",{className:"flex items-center gap-1.5",children:[o.jsxDEV("kbd",{className:"bg-white px-1.5 py-0.5 rounded border border-slate-200 shadow-sm font-sans",children:"↵"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1260,columnNumber:19},void 0),o.jsxDEV("span",{children:"للاختيار"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1261,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1259,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1253,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex items-center gap-1.5 opacity-70",children:[o.jsxDEV(Tn,{size:12},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1265,columnNumber:17},void 0),o.jsxDEV("span",{children:"Cloud ERP"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1266,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1264,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1252,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1189,columnNumber:11},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1188,columnNumber:9},void 0),K&&r&&o.jsxDEV("div",{className:"fixed inset-0 z-[200] bg-slate-900/60 backdrop-blur-md flex items-center justify-center p-4 animate-fade-in",children:o.jsxDEV("div",{className:"bg-white/95 backdrop-blur-2xl w-full max-w-5xl rounded-3xl shadow-2xl overflow-hidden border border-white/40 ring-1 ring-black/5 flex flex-col max-h-[90vh] relative",children:[o.jsxDEV("div",{className:"absolute top-0 right-0 w-96 h-96 bg-indigo-500/10 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1279,columnNumber:13},void 0),o.jsxDEV("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl -ml-32 -mb-32 pointer-events-none"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1280,columnNumber:13},void 0),at.show&&o.jsxDEV("div",{className:`absolute top-4 left-1/2 -translate-x-1/2 z-50 px-6 py-3 rounded-xl shadow-lg font-bold text-sm animate-slide-up flex items-center gap-2 ${at.type==="success"?"bg-emerald-500 text-white":at.type==="error"?"bg-rose-500 text-white":"bg-indigo-500 text-white"}`,children:[at.type==="success"&&o.jsxDEV(ts,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1288,columnNumber:51},void 0),at.type==="error"&&o.jsxDEV(fs,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1289,columnNumber:49},void 0),at.type==="info"&&o.jsxDEV(Ln,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1290,columnNumber:48},void 0),at.message]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1284,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-6 border-b border-white/20 bg-gradient-to-r from-slate-50/80 to-white/80 backdrop-blur-xl flex justify-between items-center shrink-0 relative z-10",children:[o.jsxDEV("div",{className:"flex items-center gap-4",children:[o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("div",{className:"absolute inset-0 bg-indigo-500 blur-lg opacity-20 rounded-xl"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1299,columnNumber:19},void 0),o.jsxDEV("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl text-white shadow-lg relative z-10",children:o.jsxDEV(Es,{size:28},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1301,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1300,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1298,columnNumber:17},void 0),o.jsxDEV("div",{children:[o.jsxDEV("h3",{className:"font-black text-xl bg-gradient-to-r from-indigo-900 to-purple-900 bg-clip-text text-transparent",children:"إدارة تراخيص النظام"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1305,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-xs font-medium text-slate-500 tracking-wide mt-0.5",children:"Advanced System Administration Mode"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1306,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1304,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1297,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>Q(!1),className:"text-slate-400 hover:text-rose-500 p-2 rounded-full hover:bg-rose-50 transition-all duration-300",children:o.jsxDEV(ss,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1313,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1309,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1296,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center gap-1 px-6 py-3 bg-slate-50/50 border-b border-slate-100 overflow-x-auto shrink-0",children:[{id:"modules",label:"الوحدات",icon:Sn},{id:"license",label:"الترخيص",icon:zs},{id:"theme",label:"المظهر",icon:Dn},{id:"system",label:"النظام",icon:Ss},{id:"danger",label:"الخطورة",icon:_t}].map(u=>o.jsxDEV("button",{onClick:()=>Dt(u.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl font-bold text-sm transition-all whitespace-nowrap ${we===u.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"text-slate-500 hover:bg-white hover:text-slate-700 hover:shadow"}`,children:[o.jsxDEV(u.icon,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1334,columnNumber:19},void 0),u.label]},u.id,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1326,columnNumber:17},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1318,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 relative z-10",children:[we==="modules"&&o.jsxDEV("div",{className:"space-y-6 animate-fade-in",children:[o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("div",{children:[o.jsxDEV("h4",{className:"font-bold text-lg text-slate-800",children:"الوحدات المفعلة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1348,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-sm text-slate-500",children:"تفعيل أو تعطيل وحدات النظام"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1349,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1347,columnNumber:21},void 0),o.jsxDEV("span",{className:"bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold",children:[Object.values(Ye).filter(Boolean).length," / 15 مفعل"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1351,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1346,columnNumber:19},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{key:"partners",label:"الشركاء",sub:"CRM & SRM",icon:Ht,color:"purple",stats:`${n?.partners.length||0} شريك`,deps:[]},{key:"suppliers",label:"الموردين",sub:"Supplier Management",icon:Gt,color:"orange",stats:"إدارة الموردين",deps:["partners"]},{key:"customers",label:"العملاء",sub:"Customer Management",icon:Ht,color:"cyan",stats:"إدارة العملاء",deps:["partners"]},{key:"salesTeam",label:"فريق المبيعات",sub:"Sales Team",icon:Ds,color:"rose",stats:"المندوبين والعمولات",deps:["sales"]},{key:"invoices",label:"الفواتير",sub:"Invoicing",icon:Ot,color:"indigo",stats:`${n?.invoices.length||0} فاتورة`,deps:[]},{key:"inventory",label:"المخزون",sub:"Inventory Control",icon:zt,color:"amber",stats:`${n?.products.length||0} صنف`,deps:[]},{key:"manufacturing",label:"التصنيع",sub:"Production",icon:As,color:"yellow",stats:"أوامر الإنتاج",deps:["inventory"]},{key:"banks",label:"البنوك",sub:"Bank Management",icon:Is,color:"violet",stats:`${n?.cheques.length||0} شيك`,deps:[]},{key:"treasury",label:"الخزينة",sub:"Treasury & Cash",icon:ms,color:"purple",stats:"يومية الخزينة",deps:["banks"]},{key:"accounting",label:"الحسابات",sub:"General Ledger",icon:Wt,color:"slate",stats:"شجرة الحسابات",deps:[]},{key:"hr",label:"الموارد البشرية",sub:"HR & Payroll",icon:Fs,color:"rose",stats:"إدارة الموظفين",deps:[]},{key:"vanSales",label:"المبيعات المتنقلة",sub:"Van Distribution",icon:Gt,color:"sky",stats:"توزيع السيارات",deps:["sales","inventory"]},{key:"pos",label:"نقطة البيع",sub:"Point of Sale",icon:Ot,color:"teal",stats:"كاشير البيع",deps:["sales","inventory"]},{key:"sales",label:"المبيعات",sub:"Sales Management",icon:Ot,color:"teal",stats:"نظام البيع",deps:[]},{key:"purchase",label:"المشتريات",sub:"Purchasing",icon:An,color:"blue",stats:"فواتير الشراء",deps:[]}].map(u=>{const v=Ye[u.key],M=u.deps.length>0,Ve=u.deps.every(Z=>Ye[Z]);return o.jsxDEV("div",{className:`flex items-center justify-between p-4 rounded-2xl border-2 transition-all duration-300 ${v?`border-${u.color}-200 bg-${u.color}-50/30`:"border-slate-200 bg-white/50"} hover:shadow-md group`,children:[o.jsxDEV("div",{className:"flex items-center gap-4",children:[o.jsxDEV("div",{className:`p-3 rounded-xl bg-${u.color}-100 text-${u.color}-600 shadow-sm group-hover:scale-110 transition-transform`,children:o.jsxDEV(u.icon,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1388,columnNumber:31},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1387,columnNumber:29},void 0),o.jsxDEV("div",{children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("span",{className:"font-bold text-slate-700",children:u.label},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1392,columnNumber:33},void 0),M&&!Ve&&o.jsxDEV("span",{className:"text-[9px] bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full font-bold",children:["يحتاج ",u.deps.join(", ")]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1394,columnNumber:35},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1391,columnNumber:31},void 0),o.jsxDEV("div",{className:"flex items-center gap-2 mt-0.5",children:[o.jsxDEV("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:u.sub},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1400,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-[10px] text-slate-500",children:["• ",u.stats]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1401,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1399,columnNumber:31},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1390,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1386,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>jt({...Ye,[u.key]:!v}),className:`relative w-14 h-8 rounded-full transition-colors duration-300 focus:outline-none shadow-inner ${v?"bg-emerald-500":"bg-slate-200"}`,children:o.jsxDEV("span",{className:`absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-md transition-transform duration-300 flex items-center justify-center ${v?"translate-x-6":"translate-x-0"}`,children:v?o.jsxDEV(ts,{size:12,className:"text-emerald-500"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1412,columnNumber:43},void 0):null},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1410,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1405,columnNumber:27},void 0)]},u.key,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1379,columnNumber:25},void 0)})},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1356,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1345,columnNumber:17},void 0),we==="license"&&o.jsxDEV("div",{className:"space-y-6 animate-fade-in",children:[o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxDEV("div",{className:"bg-white/60 rounded-2xl p-6 border border-slate-100",children:[o.jsxDEV("label",{className:"block text-sm font-bold text-slate-700 mb-3",children:"مفتاح الترخيص (License Key)"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1428,columnNumber:23},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("input",{type:"text",value:Ce.licenseKey,onChange:u=>Ue({...Ce,licenseKey:u.target.value}),className:"w-full border border-slate-200 bg-white rounded-xl p-4 font-mono text-sm tracking-wider text-slate-700 outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all pr-12",placeholder:"XXXX-XXXX-XXXX-XXXX"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1430,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{navigator.clipboard.writeText(Ce.licenseKey),rt("تم نسخ مفتاح الترخيص","success")},className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-indigo-600 p-2 rounded-lg hover:bg-indigo-50 transition-all",title:"نسخ المفتاح",children:o.jsxDEV(In,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1445,columnNumber:27},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1437,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1429,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1427,columnNumber:21},void 0),o.jsxDEV("div",{className:"bg-white/60 rounded-2xl p-6 border border-slate-100",children:[o.jsxDEV("div",{className:"flex justify-between items-center mb-3",children:[o.jsxDEV("label",{className:"text-sm font-bold text-slate-700",children:"تاريخ انتهاء الصلاحية"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1453,columnNumber:25},void 0),Ce.expiryDate&&o.jsxDEV("span",{className:`text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-wider ${new Date(Ce.expiryDate)<new Date?"bg-rose-100 text-rose-600 border border-rose-200":"bg-emerald-100 text-emerald-600 border border-emerald-200"}`,children:[Math.ceil((new Date(Ce.expiryDate).getTime()-new Date().getTime())/(1e3*3600*24))," يوم متبقي"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1455,columnNumber:27},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1452,columnNumber:23},void 0),o.jsxDEV("input",{type:"date",value:Ce.expiryDate,onChange:u=>Ue({...Ce,expiryDate:u.target.value}),className:"w-full border border-slate-200 bg-white rounded-xl p-4 outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all font-bold text-slate-700"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1463,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1451,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1425,columnNumber:19},void 0),o.jsxDEV("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl p-6 border border-indigo-100",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("div",{children:[o.jsxDEV("h5",{className:"font-bold text-indigo-900 text-lg",children:"حالة الترخيص"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1476,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-sm text-indigo-600 mt-1",children:Ce.expiryDate?new Date(Ce.expiryDate)>new Date?"✅ الترخيص نشط وفعال":"❌ انتهت صلاحية الترخيص":"⚠️ لم يتم تحديد تاريخ الانتهاء"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1477,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1475,columnNumber:23},void 0),o.jsxDEV("div",{className:"bg-white rounded-2xl p-4 shadow-lg",children:o.jsxDEV("div",{className:"text-center",children:[o.jsxDEV("div",{className:"text-4xl font-black text-indigo-600",children:Ce.expiryDate?Math.max(0,Math.ceil((new Date(Ce.expiryDate).getTime()-new Date().getTime())/(1e3*3600*24))):"∞"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1488,columnNumber:27},void 0),o.jsxDEV("div",{className:"text-xs font-bold text-slate-500 mt-1",children:"يوم متبقي"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1494,columnNumber:27},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1487,columnNumber:25},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1486,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1474,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1473,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1424,columnNumber:17},void 0),we==="theme"&&o.jsxDEV("div",{className:"space-y-6 animate-fade-in",children:[o.jsxDEV("div",{children:[o.jsxDEV("h4",{className:"font-bold text-lg text-slate-800 mb-2",children:"ألوان الواجهة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1506,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-sm text-slate-500 mb-4",children:"اختر اللون الرئيسي للتطبيق"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1507,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-4 p-6 bg-slate-50 rounded-2xl border border-slate-100",children:[{color:"#0f172a",name:"Slate Dark"},{color:"#1e293b",name:"Slate"},{color:"#334155",name:"Slate Light"},{color:"#0f766e",name:"Teal"},{color:"#4338ca",name:"Indigo"},{color:"#7c3aed",name:"Purple"},{color:"#be123c",name:"Rose"},{color:"#0369a1",name:"Sky"}].map(({color:u,name:v})=>o.jsxDEV("button",{onClick:()=>Ue({...Ce,themeColor:u}),className:`group relative w-14 h-14 rounded-2xl border-2 transition-all duration-300 shadow-sm hover:shadow-lg hover:-translate-y-1 ${Ce.themeColor===u?"border-slate-800 scale-110 ring-4 ring-slate-200":"border-white"}`,style:{backgroundColor:u},title:v,children:Ce.themeColor===u&&o.jsxDEV(ts,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-white",size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1531,columnNumber:29},void 0)},u,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1520,columnNumber:25},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1509,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1505,columnNumber:19},void 0),o.jsxDEV("div",{className:"bg-white/60 rounded-2xl p-6 border border-slate-100",children:[o.jsxDEV("h5",{className:"font-bold text-slate-700 mb-4",children:"معلومات الشركة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1540,columnNumber:21},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"اسم الشركة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1543,columnNumber:25},void 0),o.jsxDEV("input",{type:"text",value:r.companyName||"",className:"w-full border border-slate-200 rounded-xl p-3 outline-none focus:ring-2 focus:ring-indigo-100",placeholder:"اسم الشركة",disabled:!0},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1544,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1542,columnNumber:23},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"الفرع"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1553,columnNumber:25},void 0),o.jsxDEV("input",{type:"text",value:r.branchName||"الفرع الرئيسي",className:"w-full border border-slate-200 rounded-xl p-3 outline-none focus:ring-2 focus:ring-indigo-100",placeholder:"الفرع الرئيسي",disabled:!0},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1554,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1552,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1541,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-xs text-slate-400 mt-3",children:"* للتعديل، اذهب إلى إعدادات النظام"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1563,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1539,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1504,columnNumber:17},void 0),we==="system"&&o.jsxDEV("div",{className:"space-y-6 animate-fade-in",children:[o.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"الأصناف",value:n?.products.length||0,icon:zt,color:"amber"},{label:"الشركاء",value:n?.partners.length||0,icon:Ht,color:"purple"},{label:"الفواتير",value:n?.invoices.length||0,icon:Wt,color:"indigo"},{label:"الشيكات",value:n?.cheques.length||0,icon:js,color:"cyan"}].map(u=>o.jsxDEV("div",{className:`bg-${u.color}-50 rounded-2xl p-4 border border-${u.color}-100`,children:[o.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[o.jsxDEV(u.icon,{size:16,className:`text-${u.color}-600`},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1581,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-xs font-bold text-slate-500",children:u.label},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1582,columnNumber:27},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1580,columnNumber:25},void 0),o.jsxDEV("div",{className:`text-2xl font-black text-${u.color}-700`,children:u.value.toLocaleString()},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1584,columnNumber:25},void 0)]},u.label,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1579,columnNumber:23},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1572,columnNumber:19},void 0),o.jsxDEV("div",{className:"bg-white/60 rounded-2xl p-6 border border-slate-100",children:[o.jsxDEV("h5",{className:"font-bold text-slate-700 mb-4 flex items-center gap-2",children:[o.jsxDEV(Fn,{size:18,className:"text-amber-500"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1592,columnNumber:23},void 0),"إجراءات سريعة"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1591,columnNumber:21},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[o.jsxDEV("button",{onClick:()=>{rt("جاري إنشاء نسخة احتياطية...","info"),setTimeout(()=>rt("تم إنشاء النسخة الاحتياطية","success"),1500)},className:"flex items-center gap-3 p-4 bg-emerald-50 hover:bg-emerald-100 rounded-xl border border-emerald-200 text-emerald-700 font-bold transition-all hover:shadow-md",children:[o.jsxDEV(Ws,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1604,columnNumber:25},void 0),o.jsxDEV("span",{children:"نسخة احتياطية"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1605,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1596,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>{rt("جاري تصدير السجلات...","info"),setTimeout(()=>rt("تم تصدير السجلات","success"),1e3)},className:"flex items-center gap-3 p-4 bg-blue-50 hover:bg-blue-100 rounded-xl border border-blue-200 text-blue-700 font-bold transition-all hover:shadow-md",children:[o.jsxDEV(Wt,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1614,columnNumber:25},void 0),o.jsxDEV("span",{children:"تصدير السجلات"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1615,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1607,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>{localStorage.clear(),sessionStorage.clear(),rt("تم مسح الذاكرة المؤقتة","success")},className:"flex items-center gap-3 p-4 bg-amber-50 hover:bg-amber-100 rounded-xl border border-amber-200 text-amber-700 font-bold transition-all hover:shadow-md",children:[o.jsxDEV(rs,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1625,columnNumber:25},void 0),o.jsxDEV("span",{children:"مسح الكاش"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1626,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1617,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1595,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1590,columnNumber:19},void 0),o.jsxDEV("div",{className:"bg-slate-50 rounded-2xl p-6 border border-slate-100",children:[o.jsxDEV("h5",{className:"font-bold text-slate-700 mb-4",children:"معلومات النظام"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1633,columnNumber:21},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxDEV("div",{className:"flex justify-between p-3 bg-white rounded-xl",children:[o.jsxDEV("span",{className:"text-slate-500",children:"الإصدار"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1636,columnNumber:25},void 0),o.jsxDEV("span",{className:"font-bold text-slate-700",children:"v2.0.0"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1637,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1635,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex justify-between p-3 bg-white rounded-xl",children:[o.jsxDEV("span",{className:"text-slate-500",children:"آخر تحديث"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1640,columnNumber:25},void 0),o.jsxDEV("span",{className:"font-bold text-slate-700",children:new Date().toLocaleDateString("ar-EG")},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1641,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1639,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex justify-between p-3 bg-white rounded-xl",children:[o.jsxDEV("span",{className:"text-slate-500",children:"المستخدمين النشطين"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1644,columnNumber:25},void 0),o.jsxDEV("span",{className:"font-bold text-emerald-600",children:p?.length||1},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1645,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1643,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex justify-between p-3 bg-white rounded-xl",children:[o.jsxDEV("span",{className:"text-slate-500",children:"حالة الخادم"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1648,columnNumber:25},void 0),o.jsxDEV("span",{className:"font-bold text-emerald-600 flex items-center gap-1",children:[o.jsxDEV("span",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1650,columnNumber:27},void 0),"متصل"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1649,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1647,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1634,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1632,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1570,columnNumber:17},void 0),we==="danger"&&o.jsxDEV("div",{className:"space-y-6 animate-fade-in",children:[o.jsxDEV("div",{className:"bg-rose-50 rounded-2xl p-6 border border-rose-200",children:o.jsxDEV("div",{className:"flex items-start gap-4",children:[o.jsxDEV("div",{className:"bg-rose-100 p-3 rounded-xl text-rose-600",children:o.jsxDEV(_t,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1665,columnNumber:25},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1664,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("h4",{className:"font-bold text-rose-800 text-lg",children:"منطقة الخطر"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1668,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-sm text-rose-600 mt-1",children:"الإجراءات هنا حرجة جداً ولا يمكن التراجع عنها. تأكد من فهمك للعواقب قبل المتابعة."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1669,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1667,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1663,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1662,columnNumber:19},void 0),o.jsxDEV("div",{className:"space-y-4",children:[o.jsxDEV("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 hover:border-rose-200 transition-colors",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("div",{children:[o.jsxDEV("h5",{className:"font-bold text-slate-700",children:"إعادة ضبط المصنع"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1680,columnNumber:27},void 0),o.jsxDEV("p",{className:"text-sm text-slate-500 mt-1",children:"مسح جميع البيانات والعودة للإعدادات الافتراضية"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1681,columnNumber:27},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1679,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{confirm("تحذير: سيتم حذف جميع البيانات وإعادة النظام إلى حالة المصنع. هل أنت متأكد تماماً؟")&&(c?c():rt("هذه الميزة غير متاحة حالياً","error"))},className:"px-6 py-3 bg-rose-50 border border-rose-200 text-rose-600 rounded-xl font-bold text-sm hover:bg-rose-600 hover:text-white transition-all whitespace-nowrap",children:"Factory Reset"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1683,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1678,columnNumber:23},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1677,columnNumber:21},void 0),o.jsxDEV("div",{className:"bg-white rounded-2xl p-6 border border-slate-200 hover:border-amber-200 transition-colors",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("div",{children:[o.jsxDEV("h5",{className:"font-bold text-slate-700",children:"مسح ذاكرة التخزين المحلية"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1703,columnNumber:27},void 0),o.jsxDEV("p",{className:"text-sm text-slate-500 mt-1",children:"سيتم تسجيل خروجك من النظام"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1704,columnNumber:27},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1702,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{localStorage.clear(),sessionStorage.clear(),rt("تم المسح بنجاح، جاري إعادة التحميل...","success"),setTimeout(()=>window.location.reload(),1500)},className:"px-6 py-3 bg-amber-50 border border-amber-200 text-amber-600 rounded-xl font-bold text-sm hover:bg-amber-600 hover:text-white transition-all whitespace-nowrap",children:"Clear Storage"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1706,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1701,columnNumber:23},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1700,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1676,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1661,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1341,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-4 bg-white/60 backdrop-blur-md border-t border-white/20 flex justify-between items-center shrink-0 relative z-10",children:[o.jsxDEV("div",{className:"text-xs text-slate-400",children:[we==="modules"&&`${Object.values(Ye).filter(Boolean).length} وحدة مفعلة`,we==="license"&&`الترخيص: ${Ce.licenseKey||"غير محدد"}`,we==="system"&&`${n?.products.length||0} صنف • ${n?.partners.length||0} شريك`]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1726,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-3",children:[o.jsxDEV("button",{onClick:()=>Q(!1),className:"px-6 py-2.5 rounded-xl font-bold text-slate-600 hover:text-slate-800 hover:bg-slate-100 transition-all",children:"إلغاء"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1732,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{const u={...r,modules:Ye,licenseKey:Ce.licenseKey,licenseExpiryDate:Ce.expiryDate,themeColor:Ce.themeColor};d(u),rt("تم حفظ الإعدادات بنجاح","success"),setTimeout(()=>Q(!1),1e3)},className:"px-8 py-2.5 rounded-xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:from-indigo-700 hover:to-purple-700 shadow-lg shadow-indigo-200 hover:-translate-y-0.5 transition-all flex items-center gap-2",children:[o.jsxDEV(Bs,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1753,columnNumber:19},void 0),"حفظ التكوين"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1738,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1731,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1725,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1276,columnNumber:11},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1275,columnNumber:9},void 0),gt&&o.jsxDEV("div",{className:"fixed inset-0 z-[200] bg-slate-900/60 backdrop-blur-md flex items-center justify-center p-4 animate-fade-in",children:o.jsxDEV("div",{className:"bg-white/95 backdrop-blur-xl w-full max-w-md rounded-3xl shadow-2xl overflow-hidden border border-white/20 ring-1 ring-black/5",children:[o.jsxDEV("div",{className:"p-6 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[o.jsxDEV("div",{className:"flex items-center gap-3",children:[o.jsxDEV("div",{className:"bg-teal-600 p-2 rounded-lg text-white",children:o.jsxDEV(ys,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1769,columnNumber:19},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1768,columnNumber:17},void 0),o.jsxDEV("div",{children:[o.jsxDEV("h3",{className:"font-bold text-lg text-slate-800",children:"إعدادات الحساب"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1772,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-xs text-slate-500",children:"تعديل بيانات الملف الشخصي"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1773,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1771,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1767,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>Je(!1),className:"text-slate-400 hover:text-rose-500",children:o.jsxDEV(ss,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1776,columnNumber:110},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1776,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1766,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-6 space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"الاسم المعروض"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1781,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:Be.name,onChange:u=>Ze({...Be,name:u.target.value}),className:"w-full border border-slate-300 rounded-xl p-3 outline-none focus:ring-2 focus:ring-teal-100",placeholder:"الاسم الكامل"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1782,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1780,columnNumber:15},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"البريد الإلكتروني"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1792,columnNumber:17},void 0),o.jsxDEV("input",{type:"email",value:Be.email,onChange:u=>Ze({...Be,email:u.target.value}),className:"w-full border border-slate-300 rounded-xl p-3 outline-none focus:ring-2 focus:ring-teal-100",placeholder:"example@company.com"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1793,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1791,columnNumber:15},void 0),o.jsxDEV("div",{className:"pt-2 border-t border-slate-100 mt-2",children:[o.jsxDEV("p",{className:"text-xs font-bold text-slate-400 mb-3",children:"تغيير كلمة المرور (اختياري)"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1803,columnNumber:17},void 0),o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("div",{children:o.jsxDEV("input",{type:"password",value:Be.password,onChange:u=>Ze({...Be,password:u.target.value}),className:"w-full border border-slate-300 rounded-xl p-3 outline-none focus:ring-2 focus:ring-teal-100 text-sm",placeholder:"كلمة المرور الجديدة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1806,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1805,columnNumber:19},void 0),o.jsxDEV("div",{children:o.jsxDEV("input",{type:"password",value:Be.confirmPassword,onChange:u=>Ze({...Be,confirmPassword:u.target.value}),className:"w-full border border-slate-300 rounded-xl p-3 outline-none focus:ring-2 focus:ring-teal-100 text-sm",placeholder:"تأكيد كلمة المرور"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1815,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1814,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1804,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1802,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1779,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-4 bg-slate-50 border-t border-slate-200 flex justify-end gap-3",children:[o.jsxDEV("button",{onClick:()=>Je(!1),className:"px-6 py-2.5 rounded-xl font-bold text-slate-600 hover:bg-slate-200",children:"إلغاء"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1828,columnNumber:15},void 0),o.jsxDEV("button",{onClick:At,className:"px-8 py-2.5 rounded-xl font-bold bg-teal-600 text-white hover:bg-teal-700 shadow-lg flex items-center gap-2",children:[o.jsxDEV(Bs,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1830,columnNumber:17},void 0)," حفظ التغييرات"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1829,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1827,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1765,columnNumber:11},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1764,columnNumber:9},void 0),P&&o.jsxDEV("div",{className:"fixed inset-0 bg-slate-900/50 z-40 lg:hidden backdrop-blur-sm transition-opacity",onClick:()=>N(!1)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1839,columnNumber:9},void 0),o.jsxDEV("aside",{className:`
          fixed inset-y-0 right-0 z-50 text-slate-300 transition-all duration-500 ease-[cubic-bezier(0.25,0.1,0.25,1)]
          ${P?"translate-x-0":"translate-x-full"}
          lg:relative lg:translate-x-0 flex flex-col
          ${m?"w-16":"w-64"}
          bg-[#0f172a] border-l border-slate-800/50 shadow-2xl
        `,children:[o.jsxDEV("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-slate-900 via-[#0B1120] to-[#020617] pointer-events-none"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1856,columnNumber:9},void 0),o.jsxDEV("div",{className:"h-16 flex items-center justify-between px-4 relative z-10 border-b border-slate-800/50",children:[o.jsxDEV("div",{className:`flex items-center gap-4 transition-all duration-300 ${m?"justify-center w-full":""}`,children:[o.jsxDEV("div",{className:"relative group cursor-pointer",children:[o.jsxDEV("div",{className:"absolute inset-0 bg-cyan-500 rounded-lg blur-md opacity-40 group-hover:opacity-60 transition-opacity duration-500"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1862,columnNumber:15},void 0),o.jsxDEV("div",{className:"w-12 h-9 rounded-lg bg-slate-900/90 flex items-center justify-center shadow-lg shadow-cyan-900/20 relative z-10 border border-cyan-500/30 overflow-hidden",children:o.jsxDEV("img",{src:"/logo.png",alt:"DaftriX",className:"h-7 w-auto object-contain"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1864,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1863,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1861,columnNumber:13},void 0),!m&&o.jsxDEV("div",{className:"animate-fade-in overflow-hidden whitespace-nowrap",children:[o.jsxDEV("h1",{className:"text-lg font-bold tracking-tight text-white font-display",children:r?.companyName||"DaftriX ERP"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1870,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-center gap-1.5 mt-0.5",children:[o.jsxDEV("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)]"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1872,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-[11px] text-slate-400 font-medium tracking-wide",children:"الإصدار السحابي 2.0"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1873,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1871,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1869,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1860,columnNumber:11},void 0),o.jsxDEV("button",{onClick:()=>x(!m),className:"hidden lg:flex absolute -left-3 top-1/2 -translate-y-1/2 w-7 h-7 bg-slate-800 border border-slate-600 rounded-full items-center justify-center text-slate-400 hover:text-white hover:bg-indigo-600 hover:border-indigo-500 transition-all z-50 shadow-lg group",children:m?o.jsxDEV(ps,{size:14,className:"group-hover:scale-110 transition-transform"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1884,columnNumber:28},void 0):o.jsxDEV(jn,{size:14,className:"group-hover:scale-110 transition-transform"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1884,columnNumber:111},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1880,columnNumber:11},void 0),o.jsxDEV("button",{onClick:()=>N(!1),className:"lg:hidden text-slate-400 hover:text-white transition-colors p-2 hover:bg-white/5 rounded-lg",children:o.jsxDEV(ss,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1889,columnNumber:13},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1888,columnNumber:11},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1859,columnNumber:9},void 0),o.jsxDEV("nav",{className:"flex-1 overflow-y-auto py-4 px-3 space-y-1 relative z-10 sidebar-scroll",children:xt.map((u,v)=>{const M=$e.startsWith(u.id)||u.subItems&&u.subItems.some(le=>le.id===$e),Ve=S===u.id,Z={indigo:{active:"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white shadow-md shadow-indigo-900/10",text:"text-indigo-400",glow:"bg-indigo-500/20",subText:"text-indigo-300",subBg:"bg-indigo-500/10",subDot:"bg-indigo-400 shadow-[0_0_5px_rgba(129,140,248,0.8)]"},cyan:{active:"bg-gradient-to-r from-cyan-600 to-cyan-700 text-white shadow-md shadow-cyan-900/10",text:"text-cyan-400",glow:"bg-cyan-500/20",subText:"text-cyan-300",subBg:"bg-cyan-500/10",subDot:"bg-cyan-400 shadow-[0_0_5px_rgba(34,211,238,0.8)]"},orange:{active:"bg-gradient-to-r from-orange-600 to-orange-700 text-white shadow-md shadow-orange-900/10",text:"text-orange-400",glow:"bg-orange-500/20",subText:"text-orange-300",subBg:"bg-orange-500/10",subDot:"bg-orange-400 shadow-[0_0_5px_rgba(2fb,146,60,0.8)]"},emerald:{active:"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-md shadow-emerald-900/10",text:"text-emerald-400",glow:"bg-emerald-500/20",subText:"text-emerald-300",subBg:"bg-emerald-500/10",subDot:"bg-emerald-400 shadow-[0_0_5px_rgba(52,211,153,0.8)]"},purple:{active:"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-md shadow-purple-900/10",text:"text-purple-400",glow:"bg-purple-500/20",subText:"text-purple-300",subBg:"bg-purple-500/10",subDot:"bg-purple-400 shadow-[0_0_5px_rgba(192,132,252,0.8)]"},violet:{active:"bg-gradient-to-r from-violet-600 to-violet-700 text-white shadow-md shadow-violet-900/10",text:"text-violet-400",glow:"bg-violet-500/20",subText:"text-violet-300",subBg:"bg-violet-500/10",subDot:"bg-violet-400 shadow-[0_0_5px_rgba(167,139,250,0.8)]"},amber:{active:"bg-gradient-to-r from-amber-600 to-amber-700 text-white shadow-md shadow-amber-900/10",text:"text-amber-400",glow:"bg-amber-500/20",subText:"text-amber-300",subBg:"bg-amber-500/10",subDot:"bg-amber-400 shadow-[0_0_5px_rgba(251,191,36,0.8)]"},slate:{active:"bg-gradient-to-r from-slate-600 to-slate-700 text-white shadow-md shadow-slate-900/10",text:"text-slate-400",glow:"bg-slate-500/20",subText:"text-slate-300",subBg:"bg-slate-500/10",subDot:"bg-slate-400 shadow-[0_0_5px_rgba(148,163,184,0.8)]"},rose:{active:"bg-gradient-to-r from-rose-600 to-rose-700 text-white shadow-md shadow-rose-900/10",text:"text-rose-400",glow:"bg-rose-500/20",subText:"text-rose-300",subBg:"bg-rose-500/10",subDot:"bg-rose-400 shadow-[0_0_5px_rgba(251,113,133,0.8)]"},blue:{active:"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-md shadow-blue-900/10",text:"text-blue-400",glow:"bg-blue-500/20",subText:"text-blue-300",subBg:"bg-blue-500/10",subDot:"bg-blue-400 shadow-[0_0_5px_rgba(96,165,250,0.8)]"}},$=Z[u.color||"indigo"]||Z.indigo,re=["suppliers","inventory","banks-module","accounting"].includes(u.id)&&v>0;return o.jsxDEV("div",{className:"group/item relative",children:[re&&!m&&o.jsxDEV("div",{className:"my-3 mx-2 flex items-center gap-2",children:[o.jsxDEV("div",{className:"flex-1 h-px bg-gradient-to-l from-slate-700/50 via-slate-600/30 to-transparent"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1994,columnNumber:21},void 0),o.jsxDEV("span",{className:"text-[9px] font-bold text-slate-600 uppercase tracking-widest",children:[u.id==="suppliers"&&"الشركاء",u.id==="inventory"&&"المخازن",u.id==="banks-module"&&"البنوك",u.id==="accounting"&&"الحسابات"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1995,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-700/50 via-slate-600/30 to-transparent"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2001,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1993,columnNumber:19},void 0),re&&m&&o.jsxDEV("div",{className:"my-2 mx-2 h-px bg-gradient-to-r from-transparent via-slate-700/50 to-transparent"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2005,columnNumber:19},void 0),o.jsxDEV("a",{href:u.subItems?"#":`#/${u.id}`,onClick:le=>{if(u.subItems)if(le.preventDefault(),m){let i=le.currentTarget.getBoundingClientRect().top;const w=50+u.subItems.length*40+10,j=window.innerHeight;i+w>j&&(i=j-w-70),i<10&&(i=10),U(Y?.id===u.id?null:{id:u.id,top:i})}else ht(u.id);else le.preventDefault(),s(u.id),window.innerWidth<1024&&N(!1)},onMouseEnter:le=>{if(m&&u.subItems){let i=le.currentTarget.getBoundingClientRect().top;const w=50+u.subItems.length*40+10,j=window.innerHeight;i+w>j&&(i=j-w-70),i<10&&(i=10),U({id:u.id,top:i})}},onMouseLeave:()=>{},className:`
                  w-full flex items-center rounded-lg transition-all duration-200 relative overflow-hidden no-underline group
                  ${m?"justify-center px-0 py-2.5":"justify-between px-3 py-2.5"}
                  ${M?$.active:"text-slate-400 hover:bg-white/[0.03] hover:text-slate-200"}
                `,title:m?u.label:"",children:[M&&o.jsxDEV("div",{className:`absolute inset-0 ${$.glow} blur-xl`},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2073,columnNumber:21},void 0),o.jsxDEV("div",{className:`flex items-center gap-4 relative z-10 ${m?"":"w-full"}`,children:[o.jsxDEV(u.icon,{size:18,className:`transition-transform duration-300 shrink-0 ${M?"text-white":`text-slate-500 group-hover:${$.text} group-hover:scale-110`}`},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2077,columnNumber:21},void 0),!m&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:`font-medium text-[13px] tracking-wide ${M?"text-white":""}`,children:u.label},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2084,columnNumber:25},void 0),u.subItems&&o.jsxDEV("div",{className:`mr-auto transition-transform duration-300 ${Ve?`rotate-90 ${$.subText}`:"text-slate-600 group-hover:text-slate-500"}`,children:o.jsxDEV(ps,{size:14},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2087,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2086,columnNumber:27},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2083,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2076,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2007,columnNumber:17},void 0),!m&&u.subItems&&o.jsxDEV("div",{className:`
                  overflow-hidden transition-all duration-500 ease-in-out
                  ${Ve?"max-h-[800px] opacity-100 mt-2 mb-2":"max-h-0 opacity-0"}
                `,children:o.jsxDEV("div",{className:"relative mr-4 pl-0 space-y-0.5 border-r border-slate-800 pr-2 mt-1",children:u.subItems.map(le=>o.jsxDEV("a",{href:`#/${le.id}`,onClick:Ge=>{Ge.preventDefault(),s(le.id),window.innerWidth<1024&&N(!1)},className:`
                            w-full flex items-center pr-3 pl-2 py-2 text-[12px] transition-all rounded-md no-underline relative
                            ${$e===le.id?`${$.subText} font-medium ${$.subBg} translate-x-1`:"text-slate-500 hover:text-slate-300 hover:bg-white/[0.02] hover:translate-x-1"}
                          `,children:[o.jsxDEV("span",{className:`w-1.5 h-1.5 rounded-full mr-2 transition-colors ${$e===le.id?$.subDot:"bg-slate-700"}`},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2119,columnNumber:29},void 0),le.label]},le.id,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2104,columnNumber:27},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2102,columnNumber:23},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2098,columnNumber:21},void 0),m&&u.subItems&&Y?.id===u.id&&gn.createPortal(o.jsxDEV("div",{className:"fixed bg-[#0f172a] rounded-xl shadow-2xl border border-slate-700/50 py-2 px-1 min-w-[240px] z-[9999] animate-fade-in-right",style:{top:`${Y.top}px`,right:"70px"},onMouseEnter:()=>U({id:u.id,top:Y.top}),onMouseLeave:()=>U(null),children:[o.jsxDEV("div",{className:"px-4 py-3 border-b border-slate-800/50 mb-2 bg-slate-800/30 rounded-t-lg",children:o.jsxDEV("div",{className:"flex items-center gap-2 text-white font-bold text-sm",children:[o.jsxDEV(u.icon,{size:18,className:$.text},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2142,columnNumber:27},void 0),u.label]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2141,columnNumber:25},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2140,columnNumber:23},void 0),o.jsxDEV("div",{className:"space-y-1 px-1 pb-1",children:u.subItems.map(le=>o.jsxDEV("a",{href:`#/${le.id}`,onClick:()=>{s(le.id),U(null),window.innerWidth<1024&&N(!1)},className:`
                            w-full flex items-center px-3 py-2.5 text-[13px] transition-all rounded-lg no-underline
                            ${$e===le.id?`${$.subText} font-bold ${$.subBg}`:"text-slate-400 hover:text-white hover:bg-white/10"}
                          `,children:le.label},le.id,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2148,columnNumber:27},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2146,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2131,columnNumber:21},void 0),document.body)]},u.id,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1990,columnNumber:15},void 0)})},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1894,columnNumber:9},void 0),o.jsxDEV("div",{className:`p-3 border-t border-slate-800/50 bg-slate-900/50 relative z-10 ${m?"flex justify-center":""}`,children:o.jsxDEV("div",{className:`flex items-center gap-3 rounded-2xl hover:bg-white/5 transition-all cursor-pointer group border border-transparent hover:border-white/5 ${m?"p-0 justify-center":"p-3 bg-slate-800/50"}`,children:[o.jsxDEV("div",{className:"relative shrink-0",children:[o.jsxDEV("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-indigo-500 to-purple-600 flex items-center justify-center text-white shadow-lg border-2 border-slate-800 group-hover:border-indigo-500/50 transition-colors",children:o.jsxDEV(ys,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2183,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2182,columnNumber:15},void 0),o.jsxDEV("span",{className:"absolute bottom-0 right-0 w-3 h-3 bg-emerald-500 border-2 border-slate-900 rounded-full shadow-sm"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2185,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2181,columnNumber:13},void 0),!m&&o.jsxDEV("div",{className:"flex flex-col overflow-hidden",children:[o.jsxDEV("span",{className:"text-sm font-bold text-slate-200 truncate group-hover:text-white transition-colors",children:V.name||"مستخدم"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2189,columnNumber:17},void 0),o.jsxDEV("span",{className:"text-[10px] text-slate-500 truncate group-hover:text-slate-400 transition-colors",children:V.email||""},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2190,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2188,columnNumber:15},void 0),!m&&o.jsxDEV("button",{onClick:u=>{u.stopPropagation(),Je(!0)},className:"mr-auto text-slate-500 hover:text-indigo-400 transition-colors p-1.5 rounded-lg hover:bg-white/10",children:o.jsxDEV(Cs,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2201,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2194,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2180,columnNumber:11},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2179,columnNumber:9},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1846,columnNumber:7},void 0),o.jsxDEV("div",{className:"flex-1 flex flex-col overflow-hidden relative print:overflow-visible print:h-auto",children:[o.jsxDEV("header",{className:"h-14 sm:h-20 bg-white/80 backdrop-blur-xl border-b border-slate-200/60 z-30 flex items-center justify-between px-3 sm:px-6 lg:px-8 sticky top-0 transition-all shadow-sm print:hidden",children:[o.jsxDEV("div",{className:"flex items-center gap-2 sm:gap-6",children:o.jsxDEV("div",{className:"flex flex-col",children:[o.jsxDEV("div",{className:"hidden md:flex items-center gap-2 text-xs text-slate-500 font-medium mb-1",children:[o.jsxDEV("span",{className:"opacity-60 hover:opacity-100 transition-opacity cursor-default",children:"النظام"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2219,columnNumber:17},void 0),et.map((u,v)=>o.jsxDEV(Ns.Fragment,{children:[o.jsxDEV(ps,{size:10,className:"text-slate-300"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2222,columnNumber:21},void 0),o.jsxDEV("span",{className:`${v===et.length-1?"text-indigo-600 font-bold bg-indigo-50 px-2 py-0.5 rounded-full":"hover:text-slate-800 transition-colors"}`,children:u},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2223,columnNumber:21},void 0)]},v,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2221,columnNumber:19},void 0))]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2218,columnNumber:15},void 0),o.jsxDEV("h2",{className:"text-base sm:text-xl md:text-2xl font-bold text-slate-800 leading-none tracking-tight truncate max-w-[150px] sm:max-w-none",children:et[et.length-1]},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2227,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2217,columnNumber:13},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2213,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center gap-1.5 sm:gap-3 lg:gap-5",children:[o.jsxDEV("div",{className:"hidden md:flex relative group w-80 lg:w-96",children:[o.jsxDEV("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full opacity-0 group-hover:opacity-25 blur transition duration-500"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2235,columnNumber:15},void 0),o.jsxDEV("div",{className:"relative w-full bg-slate-50/80 backdrop-blur-sm border border-slate-200 cursor-pointer rounded-full py-2.5 pr-12 pl-4 text-sm flex items-center justify-between text-slate-500 hover:bg-white hover:border-indigo-300 hover:shadow-lg hover:shadow-indigo-500/10 transition-all duration-300",onClick:()=>Ne(!0),children:[o.jsxDEV("span",{className:"font-medium group-hover:text-indigo-700 transition-colors",children:"ابحث عن أي شيء..."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2241,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-center gap-1.5",children:o.jsxDEV("kbd",{className:"hidden sm:inline-flex items-center h-6 px-2 bg-white border border-slate-200 rounded-md text-[10px] font-bold text-slate-400 shadow-[0_1px_1px_0_rgba(0,0,0,0.05)] group-hover:border-indigo-200 group-hover:text-indigo-500 transition-colors font-mono",children:"Ctrl + K"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2243,columnNumber:19},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2242,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2237,columnNumber:15},void 0),o.jsxDEV(Qt,{size:20,className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 group-hover:text-indigo-600 group-hover:scale-110 transition-all duration-300 pointer-events-none"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2248,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2233,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>Ne(!0),className:"md:hidden text-slate-500 hover:text-indigo-600 p-2 rounded-lg hover:bg-indigo-50 transition-colors",children:o.jsxDEV(Qt,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2256,columnNumber:15},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2252,columnNumber:13},void 0),o.jsxDEV("div",{className:"h-6 sm:h-8 w-px bg-slate-200 mx-0.5 sm:mx-1 hidden sm:block"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2259,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>C(y==="ar"?"en":"ar"),className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg sm:rounded-xl transition-all font-bold text-xs flex items-center gap-0.5 sm:gap-1",title:y==="ar"?"Switch to English":"التبديل للعربية",children:[o.jsxDEV(Bn,{size:18,className:"sm:w-5 sm:h-5"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2267,columnNumber:15},void 0),o.jsxDEV("span",{className:"uppercase hidden sm:inline",children:y==="ar"?"EN":"AR"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2268,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2262,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center gap-1 sm:gap-2 relative",children:[o.jsxDEV("button",{onClick:()=>oe(!D),className:`p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg sm:rounded-xl transition-all relative group ${D?"bg-indigo-50 text-indigo-600 shadow-inner":""}`,title:"المستخدمين المتصلين",children:[o.jsxDEV(Ht,{size:18,className:"sm:w-5 sm:h-5"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2278,columnNumber:17},void 0),p&&p.length>0&&o.jsxDEV("span",{className:"absolute top-1.5 sm:top-2.5 right-1.5 sm:right-2.5 w-2 h-2 sm:w-2.5 sm:h-2.5 bg-emerald-500 rounded-full border-2 border-white shadow-sm animate-pulse"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2280,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2273,columnNumber:15},void 0),D&&o.jsxDEV("div",{className:"absolute top-full left-0 mt-4 w-72 bg-white/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/20 ring-1 ring-black/5 overflow-hidden animate-fade-in z-50 origin-top-left",children:[o.jsxDEV("div",{className:"p-4 border-b border-slate-100/50 bg-slate-50/50 flex justify-between items-center",children:[o.jsxDEV("h3",{className:"font-bold text-slate-800",children:"المتصلين الآن"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2288,columnNumber:21},void 0),o.jsxDEV("span",{className:"bg-emerald-100 text-emerald-600 text-xs font-bold px-2 py-0.5 rounded-full border border-emerald-200 shadow-sm",children:ve.length},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2289,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2287,columnNumber:19},void 0),o.jsxDEV("div",{className:"max-h-[300px] overflow-y-auto p-2 space-y-1",children:ve.map(u=>o.jsxDEV("div",{className:"flex items-start gap-3 p-2 rounded-lg hover:bg-slate-50 transition-colors bg-white/50 border border-slate-100",children:[o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold shadow-sm",children:u.userName.charAt(0).toUpperCase()},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2295,columnNumber:27},void 0),u.count>1&&o.jsxDEV("div",{className:"absolute -top-1 -right-1 bg-rose-500 text-white text-[9px] w-4 h-4 rounded-full flex items-center justify-center border-2 border-white font-bold",title:`${u.count} جلسات مفتوحة`,children:u.count},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2299,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2294,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"text-sm font-bold text-slate-700 truncate flex justify-between items-center",children:o.jsxDEV("span",{children:[u.userName," ",(u.userId===(V.id||"admin")||u.userName===V.name)&&"(أنت)"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2306,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2305,columnNumber:27},void 0),u.views.length>0&&o.jsxDEV("div",{className:"text-[10px] text-slate-500 mt-1 space-y-0.5",children:[u.views.slice(0,3).map((v,M)=>o.jsxDEV("div",{className:"flex items-center gap-1 opacity-80",children:[o.jsxDEV(kn,{size:10,className:"text-indigo-400"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2313,columnNumber:35},void 0),o.jsxDEV("span",{className:"truncate",children:v.includes("|")?"بيانات الفاتورة/السند":v.replace("sup-statement","كشف حساب").replace("inv-purchase","فواتير شراء").replace("inv-sale","فواتير مبيعات")},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2314,columnNumber:35},void 0)]},M,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2312,columnNumber:33},void 0)),u.views.length>3&&o.jsxDEV("div",{className:"text-xs text-slate-400 pl-4",children:["+ ",u.views.length-3," صفحات أخرى"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2317,columnNumber:57},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2310,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2304,columnNumber:25},void 0),o.jsxDEV("div",{className:"w-2 h-2 bg-emerald-500 rounded-full shadow-sm animate-pulse mt-2"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2321,columnNumber:25},void 0)]},u.userName,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2293,columnNumber:23},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2291,columnNumber:19},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2286,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2272,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center gap-1 sm:gap-2 relative",children:[!ie&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("button",{onClick:()=>T(!se),className:`p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg sm:rounded-xl transition-all relative group ${se?"bg-indigo-50 text-indigo-600 shadow-inner":""}`,children:[o.jsxDEV(ks,{size:18,className:`sm:w-5 sm:h-5 ${it.length>0?"animate-swing":""}`},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2337,columnNumber:21},void 0),it.length>0&&o.jsxDEV("span",{className:"absolute top-1.5 sm:top-2.5 right-2 sm:right-3 w-2 h-2 sm:w-2.5 sm:h-2.5 bg-rose-500 rounded-full border-2 border-white shadow-sm"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2339,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2333,columnNumber:19},void 0),se&&o.jsxDEV("div",{className:"absolute top-full left-0 mt-4 w-80 bg-white/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/20 ring-1 ring-black/5 overflow-hidden animate-fade-in z-50 origin-top-left",children:[o.jsxDEV("div",{className:"p-4 border-b border-slate-100/50 bg-slate-50/50 flex justify-between items-center",children:[o.jsxDEV("h3",{className:"font-bold text-slate-800",children:"التنبيهات"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2347,columnNumber:25},void 0),o.jsxDEV("span",{className:"bg-rose-100 text-rose-600 text-xs font-bold px-2 py-0.5 rounded-full border border-rose-200 shadow-sm",children:it.length},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2348,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2346,columnNumber:23},void 0),o.jsxDEV("div",{className:"max-h-[300px] overflow-y-auto",children:it.length===0?o.jsxDEV("div",{className:"p-10 text-center text-slate-400 text-sm flex flex-col items-center gap-2",children:[o.jsxDEV(ks,{size:32,className:"opacity-20"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2353,columnNumber:29},void 0),o.jsxDEV("span",{children:"لا توجد تنبيهات جديدة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2354,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2352,columnNumber:27},void 0):it.map((u,v)=>o.jsxDEV("button",{onClick:()=>{s(u.action),T(!1)},className:"w-full text-right p-4 hover:bg-indigo-50/50 border-b border-slate-50 flex gap-4 items-start transition-colors group",children:[o.jsxDEV("div",{className:`p-2.5 rounded-xl shrink-0 shadow-sm ${u.type==="CHEQUE"?"bg-indigo-100 text-indigo-600 group-hover:bg-indigo-200":"bg-rose-100 text-rose-600 group-hover:bg-rose-200"} transition-colors`,children:u.type==="CHEQUE"?o.jsxDEV(js,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2363,columnNumber:58},void 0):o.jsxDEV(fs,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2363,columnNumber:85},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2362,columnNumber:29},void 0),o.jsxDEV("div",{children:[o.jsxDEV("div",{className:"text-sm font-bold text-slate-800 mb-1 group-hover:text-indigo-700 transition-colors",children:u.title},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2366,columnNumber:31},void 0),o.jsxDEV("div",{className:"text-xs text-slate-500 leading-relaxed",children:u.desc},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2367,columnNumber:31},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2365,columnNumber:29},void 0)]},v,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2357,columnNumber:27},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2350,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2345,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2332,columnNumber:17},void 0),o.jsxDEV("button",{onClick:a,className:"p-2 text-slate-500 hover:text-rose-600 hover:bg-rose-50 rounded-lg sm:rounded-xl transition-all",title:"تسجيل خروج",children:o.jsxDEV(Ks,{size:18,className:"sm:w-5 sm:h-5"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2378,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2377,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2330,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2231,columnNumber:11},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2212,columnNumber:9},void 0),o.jsxDEV("main",{className:"flex-1 overflow-x-hidden overflow-y-auto p-3 md:p-8 lg:p-10 pb-20 lg:pb-10 scroll-smooth relative print:overflow-visible print:p-0 print:pb-0 print:h-auto",children:o.jsxDEV("div",{className:"max-w-[1600px] mx-auto pb-10 print:max-w-none print:pb-0",children:[(()=>{if(!r?.licenseExpiryDate)return null;const u=new Date;u.setHours(0,0,0,0);const v=new Date(r.licenseExpiryDate);v.setHours(0,0,0,0);const M=Math.ceil((v.getTime()-u.getTime())/(1e3*60*60*24));return M>0&&M<=7?o.jsxDEV("div",{className:`mb-4 p-4 rounded-xl border-2 flex items-center gap-3 animate-pulse ${M<=3?"bg-rose-50 border-rose-300 text-rose-800":"bg-amber-50 border-amber-300 text-amber-800"}`,children:[o.jsxDEV("div",{className:`p-2 rounded-lg ${M<=3?"bg-rose-100":"bg-amber-100"}`,children:o.jsxDEV(_t,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2403,columnNumber:23},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2402,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("p",{className:"font-bold text-lg",children:M<=3?`⚠️ تحذير هام: ينتهي الترخيص خلال ${M} ${M===1?"يوم":"أيام"} فقط!`:`تنبيه: ينتهي ترخيص النظام خلال ${M} أيام`},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2406,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-sm opacity-80 mt-1",children:["يرجى التواصل مع الدعم الفني لتجديد الترخيص قبل ",v.toLocaleDateString("ar-EG")," لتجنب توقف النظام"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2412,columnNumber:23},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2405,columnNumber:21},void 0),o.jsxDEV("button",{onClick:()=>xe(!0),className:`px-4 py-2 rounded-lg font-bold text-sm whitespace-nowrap ${M<=3?"bg-rose-600 text-white hover:bg-rose-700":"bg-amber-600 text-white hover:bg-amber-700"}`,children:"تجديد الآن"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2416,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2398,columnNumber:19},void 0):null})(),t]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2386,columnNumber:11},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2385,columnNumber:9},void 0),o.jsxDEV("nav",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-xl border-t border-slate-200/50 shadow-[0_-4px_20px_rgba(0,0,0,0.08)] print:hidden",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:o.jsxDEV("div",{className:"flex items-center justify-around h-16 px-2 max-w-lg mx-auto",children:[te.map(u=>{const v=$e===u.id||e.startsWith(u.id),M=u.icon;return o.jsxDEV("button",{onClick:()=>s(u.id),className:`
                    flex flex-col items-center justify-center flex-1 h-full px-2 transition-all duration-300 relative group
                    ${v?"text-indigo-600":"text-slate-400 hover:text-slate-600"}
                  `,children:[v&&o.jsxDEV("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-8 h-1 bg-indigo-500 rounded-b-full shadow-lg shadow-indigo-500/30"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2455,columnNumber:21},void 0),o.jsxDEV("div",{className:`
                    p-2 rounded-xl transition-all duration-300
                    ${v?"bg-indigo-100 scale-110":"group-hover:bg-slate-100 group-hover:scale-105"}
                  `,children:o.jsxDEV(M,{size:20,className:v?"animate-bounce-subtle":""},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2465,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2458,columnNumber:19},void 0),o.jsxDEV("span",{className:`
                    text-[10px] font-bold mt-1 transition-all duration-300
                    ${v?"text-indigo-600":"text-slate-500"}
                  `,children:u.label},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2468,columnNumber:19},void 0)]},u.id,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2442,columnNumber:17},void 0)}),o.jsxDEV("button",{onClick:()=>N(!0),className:"flex flex-col items-center justify-center flex-1 h-full px-2 transition-all duration-300 text-slate-400 hover:text-slate-600 group",children:[o.jsxDEV("div",{className:"p-2 rounded-xl transition-all duration-300 group-hover:bg-slate-100 group-hover:scale-105",children:o.jsxDEV(Vn,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2484,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2483,columnNumber:15},void 0),o.jsxDEV("span",{className:"text-[10px] font-bold mt-1 text-slate-500",children:"المزيد"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2486,columnNumber:15},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2479,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2436,columnNumber:11},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2435,columnNumber:9},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2209,columnNumber:7},void 0),o.jsxDEV("style",{children:`
        .sidebar-scroll::-webkit-scrollbar {
          width: 4px;
        }
        .sidebar-scroll::-webkit-scrollbar-track {
          background: transparent;
        }
        .sidebar-scroll::-webkit-scrollbar-thumb {
          background: rgba(100, 116, 139, 0.3);
          border-radius: 4px;
        }
        .sidebar-scroll::-webkit-scrollbar-thumb:hover {
          background: rgba(100, 116, 139, 0.5);
        }
        
        @keyframes bounce-subtle {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-2px); }
        }
        .animate-bounce-subtle {
          animation: bounce-subtle 0.6s ease-in-out;
        }
        
        @keyframes slide-in-right {
          from { opacity: 0; transform: translateX(10px); }
          to { opacity: 1; transform: translateX(0); }
        }
        .animate-slide-in-right {
          animation: slide-in-right 0.2s ease-out;
        }
      `},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:2493,columnNumber:7},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/Layout.tsx",lineNumber:1121,columnNumber:5},void 0)});new Date().getFullYear();const va={companyName:"اسم الشركة (Company Name)",companyAddress:"العنوان",companyPhone:"",companyEmail:""},sn=[{id:"sales.view",label:"عرض فواتير البيع",module:"المبيعات"},{id:"sales.create",label:"إنشاء فاتورة بيع",module:"المبيعات"},{id:"sales.edit",label:"تعديل فاتورة بيع",module:"المبيعات"},{id:"sales.delete",label:"حذف فاتورة بيع",module:"المبيعات"},{id:"sales.discount",label:"إضافة خصم على المبيعات",module:"المبيعات"},{id:"sales.edit_price",label:"تعديل سعر البيع",module:"المبيعات"},{id:"sales.return",label:"مرتجع مبيعات",module:"المبيعات"},{id:"sales.print",label:"طباعة فواتير البيع",module:"المبيعات"},{id:"sales.view_cost",label:"عرض سعر التكلفة",module:"المبيعات"},{id:"sales.approve_credit",label:"تجاوز الحد الائتماني",module:"المبيعات"},{id:"sales.manage",label:"إدارة كاملة للمبيعات",module:"المبيعات"},{id:"purchase.view",label:"عرض فواتير الشراء",module:"المشتريات"},{id:"purchase.create",label:"إنشاء فاتورة شراء",module:"المشتريات"},{id:"purchase.edit",label:"تعديل فاتورة شراء",module:"المشتريات"},{id:"purchase.delete",label:"حذف فاتورة شراء",module:"المشتريات"},{id:"purchase.return",label:"مرتجع مشتريات",module:"المشتريات"},{id:"purchase.manage",label:"إدارة كاملة للمشتريات",module:"المشتريات"},{id:"customers.view",label:"عرض العملاء",module:"العملاء"},{id:"customers.manage",label:"إضافة/تعديل عميل",module:"العملاء"},{id:"customers.delete",label:"حذف عميل",module:"العملاء"},{id:"customers.statement",label:"كشف حساب العميل",module:"العملاء"},{id:"customers.balances",label:"أرصدة العملاء",module:"العملاء"},{id:"customers.prices",label:"أسعار العملاء الخاصة",module:"العملاء"},{id:"customers.discount",label:"خصم مسموح به",module:"العملاء"},{id:"customers.payments",label:"مقبوضات العملاء",module:"العملاء"},{id:"suppliers.view",label:"عرض الموردين",module:"الموردين"},{id:"suppliers.manage",label:"إضافة/تعديل مورد",module:"الموردين"},{id:"suppliers.delete",label:"حذف مورد",module:"الموردين"},{id:"suppliers.statement",label:"كشف حساب المورد",module:"الموردين"},{id:"suppliers.balances",label:"أرصدة الموردين",module:"الموردين"},{id:"suppliers.discount",label:"خصم مكتسب",module:"الموردين"},{id:"suppliers.payments",label:"مدفوعات للموردين",module:"الموردين"},{id:"inventory.view",label:"عرض المخزون والأصناف",module:"المخزون"},{id:"inventory.manage",label:"إدارة الأصناف (إضافة/تعديل)",module:"المخزون"},{id:"inventory.delete",label:"حذف أصناف",module:"المخزون"},{id:"inventory.permit_in",label:"إذن إضافة مخزني",module:"المخزون"},{id:"inventory.permit_out",label:"إذن صرف مخزني",module:"المخزون"},{id:"inventory.transfer",label:"إذن تحويل مخزني",module:"المخزون"},{id:"inventory.stock_taking",label:"جرد المخازن",module:"المخزون"},{id:"inventory.view_value",label:"عرض قيمة المخزون",module:"المخزون"},{id:"inventory.barcode",label:"طباعة الباركود",module:"المخزون"},{id:"treasury.view",label:"عرض الخزينة",module:"الخزينة والبنوك"},{id:"treasury.manage",label:"إدارة الخزينة",module:"الخزينة والبنوك"},{id:"treasury.receipt",label:"سند قبض (تحصيل)",module:"الخزينة والبنوك"},{id:"treasury.payment",label:"سند صرف (دفع)",module:"الخزينة والبنوك"},{id:"treasury.cheques",label:"إدارة الشيكات",module:"الخزينة والبنوك"},{id:"treasury.transfer",label:"تحويل داخلي (Contra)",module:"الخزينة والبنوك"},{id:"treasury.view_balance",label:"عرض أرصدة البنوك",module:"الخزينة والبنوك"},{id:"treasury.bank_recon",label:"تسوية البنك",module:"الخزينة والبنوك"},{id:"accounting.view",label:"عرض شجرة الحسابات",module:"الحسابات"},{id:"accounting.manage",label:"إدارة الحسابات",module:"الحسابات"},{id:"accounting.journal",label:"قيود اليومية",module:"الحسابات"},{id:"accounting.assets",label:"الأصول الثابتة",module:"الحسابات"},{id:"accounting.cost_centers",label:"مراكز التكلفة",module:"الحسابات"},{id:"accounting.close_year",label:"إقفال السنة المالية",module:"الحسابات"},{id:"reports.view",label:"عرض التقارير",module:"التقارير"},{id:"reports.sales",label:"تقارير المبيعات",module:"التقارير"},{id:"reports.purchase",label:"تقارير المشتريات",module:"التقارير"},{id:"reports.inventory",label:"تقارير المخزون",module:"التقارير"},{id:"reports.treasury",label:"تقارير الخزينة",module:"التقارير"},{id:"reports.financial",label:"التقارير المالية (ميزانية/أرباح)",module:"التقارير"},{id:"manufacturing.view",label:"عرض التصنيع",module:"التصنيع"},{id:"manufacturing.manage",label:"إدارة أوامر التصنيع",module:"التصنيع"},{id:"manufacturing.bom",label:"قوائم المواد (BOM)",module:"التصنيع"},{id:"manufacturing.production",label:"أوامر الإنتاج",module:"التصنيع"},{id:"vansales.view",label:"عرض المبيعات المتنقلة",module:"المبيعات المتنقلة"},{id:"vansales.manage",label:"إدارة المبيعات المتنقلة",module:"المبيعات المتنقلة"},{id:"pos.access",label:"الوصول لنقطة البيع",module:"نقطة البيع"},{id:"pos.open_shift",label:"فتح وردية",module:"نقطة البيع"},{id:"pos.close_shift",label:"إغلاق وردية",module:"نقطة البيع"},{id:"pos.sale",label:"إجراء بيع",module:"نقطة البيع"},{id:"pos.refund",label:"مرتجع نقطة البيع",module:"نقطة البيع"},{id:"pos.discount",label:"خصم في نقطة البيع",module:"نقطة البيع"},{id:"pos.edit_price",label:"تعديل السعر",module:"نقطة البيع"},{id:"pos.cash_movement",label:"إيداع/سحب من الدرج",module:"نقطة البيع"},{id:"pos.hold_order",label:"تعليق الطلبات",module:"نقطة البيع"},{id:"pos.reports",label:"تقارير نقطة البيع",module:"نقطة البيع"},{id:"pos.manage",label:"إدارة كاملة لنقطة البيع",module:"نقطة البيع"},{id:"salesteam.view",label:"عرض فريق المبيعات",module:"فريق المبيعات"},{id:"salesteam.manage",label:"إدارة المندوبين",module:"فريق المبيعات"},{id:"salesteam.commissions",label:"العمولات",module:"فريق المبيعات"},{id:"salesteam.targets",label:"أهداف المندوبين",module:"فريق المبيعات"},{id:"hr.view",label:"عرض بيانات الموظفين",module:"الموارد البشرية"},{id:"hr.manage",label:"إدارة الموظفين",module:"الموارد البشرية"},{id:"hr.attendance",label:"الحضور والانصراف",module:"الموارد البشرية"},{id:"hr.payroll",label:"مسير الرواتب",module:"الموارد البشرية"},{id:"hr.advances",label:"السلف والقروض",module:"الموارد البشرية"},{id:"system.settings",label:"إعدادات النظام",module:"الإعدادات"},{id:"system.users",label:"إدارة المستخدمين والصلاحيات",module:"الإعدادات"},{id:"system.backup",label:"النسخ الاحتياطي والاستعادة",module:"الإعدادات"},{id:"system.audit",label:"سجل المراقبة",module:"الإعدادات"},{id:"system.migration",label:"استيراد البيانات",module:"الإعدادات"},{id:"master.branches",label:"تعريف الفروع",module:"البيانات الأساسية"},{id:"master.warehouses",label:"تعريف المخازن",module:"البيانات الأساسية"},{id:"master.categories",label:"فئات الأصناف",module:"البيانات الأساسية"},{id:"master.price_lists",label:"قوائم الأسعار",module:"البيانات الأساسية"},{id:"master.banks",label:"تعريف البنوك",module:"البيانات الأساسية"},{id:"master.salesmen",label:"تعريف المندوبين",module:"البيانات الأساسية"}];sn.map(t=>t.id);const no=()=>{try{const t=window.Capacitor;return t&&t.isNativePlatform&&t.isNativePlatform()}catch{return!1}},oo=()=>{const t=localStorage.getItem("erp_server_url");return t?`${t}/api`:"/api"},Tt=()=>oo(),l={get:async t=>{if(no())try{const{unifiedStorage:r}=await he(async()=>{const{unifiedStorage:d}=await Promise.resolve().then(()=>mn);return{unifiedStorage:d}},void 0);if(await r.initialize(),t==="/products"||t.startsWith("/products?")){const d=await r.getProducts();if(d.length>0)return d}if(t==="/partners"||t.startsWith("/partners?")){const d=await r.getPartners();if(d.length>0)return{partners:d,pagination:{total:d.length,page:1,limit:d.length,totalPages:1},stats:{netBalance:0,totalLiabilities:0,totalAssets:0}}}if(t==="/invoices"||t.startsWith("/invoices?")){const d=await r.getInvoices();if(d.length>0)return{invoices:d,pagination:{total:d.length,page:1,limit:d.length,totalPages:1}}}if(t==="/accounts"||t.startsWith("/accounts?")){const d=await r.getAccounts();if(d.length>0)return d}if(!navigator.onLine)return t.startsWith("/invoices")?{invoices:[],pagination:{total:0,page:1,limit:100,totalPages:0}}:t.startsWith("/partners")?{partners:[],pagination:{total:0,page:1,limit:100,totalPages:0},stats:{}}:t.startsWith("/products")?[]:t.startsWith("/accounts")?[]:t.includes("/master/")?[]:t.includes("/product-stocks")?[]:t.includes("/price-lists")?[]:t.includes("/settings")?{}:t.includes("/cheques")?{cheques:[],pagination:{total:0,page:1,limit:100,totalPages:0}}:t.includes("/banks")?[]:[]}catch{return t.startsWith("/invoices")?{invoices:[],pagination:{total:0,page:1,limit:100,totalPages:0}}:t.startsWith("/partners")?{partners:[],pagination:{total:0,page:1,limit:100,totalPages:0},stats:{}}:[]}const s=localStorage.getItem("authToken"),n={"ngrok-skip-browser-warning":"true"};s&&(n.Authorization=`Bearer ${s}`);const a=await fetch(`${Tt()}${t}`,{method:"GET",headers:n});if(!a.ok)throw new Error(await a.text());return a.json()},post:async(t,e)=>{const s=localStorage.getItem("authToken"),n={"Content-Type":"application/json","ngrok-skip-browser-warning":"true"};s&&(n.Authorization=`Bearer ${s}`),e.bankTransfers;const a=await fetch(`${Tt()}${t}`,{method:"POST",headers:n,body:JSON.stringify(e)});if(!a.ok)throw new Error(await a.text());return a.json()},put:async(t,e)=>{const s=localStorage.getItem("authToken"),n={"Content-Type":"application/json","ngrok-skip-browser-warning":"true"};s&&(n.Authorization=`Bearer ${s}`);const a=await fetch(`${Tt()}${t}`,{method:"PUT",headers:n,body:JSON.stringify(e)});if(!a.ok)throw new Error(await a.text());return a.json()},delete:async t=>{const e=localStorage.getItem("authToken"),s={"ngrok-skip-browser-warning":"true"};e&&(s.Authorization=`Bearer ${e}`);const n=await fetch(`${Tt()}${t}`,{method:"DELETE",headers:s});if(!n.ok)throw new Error(await n.text());const a=await n.text();return a?JSON.parse(a):void 0},patch:async(t,e)=>{const s=localStorage.getItem("authToken"),n={"Content-Type":"application/json","ngrok-skip-browser-warning":"true"};s&&(n.Authorization=`Bearer ${s}`);const a=await fetch(`${Tt()}${t}`,{method:"PATCH",headers:n,body:JSON.stringify(e)});if(!a.ok)throw new Error(await a.text());return a.json()},login:async t=>{const e=await fetch(`${Tt()}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(t)});if(!e.ok)throw new Error(await e.text());return e.json()},getProducts:async()=>l.get("/products"),getProductsPaginated:async(t,e,s)=>{const n=new URLSearchParams;return n.append("page",t.toString()),n.append("limit",e.toString()),s&&n.append("search",s),l.get(`/products/paginated?${n}`)},getNextSku:async()=>(await l.get("/products/next-sku")).nextSku,getProduct:async t=>l.get(`/products/${t}`),createProduct:async t=>l.post("/products",t),updateProduct:async t=>l.put(`/products/${t.id}`,t),deleteProduct:async t=>{const e=JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System";await l.delete(`/products/${t}?user=${encodeURIComponent(e)}`)},getProductPrices:async t=>l.get(`/products/${t}/prices`),updateProductPrices:async(t,e)=>{await l.put(`/products/${t}/prices`,{prices:e})},getProductUnits:async t=>l.get(`/products/${t}/units`),getUnitByBarcode:async t=>l.get(`/products/unit-by-barcode/${t}`),createProductUnit:async(t,e)=>l.post(`/products/${t}/units`,e),updateProductUnit:async(t,e,s)=>l.put(`/products/${t}/units/${e}`,s),deleteProductUnit:async(t,e)=>{await l.delete(`/products/${t}/units/${e}`)},getStockInAllUnits:async(t,e)=>{const s=e?`?warehouseId=${e}`:"";return l.get(`/products/${t}/units/stock${s}`)},bulkCreateProductUnits:async(t,e,s)=>l.post(`/products/${t}/units/bulk`,{units:e,replaceExisting:s}),convertQuantity:async(t,e,s,n)=>l.post(`/products/${t}/units/convert`,{fromUnitId:e,toUnitId:s,quantity:n}),getPartners:async t=>{const e=new URLSearchParams;t?.page&&e.append("page",t.page.toString()),t?.limit&&e.append("limit",t.limit.toString()),t?.type&&e.append("type",t.type),t?.search&&e.append("search",t.search),t?.isCustomer!==void 0&&e.append("isCustomer",t.isCustomer.toString()),t?.isSupplier!==void 0&&e.append("isSupplier",t.isSupplier.toString()),t?.balanceStatus&&e.append("balanceStatus",t.balanceStatus);const s=await l.get(`/partners?${e}`);return{partners:s.partners.map(n=>({...n,balance:parseFloat(n.balance)||0,openingBalance:parseFloat(n.openingBalance)||0,limit:parseFloat(n.limit)||0,paymentTerms:parseFloat(n.paymentTerms)||0})),pagination:s.pagination,stats:s.stats}},createPartner:async t=>l.post("/partners",t),updatePartner:async t=>l.put(`/partners/${t.id}`,t),deletePartner:async t=>{const e=JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System";await l.delete(`/partners/${t}?user=${encodeURIComponent(e)}`)},getAccounts:async()=>(await l.get("/accounts")).map(e=>({...e,balance:parseFloat(e.balance)||0,openingBalance:parseFloat(e.openingBalance)||0})),createAccount:async t=>l.post("/accounts",t),updateAccount:async t=>l.put(`/accounts/${t.id}`,t),deleteAccount:async t=>{const e=JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System";await l.delete(`/accounts/${t}?user=${encodeURIComponent(e)}`)},recalculateAccountBalances:async()=>{const t=JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System";return l.post("/accounts/recalculate-balances",{user:t})},getInvoices:async t=>{const e=new URLSearchParams;t?.page&&e.append("page",t.page.toString()),t?.limit&&e.append("limit",t.limit.toString()),t?.type&&e.append("type",t.type),t?.startDate&&e.append("startDate",t.startDate),t?.endDate&&e.append("endDate",t.endDate),t?.partnerId&&e.append("partnerId",t.partnerId),t?.search&&e.append("search",t.search),t?.minimal&&e.append("minimal","true");const s=await l.get(`/invoices?${e}`);return{invoices:s.invoices.map(n=>({...n,total:Number(n.total),taxAmount:Number(n.taxAmount||0),whtAmount:Number(n.whtAmount||0),shippingFee:Number(n.shippingFee||0),globalDiscount:Number(n.globalDiscount||0),lines:n.lines?n.lines.map(a=>({...a,quantity:Number(a.quantity),price:Number(a.price),cost:Number(a.cost||0),discount:Number(a.discount||0),total:Number(a.total)})):[]})),pagination:s.pagination}},getInvoice:async t=>{const e=await l.get(`/invoices/${t}`);return{...e,lines:e.lines?.map(s=>({...s,quantity:Number(s.quantity),price:Number(s.price),cost:Number(s.cost||0),discount:Number(s.discount||0),total:Number(s.total)}))||[],transactionCheques:e.transactionCheques||[]}},getDeletedInvoices:async t=>{const e=new URLSearchParams;return t?.page&&e.append("page",t.page.toString()),t?.limit&&e.append("limit",t.limit.toString()),t?.type&&e.append("type",t.type),t?.startDate&&e.append("startDate",t.startDate),t?.endDate&&e.append("endDate",t.endDate),t?.deletedBy&&e.append("deletedBy",t.deletedBy),t?.search&&e.append("search",t.search),l.get(`/invoices/deleted?${e}`)},getDeletedInvoice:async t=>l.get(`/invoices/deleted/${t}`),getDeletedInvoicesStats:async()=>l.get("/invoices/deleted/stats"),getCustomerLastProductPrice:async(t,e)=>l.get(`/invoices/customer-last-price/${t}/${e}`),getUsers:async()=>l.get("/users"),createUser:async t=>l.post("/users",t),updateUser:async t=>l.put(`/users/${t.id}`,t),deleteUser:async t=>{const e=JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System";await l.delete(`/users/${t}?user=${encodeURIComponent(e)}`)},updateUserPreferences:async(t,e)=>l.patch(`/users/${t}/preferences`,{preferences:e}),getMasterData:async t=>l.get(`/master/${t}`),createMasterData:async(t,e)=>l.post(`/master/${t}`,e),updateMasterData:async(t,e,s)=>l.put(`/master/${t}/${e}`,s),deleteMasterData:async(t,e)=>{await l.delete(`/master/${t}/${e}`)},getBanks:async()=>l.get("/treasury/banks"),createBank:async t=>l.post("/treasury/banks",t),updateBank:async t=>l.put(`/treasury/banks/${t.id}`,t),deleteBank:async t=>{const e=JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System";await l.delete(`/treasury/banks/${t}?user=${encodeURIComponent(e)}`)},resyncBankGL:async t=>l.post(`/treasury/banks/${t}/resync`,{}),getCheques:async t=>{const e=new URLSearchParams;t?.page&&e.append("page",t.page.toString()),t?.limit&&e.append("limit",t.limit.toString()),t?.status&&e.append("status",t.status),t?.type&&e.append("type",t.type),t?.partnerId&&e.append("partnerId",t.partnerId),t?.startDate&&e.append("startDate",t.startDate),t?.endDate&&e.append("endDate",t.endDate),t?.search&&e.append("search",t.search);const s=t?`/treasury/cheques?${e}`:"/treasury/cheques",n=await l.get(s);return n.cheques||Array.isArray(n)?n:[]},updateCheque:async t=>l.put(`/treasury/cheques/${t.id}`,t),getSystemConfig:async()=>l.get("/settings"),updateSystemConfig:async t=>l.put("/settings",t),getStockTakingSessions:async()=>l.get("/inventory/stock-taking"),createStockTakingSession:async t=>l.post("/inventory/stock-taking",t),updateStockTakingSession:async t=>l.put(`/inventory/stock-taking/${t.id}`,t),deleteStockTakingSession:async t=>{await l.delete(`/inventory/stock-taking/${t}`)},getFixedAssets:async()=>l.get("/accounting/fixed-assets"),createFixedAsset:async t=>l.post("/accounting/fixed-assets",t),updateFixedAsset:async t=>l.put(`/accounting/fixed-assets/${t.id}`,t),deleteFixedAsset:async t=>{await l.delete(`/accounting/fixed-assets/${t}`)},syncTransaction:async t=>l.post("/sync/transaction",t),getProductStocks:async()=>(await l.get("/product-stocks")).map(e=>({id:e.id,productId:e.productId||e.product_id,warehouseId:e.warehouseId||e.warehouse_id,stock:parseFloat(e.stock)||0})),getPriceLists:async()=>l.get("/price-lists"),createPriceList:async t=>l.post("/price-lists",t),updatePriceList:async(t,e)=>l.put(`/price-lists/${t}`,e),deletePriceList:async t=>{await l.delete(`/price-lists/${t}`)},togglePriceListStatus:async t=>{const e=localStorage.getItem("authToken"),s={"ngrok-skip-browser-warning":"true"};e&&(s.Authorization=`Bearer ${e}`);const n=await fetch(`${Tt()}/price-lists/${t}/toggle`,{method:"PATCH",headers:s});if(!n.ok)throw new Error(await n.text());return n.json()},getPermissions:async()=>l.get("/permissions"),createPermission:async t=>l.post("/permissions",t),updatePermission:async t=>l.put(`/permissions/${t.id}`,t),deletePermission:async t=>{await l.delete(`/permissions/${t}`)},getAuditLogs:async t=>{try{const e=new URLSearchParams;t?.page&&e.append("page",t.page.toString()),t?.limit&&e.append("limit",t.limit.toString()),t?.user&&e.append("user",t.user),t?.module&&e.append("module",t.module),t?.action&&e.append("action",t.action),t?.startDate&&e.append("startDate",t.startDate),t?.endDate&&e.append("endDate",t.endDate),t?.search&&e.append("search",t.search);const s=t?`/audit?${e}`:"/audit",n=await l.get(s);return n.logs||Array.isArray(n)?n:[]}catch{return[]}},getBOMs:async t=>{const e=t?"?"+new URLSearchParams(t).toString():"";return l.get(`/bom${e}`)},getBOMById:async t=>l.get(`/bom/${t}`),createBOM:async t=>l.post("/bom",t),updateBOM:async(t,e)=>l.put(`/bom/${t}`,e),deleteBOM:async t=>{await l.delete(`/bom/${t}`)},calculateBOMRequirements:async(t,e,s)=>l.post("/bom/calculate-requirements",{bomId:t,quantity:e,warehouseId:s}),getProductionOrders:async t=>{const e=t?"?"+new URLSearchParams(t).toString():"";return l.get(`/production${e}`)},getProductionOrder:async t=>l.get(`/production/${t}`),createProductionOrder:async t=>l.post("/production",t),updateProductionOrder:async(t,e)=>l.put(`/production/${t}`,e),startProduction:async(t,e)=>l.post(`/production/${t}/start`,{materialBatches:e}),finishProduction:async(t,e)=>l.post(`/production/${t}/finish`,e),cancelProduction:async t=>l.post(`/production/${t}/cancel`,{}),deleteProductionOrder:async t=>l.delete(`/production/${t}`),getStockMovements:async t=>{const e=t?"?"+new URLSearchParams(t).toString():"";return l.get(`/stock-movements${e}`)},getProductMovementHistory:async(t,e)=>{const s=e?"?"+new URLSearchParams(e).toString():"";return l.get(`/stock-movements/product/${t}${s}`)},createStockMovement:async t=>{await l.post("/stock-movements",t)},reconcileStock:async()=>l.post("/stock-movements/reconcile",{}),getScrap:async t=>{const e=t?"?"+new URLSearchParams(t).toString():"";return l.get(`/scrap${e}`)},getScrapStats:async t=>{const e=t?"?"+new URLSearchParams(t).toString():"";return l.get(`/scrap/stats${e}`)},createScrap:async t=>l.post("/scrap",t),updateScrapDisposal:async(t,e,s)=>l.patch(`/scrap/${t}/disposal`,{disposalStatus:e,disposalNotes:s}),deleteScrap:async t=>{await l.delete(`/scrap/${t}`)},createBackup:async()=>l.post("/backup/create",{}),listBackups:async()=>l.get("/backup/list"),downloadBackup:async t=>{const e=localStorage.getItem("authToken"),s={"ngrok-skip-browser-warning":"true"};e&&(s.Authorization=`Bearer ${e}`);const n=await fetch(`${Tt()}/backup/${t}/download`,{headers:s});if(!n.ok)throw new Error(await n.text());const a=await n.blob(),r=window.URL.createObjectURL(a),d=document.createElement("a");d.href=r,d.download=t,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(r)},restoreBackup:async t=>l.post(`/backup/${t}/restore`,{}),deleteBackup:async t=>l.delete(`/backup/${t}`),getBackupSettings:async()=>l.get("/backup/settings"),updateBackupSettings:async t=>l.post("/backup/settings",t),browseFolders:async t=>{const e=t?`?path=${encodeURIComponent(t)}`:"";return l.get(`/backup/browse-folders${e}`)},getUserBackupSettings:async()=>l.get("/backup/user-settings"),updateUserBackupSettings:async t=>l.post("/backup/user-settings",t),resetDatabase:async(t,e)=>l.post("/admin/reset-database",{password:t,mode:e}),fiscalYearRollover:async(t,e)=>l.post("/admin/fiscal-year-rollover",{password:t,newYearName:e}),getJournalEntries:async t=>{const e=new URLSearchParams;t?.page&&e.append("page",t.page.toString()),t?.limit&&e.append("limit",t.limit.toString()),t?.startDate&&e.append("startDate",t.startDate),t?.endDate&&e.append("endDate",t.endDate),t?.search&&e.append("search",t.search),t?.accountId&&e.append("accountId",t.accountId);const s=t?`/journals?${e}`:"/journals",n=await l.get(s);return n.journals?{journals:n.journals.map(a=>({...a,lines:a.lines.map(r=>({...r,debit:Number(r.debit),credit:Number(r.credit)}))})),pagination:n.pagination}:{journals:n.map(a=>({...a,lines:a.lines.map(r=>({...r,debit:Number(r.debit),credit:Number(r.credit)}))})),pagination:{total:n.length,page:1,limit:n.length,totalPages:1}}},loadInitialData:async()=>{const t={limit:200,minimal:!0},e=async(S,X,Y)=>{try{return await S}catch(U){const te=U?.message||String(U);return te.includes("403")||te.includes("Forbidden")||te.includes("Insufficient permissions"),X}},s={partners:[],pagination:{total:0,page:1,limit:200,totalPages:0},stats:{netBalance:0,totalLiabilities:0,totalAssets:0}},n={invoices:[],pagination:{total:0,page:1,limit:200,totalPages:0}},a={journals:[],pagination:{total:0,page:1,limit:200,totalPages:0}},r={modules:{sales:!0,purchase:!0,inventory:!0,accounting:!0,treasury:!0,banks:!0,partners:!0,manufacturing:!0,hr:!0}},[d,c,p,y,C,P,N,m]=await Promise.all([e(l.getPartners({limit:200}),s),e(l.getAccounts(),[]),e(l.getInvoices(t),n),e(l.getSystemConfig(),r),e(l.getUsers(),[]),e(l.getPermissions(),[]),e(l.getMasterData("branches"),[]),e(l.getMasterData("warehouses"),[])]),x=(async()=>{const S={cheques:[],pagination:{total:0,page:1,limit:100,totalPages:0}},X={permits:[],pagination:{total:0,page:1,limit:100,totalPages:0}},Y={logs:[],pagination:{total:0,page:1,limit:100,totalPages:0}},[U,te,V,G,ie,ue,h,k,J,se,T,D,oe,ve]=await Promise.all([e(l.getMasterData("categories"),[]),e(l.getMasterData("salesmen"),[]),e(l.getMasterData("taxes"),[]),e(l.getMasterData("cost-centers"),[]),e(l.getMasterData("cash-categories"),[]),e(l.getMasterData("partner-groups"),[]),e(l.getBanks(),[]),e(l.getCheques({limit:100}),S),e(l.getStockTakingSessions(),[]),e(l.getFixedAssets(),[]),e(l.getProductStocks(),[]),e(l.getJournalEntries({limit:200}),a),e(l.getStockPermits({}),X),e(l.getAuditLogs({limit:100}),Y)]),ge=Array.isArray(k)?k:k.cheques||[],Ne=Array.isArray(oe)?oe:oe.permits||[],be=Array.isArray(ve)?ve:ve.logs||[];return{categories:U,salesmen:te,taxes:V,costCenters:G,cashCategories:ie,partnerGroups:ue,banks:h,cheques:ge,stockSessions:J,assets:se,productStocks:T,journal:D,stockPermits:Ne,auditLogs:be}})();return{products:[],partners:d,accounts:c,invoices:p,users:C,permissions:P,config:y,branches:N,warehouses:m,categories:[],salesmen:[],taxes:[],costCenters:[],cashCategories:[],partnerGroups:[],banks:[],cheques:[],stockSessions:[],assets:[],productStocks:[],journal:a,stockPermits:[],auditLogs:[],_backgroundLoad:x}},getStockPermits:async t=>{const e=new URLSearchParams;t?.page&&e.append("page",t.page.toString()),t?.limit&&e.append("limit",t.limit.toString()),t?.type&&e.append("type",t.type),t?.warehouseId&&e.append("warehouseId",t.warehouseId),t?.startDate&&e.append("startDate",t.startDate),t?.endDate&&e.append("endDate",t.endDate),t?.search&&e.append("search",t.search);const s=t?`/stock-permits?${e}`:"/stock-permits",n=await l.get(s);return n.permits||Array.isArray(n)?n:[]},getStockPermitById:async t=>l.get(`/stock-permits/${t}`),createStockPermit:async t=>l.post("/stock-permits",t),deleteStockPermit:async t=>{await l.delete(`/stock-permits/${t}`)},getProductMovements:async(t,e)=>{const s=new URLSearchParams;return e&&s.append("warehouseId",e),l.get(`/stock-movements/product/${t}?${s}`)},getInventoryFlowReport:async(t,e,s,n)=>{const a=new URLSearchParams({startDate:t,endDate:e});return s&&a.append("warehouseId",s),n&&a.append("categoryId",n),l.get(`/inventory/flow-report?${a}`)},getEmployees:async()=>l.get("/hr/employees"),createEmployee:async t=>l.post("/hr/employees",t),updateEmployee:async(t,e)=>l.put(`/hr/employees/${t}`,e),deleteEmployee:async t=>{await l.delete(`/hr/employees/${t}`)},getAttendance:async t=>{const e=new URLSearchParams;return t?.employeeId&&e.append("employeeId",t.employeeId),t?.month&&e.append("month",t.month.toString()),t?.year&&e.append("year",t.year.toString()),t?.startDate&&e.append("startDate",t.startDate),t?.endDate&&e.append("endDate",t.endDate),t?.date&&e.append("date",t.date),l.get(`/hr/attendance?${e}`)},recordAttendance:async t=>l.post("/hr/attendance",t),getPayrollCycles:async()=>l.get("/hr/payroll"),createPayrollCycle:async t=>l.post("/hr/payroll",t),getPayrollEntries:async t=>l.get(`/hr/payroll/${t}/entries`),calculatePayroll:async t=>l.post(`/hr/payroll/${t}/calculate`,{}),approvePayroll:async(t,e)=>l.post(`/hr/payroll/${t}/approve`,e||{}),updatePayrollEntry:async(t,e)=>l.put(`/hr/payroll/entry/${t}`,e),getPayrollTemplates:async()=>l.get("/hr/templates"),createPayrollTemplate:async t=>l.post("/hr/templates",t),updatePayrollTemplate:async(t,e)=>l.put(`/hr/templates/${t}`,e),deletePayrollTemplate:async t=>{await l.delete(`/hr/templates/${t}`)},getEmployeeTemplates:async t=>l.get(`/hr/employees/${t}/templates`),assignTemplateToEmployee:async t=>l.post("/hr/employees/templates",t),removeEmployeeTemplate:async(t,e)=>{await l.delete(`/hr/employees/${t}/templates/${e}`)},getAdvances:async t=>{const e=new URLSearchParams;return t?.employeeId&&e.append("employeeId",t.employeeId),t?.status&&e.append("status",t.status),t?.grouped&&e.append("grouped","true"),l.get(`/hr/advances?${e}`)},createAdvance:async t=>l.post("/hr/advances",t),updateAdvance:async(t,e)=>l.put(`/hr/advances/${t}`,e),deleteAdvance:async t=>{await l.delete(`/hr/advances/${t}`)}},ao=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_PERMISSIONS:sn,api:l},Symbol.toStringTag,{value:"Module"}));var Ft;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Ft||(Ft={}));class os extends Error{constructor(e,s,n){super(e),this.message=e,this.code=s,this.data=n}}const ro=t=>{var e,s;return t?.androidBridge?"android":!((s=(e=t?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||s===void 0)&&s.bridge?"ios":"web"},io=t=>{const e=t.CapacitorCustomPlatform||null,s=t.Capacitor||{},n=s.Plugins=s.Plugins||{},a=()=>e!==null?e.name:ro(t),r=()=>a()!=="web",d=P=>{const N=y.get(P);return!!(N?.platforms.has(a())||c(P))},c=P=>{var N;return(N=s.PluginHeaders)===null||N===void 0?void 0:N.find(m=>m.name===P)},p=P=>t.console.error(P),y=new Map,C=(P,N={})=>{const m=y.get(P);if(m)return m.proxy;const I=a(),x=c(P);let S;const X=async()=>(!S&&I in N?S=typeof N[I]=="function"?S=await N[I]():S=N[I]:e!==null&&!S&&"web"in N&&(S=typeof N.web=="function"?S=await N.web():S=N.web),S),Y=(ue,h)=>{var k,J;if(x){const se=x?.methods.find(T=>h===T.name);if(se)return se.rtype==="promise"?T=>s.nativePromise(P,h.toString(),T):(T,D)=>s.nativeCallback(P,h.toString(),T,D);if(ue)return(k=ue[h])===null||k===void 0?void 0:k.bind(ue)}else{if(ue)return(J=ue[h])===null||J===void 0?void 0:J.bind(ue);throw new os(`"${P}" plugin is not implemented on ${I}`,Ft.Unimplemented)}},U=ue=>{let h;const k=(...J)=>{const se=X().then(T=>{const D=Y(T,ue);if(D){const oe=D(...J);return h=oe?.remove,oe}else throw new os(`"${P}.${ue}()" is not implemented on ${I}`,Ft.Unimplemented)});return ue==="addListener"&&(se.remove=async()=>h()),se};return k.toString=()=>`${ue.toString()}() { [capacitor code] }`,Object.defineProperty(k,"name",{value:ue,writable:!1,configurable:!1}),k},te=U("addListener"),V=U("removeListener"),G=(ue,h)=>{const k=te({eventName:ue},h),J=async()=>{const T=await k;V({eventName:ue,callbackId:T},h)},se=new Promise(T=>k.then(()=>T({remove:J})));return se.remove=async()=>{await J()},se},ie=new Proxy({},{get(ue,h){switch(h){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return x?G:te;case"removeListener":return V;default:return U(h)}}});return n[P]=ie,y.set(P,{name:P,proxy:ie,platforms:new Set([...Object.keys(N),...x?[I]:[]])}),ie};return s.convertFileSrc||(s.convertFileSrc=P=>P),s.getPlatform=a,s.handleError=p,s.isNativePlatform=r,s.isPluginAvailable=d,s.registerPlugin=C,s.Exception=os,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s},lo=t=>t.Capacitor=io(t),Ut=lo(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),$t=Ut.registerPlugin;class ds{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,s){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(s);const r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r),n&&this.sendRetainedArgumentsForEvent(e);const d=async()=>this.removeListener(e,s);return Promise.resolve({remove:d})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,s,n){const a=this.listeners[e];if(!a){if(n){let r=this.retainedEventArguments[e];r||(r=[]),r.push(s),this.retainedEventArguments[e]=r}return}a.forEach(r=>r(s))}hasListeners(e){var s;return!!(!((s=this.listeners[e])===null||s===void 0)&&s.length)}registerWindowListener(e,s){this.windowListeners[s]={registered:!1,windowEventName:e,pluginEventName:s,handler:n=>{this.notifyListeners(s,n)}}}unimplemented(e="not implemented"){return new Ut.Exception(e,Ft.Unimplemented)}unavailable(e="not available"){return new Ut.Exception(e,Ft.Unavailable)}async removeListener(e,s){const n=this.listeners[e];if(!n)return;const a=n.indexOf(s);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const s=this.retainedEventArguments[e];s&&(delete this.retainedEventArguments[e],s.forEach(n=>{this.notifyListeners(e,n)}))}}const Hs=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),_s=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class uo extends ds{async getCookies(){const e=document.cookie,s={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[a,r]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=_s(a).trim(),r=_s(r).trim(),s[a]=r}),s}async setCookie(e){try{const s=Hs(e.key),n=Hs(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),d=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${s}=${n||""}${a}; path=${r}; ${d};`}catch(s){return Promise.reject(s)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(s){return Promise.reject(s)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const s of e)document.cookie=s.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}$t("CapacitorCookies",{web:()=>new uo});const co=async t=>new Promise((e,s)=>{const n=new FileReader;n.onload=()=>{const a=n.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},n.onerror=a=>s(a),n.readAsDataURL(t)}),mo=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(a=>a.toLocaleLowerCase()).reduce((a,r,d)=>(a[r]=t[e[d]],a),{})},Eo=(t,e=!0)=>t?Object.entries(t).reduce((n,a)=>{const[r,d]=a;let c,p;return Array.isArray(d)?(p="",d.forEach(y=>{c=e?encodeURIComponent(y):y,p+=`${r}=${c}&`}),p.slice(0,-1)):(c=e?encodeURIComponent(d):d,p=`${r}=${c}`),`${n}&${p}`},"").substr(1):null,nn=(t,e={})=>{const s=Object.assign({method:t.method||"GET",headers:t.headers},e),a=mo(t.headers)["content-type"]||"";if(typeof t.data=="string")s.body=t.data;else if(a.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams;for(const[d,c]of Object.entries(t.data||{}))r.set(d,c);s.body=r.toString()}else if(a.includes("multipart/form-data")||t.data instanceof FormData){const r=new FormData;if(t.data instanceof FormData)t.data.forEach((c,p)=>{r.append(p,c)});else for(const c of Object.keys(t.data))r.append(c,t.data[c]);s.body=r;const d=new Headers(s.headers);d.delete("content-type"),s.headers=d}else(a.includes("application/json")||typeof t.data=="object")&&(s.body=JSON.stringify(t.data));return s};class fo extends ds{async request(e){const s=nn(e,e.webFetchExtra),n=Eo(e.params,e.shouldEncodeUrlParams),a=n?`${e.url}?${n}`:e.url,r=await fetch(a,s),d=r.headers.get("content-type")||"";let{responseType:c="text"}=r.ok?e:{};d.includes("application/json")&&(c="json");let p,y;switch(c){case"arraybuffer":case"blob":y=await r.blob(),p=await co(y);break;case"json":p=await r.json();break;case"document":case"text":default:p=await r.text()}const C={};return r.headers.forEach((P,N)=>{C[N]=P}),{data:p,headers:C,status:r.status,url:r.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}$t("CapacitorHttp",{web:()=>new fo});var xs;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(xs||(xs={}));var ws;(function(t){t.StatusBar="StatusBar",t.NavigationBar="NavigationBar"})(ws||(ws={}));class po extends ds{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}$t("SystemBars",{web:()=>new po});const ho=Object.freeze(Object.defineProperty({__proto__:null,Capacitor:Ut,CapacitorException:os,get ExceptionCode(){return Ft},get SystemBarType(){return ws},get SystemBarsStyle(){return xs},WebPlugin:ds,buildRequestInit:nn,registerPlugin:$t},Symbol.toStringTag,{value:"Module"})),bo=({onLogin:t})=>{const[e,s]=b.useState("admin"),[n,a]=b.useState("admin"),[r,d]=b.useState(!1),[c,p]=b.useState(""),[y,C]=b.useState(!1),[P,N]=b.useState([]),m=Ut.isNativePlatform(),[I,x]=b.useState(!1),[S,X]=b.useState("http://"),[Y,U]=b.useState(!1),[te,V]=b.useState(null),[G,ie]=b.useState(!1),[ue,h]=b.useState("");b.useEffect(()=>{if(m){const D=localStorage.getItem("erp_server_url");D?X(D):x(!0)}const se=localStorage.getItem("savedCredentials");if(se)try{const{identity:D,password:oe}=JSON.parse(se);s(D),a(oe),d(!0)}catch{}(async()=>{if(!(m&&!localStorage.getItem("erp_server_url")))try{const D=await l.getUsers();N(D)}catch{}})()},[m]);const k=async()=>{U(!0),V(null);try{const se=await fetch(`${S}/api/health`,{method:"GET",headers:{"Content-Type":"application/json"}});se.ok?(localStorage.setItem("erp_server_url",S),V({success:!0,message:"تم الاتصال بنجاح! يمكنك تسجيل الدخول الآن"}),setTimeout(()=>x(!1),1500)):V({success:!1,message:`خطأ من الخادم: ${se.status}`})}catch(se){V({success:!1,message:`فشل الاتصال: ${se.message}`})}U(!1)},J=async se=>{se.preventDefault(),C(!0),p("");try{const T=await l.login({username:e,password:n});if(localStorage.setItem("authToken",T.token),Jn(T.user,r),r?localStorage.setItem("savedCredentials",JSON.stringify({identity:e,password:n})):localStorage.removeItem("savedCredentials"),m){C(!1),ie(!0),h("جاري تهيئة قاعدة البيانات...");try{const{unifiedStorage:D}=await he(async()=>{const{unifiedStorage:ge}=await Promise.resolve().then(()=>mn);return{unifiedStorage:ge}},void 0);await D.initialize(),await D.setAuthToken(T.token);const oe=await D.downloadAllData(ge=>{h(ge)}),ve=oe.stats;alert(`نتائج التحميل:
المنتجات: ${ve.products}
العملاء: ${ve.partners}
الفواتير: ${ve.invoices}
الحسابات: ${ve.accounts}
النجاح: ${oe.success?"نعم":"لا"}
الرسالة: ${oe.message}`),oe.success&&ve.products>0?(h("تم تحميل البيانات بنجاح!"),setTimeout(()=>{ie(!1),t()},500)):(ie(!1),t())}catch(D){alert("خطأ في التحميل: "+D.message),ie(!1),t()}}else t()}catch{p("اسم المستخدم أو كلمة المرور غير صحيحة"),C(!1)}};return I?o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-teal-600 via-emerald-600 to-cyan-700 p-6",dir:"rtl",children:o.jsxDEV("div",{className:"w-full max-w-md",children:[o.jsxDEV("div",{className:"text-center mb-8",children:[o.jsxDEV("div",{className:"w-20 h-20 bg-white/20 backdrop-blur-xl rounded-3xl flex items-center justify-center mx-auto mb-4",children:o.jsxDEV(On,{className:"text-white",size:40},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:177,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:176,columnNumber:25},void 0),o.jsxDEV("h1",{className:"text-3xl font-black text-white mb-2",children:"إعداد التطبيق"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:179,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-white/80 text-sm",children:"قم بإدخال عنوان الخادم للاتصال"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:180,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:175,columnNumber:21},void 0),o.jsxDEV("div",{className:"bg-white rounded-3xl shadow-2xl p-6 space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"عنوان الخادم (IP)"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:185,columnNumber:29},void 0),o.jsxDEV("input",{type:"url",value:S,onChange:se=>X(se.target.value),className:"w-full border-2 border-slate-200 rounded-xl p-4 text-left font-mono text-sm focus:border-teal-500 outline-none",placeholder:"http://100.x.x.x:3000",dir:"ltr"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:186,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:184,columnNumber:25},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 gap-2",children:[o.jsxDEV("button",{onClick:()=>X("http://10.0.2.2:3001"),className:`text-right p-3 rounded-xl border-2 ${S==="http://10.0.2.2:3001"?"border-teal-500 bg-teal-50":"border-slate-200"}`,children:[o.jsxDEV("span",{className:"font-bold text-slate-700 text-sm",children:"Emulator (محاكي)"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:202,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-xs text-slate-400 block font-mono",dir:"ltr",children:"http://10.0.2.2:3001"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:203,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:198,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>X("http://100.85.45.110:3001"),className:`text-right p-3 rounded-xl border-2 ${S==="http://100.85.45.110:3001"?"border-teal-500 bg-teal-50":"border-slate-200"}`,children:[o.jsxDEV("span",{className:"font-bold text-slate-700 text-sm",children:"Tailscale"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:209,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-xs text-slate-400 block font-mono",dir:"ltr",children:"http://100.85.45.110:3001"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:210,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:205,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>X("http://192.168.0.103:3001"),className:`text-right p-3 rounded-xl border-2 ${S==="http://192.168.0.103:3001"?"border-teal-500 bg-teal-50":"border-slate-200"}`,children:[o.jsxDEV("span",{className:"font-bold text-slate-700 text-sm",children:"Local Network"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:216,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-xs text-slate-400 block font-mono",dir:"ltr",children:"http://192.168.0.103:3001"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:217,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:212,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:197,columnNumber:25},void 0),te&&o.jsxDEV("div",{className:`p-3 rounded-xl text-sm font-bold flex items-center gap-2 ${te.success?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:[te.success?o.jsxDEV(ts,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:224,columnNumber:61},void 0):o.jsxDEV(Vs,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:224,columnNumber:89},void 0),te.message]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:222,columnNumber:29},void 0),o.jsxDEV("button",{onClick:k,disabled:Y||!S.startsWith("http"),className:"w-full py-4 bg-gradient-to-r from-teal-600 to-emerald-600 text-white rounded-xl font-bold disabled:opacity-50 flex items-center justify-center gap-2",children:Y?o.jsxDEV(o.Fragment,{children:[o.jsxDEV(ns,{className:"animate-spin",size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:236,columnNumber:37},void 0),"جاري الاختبار..."]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:235,columnNumber:33},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV(Vs,{size:18},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:241,columnNumber:37},void 0),"اختبار الاتصال"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:240,columnNumber:33},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:229,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:183,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:174,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:173,columnNumber:13},void 0):G?o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-teal-600 via-emerald-600 to-cyan-700 p-6",dir:"rtl",children:o.jsxDEV("div",{className:"w-full max-w-md text-center",children:[o.jsxDEV("div",{className:"w-24 h-24 bg-white/20 backdrop-blur-xl rounded-3xl flex items-center justify-center mx-auto mb-6",children:o.jsxDEV(Ws,{className:"text-white animate-bounce",size:48},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:258,columnNumber:25},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:257,columnNumber:21},void 0),o.jsxDEV("h1",{className:"text-3xl font-black text-white mb-2",children:"جاري تحميل البيانات"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:260,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-white/80 text-sm mb-8",children:"هذه العملية تتم مرة واحدة فقط..."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:261,columnNumber:21},void 0),o.jsxDEV("div",{className:"bg-white/10 backdrop-blur-sm rounded-2xl p-6 space-y-4",children:[o.jsxDEV("div",{className:"flex items-center gap-3 text-white",children:[o.jsxDEV(ns,{className:"animate-spin",size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:265,columnNumber:29},void 0),o.jsxDEV("span",{className:"font-bold",children:ue},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:266,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:264,columnNumber:25},void 0),o.jsxDEV("div",{className:"w-full h-2 bg-white/20 rounded-full overflow-hidden",children:o.jsxDEV("div",{className:"h-full bg-white rounded-full animate-pulse",style:{width:"60%"}},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:270,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:269,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex justify-center gap-6 pt-2",children:[o.jsxDEV("div",{className:"text-center",children:[o.jsxDEV(zt,{className:"text-white/60 mx-auto mb-1",size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:275,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-white/80 text-xs",children:"المنتجات"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:276,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:274,columnNumber:29},void 0),o.jsxDEV("div",{className:"text-center",children:[o.jsxDEV(Ht,{className:"text-white/60 mx-auto mb-1",size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:279,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-white/80 text-xs",children:"العملاء"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:280,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:278,columnNumber:29},void 0),o.jsxDEV("div",{className:"text-center",children:[o.jsxDEV(Wt,{className:"text-white/60 mx-auto mb-1",size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:283,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-white/80 text-xs",children:"الفواتير"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:284,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:282,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:273,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:263,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-white/50 text-xs mt-6",children:"سيتم حفظ البيانات للعمل بدون إنترنت"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:289,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:256,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:255,columnNumber:13},void 0):o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 relative overflow-hidden font-sans px-4 sm:px-6",dir:"rtl",children:[o.jsxDEV("div",{className:"absolute inset-0 overflow-hidden hidden sm:block",children:[o.jsxDEV("div",{className:"absolute top-[-20%] right-[-10%] w-[800px] h-[800px] bg-teal-600/20 rounded-full blur-[120px] animate-pulse-slow"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:301,columnNumber:17},void 0),o.jsxDEV("div",{className:"absolute bottom-[-20%] left-[-10%] w-[800px] h-[800px] bg-indigo-600/20 rounded-full blur-[120px] animate-pulse-slow delay-1000"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:302,columnNumber:17},void 0),o.jsxDEV("div",{className:"absolute top-[40%] left-[30%] w-[400px] h-[400px] bg-purple-600/10 rounded-full blur-[100px] animate-float"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:303,columnNumber:17},void 0),o.jsxDEV("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:306,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:300,columnNumber:13},void 0),o.jsxDEV("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-950 to-slate-900 sm:hidden",children:o.jsxDEV("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:311,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:310,columnNumber:13},void 0),m&&o.jsxDEV("button",{onClick:()=>x(!0),className:"absolute top-4 left-4 z-20 p-3 bg-white/10 backdrop-blur rounded-xl text-white hover:bg-white/20 transition-all",children:o.jsxDEV(Cs,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:320,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:316,columnNumber:17},void 0),o.jsxDEV("div",{className:"w-full max-w-md relative z-10",children:o.jsxDEV("div",{className:"bg-slate-900/50 sm:bg-white/5 backdrop-blur-3xl border border-white/10 rounded-[32px] shadow-2xl overflow-hidden relative group",children:[o.jsxDEV("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent pointer-events-none"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:328,columnNumber:21},void 0),o.jsxDEV("div",{className:"p-6 sm:p-8 pt-10 relative",children:[o.jsxDEV("div",{className:"text-center mb-8",children:[o.jsxDEV("div",{className:"relative inline-block mb-6 group-hover:scale-105 transition-transform duration-500",children:[o.jsxDEV("div",{className:"absolute inset-0 bg-gradient-to-tr from-teal-500 to-cyan-500 rounded-2xl blur-lg opacity-60 group-hover:opacity-80 transition-opacity"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:334,columnNumber:33},void 0),o.jsxDEV("div",{className:"w-24 h-16 sm:w-32 sm:h-20 bg-gradient-to-tr from-slate-900 to-slate-800 rounded-2xl flex items-center justify-center relative border border-cyan-500/30 shadow-inner overflow-hidden p-3",children:o.jsxDEV("img",{src:"/logo.png",alt:"DaftriX Logo",className:"h-full w-auto object-contain"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:336,columnNumber:37},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:335,columnNumber:33},void 0),o.jsxDEV("div",{className:"absolute -top-2 -right-2",children:o.jsxDEV(Hn,{size:20,className:"text-amber-400 animate-bounce"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:339,columnNumber:37},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:338,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:333,columnNumber:29},void 0),o.jsxDEV("h1",{className:"text-3xl sm:text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-teal-200 to-cyan-200 mb-2 tracking-tight",children:"DAFTRIX"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:342,columnNumber:29},void 0),o.jsxDEV("p",{className:"text-slate-400 text-sm font-medium",children:"نظام إدارة موارد المؤسسات الذكي"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:343,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:332,columnNumber:25},void 0),o.jsxDEV("form",{onSubmit:J,className:"space-y-6",children:[c&&o.jsxDEV("div",{className:"p-4 rounded-2xl bg-rose-500/10 border border-rose-500/20 text-rose-300 text-sm text-center font-bold animate-fade-in backdrop-blur-sm",children:c},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:348,columnNumber:33},void 0),o.jsxDEV("div",{className:"space-y-5",children:[o.jsxDEV("div",{className:"group",children:o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("div",{className:"absolute right-4 top-4 text-slate-500 group-focus-within:text-teal-400 transition-colors",children:o.jsxDEV(ys,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:357,columnNumber:45},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:356,columnNumber:41},void 0),o.jsxDEV("input",{id:"username",name:"username","aria-label":"اسم المستخدم",type:"text",value:e,onChange:se=>s(se.target.value),className:"w-full bg-slate-900/50 border border-slate-700/50 rounded-2xl py-4 pr-12 pl-4 text-white font-bold placeholder:text-slate-600 focus:bg-slate-900/80 focus:border-teal-500/50 focus:ring-4 focus:ring-teal-500/10 outline-none transition-all",placeholder:"اسم المستخدم"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:359,columnNumber:41},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:355,columnNumber:37},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:354,columnNumber:33},void 0),o.jsxDEV("div",{className:"group",children:o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("div",{className:"absolute right-4 top-4 text-slate-500 group-focus-within:text-teal-400 transition-colors",children:o.jsxDEV(Ps,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:375,columnNumber:45},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:374,columnNumber:41},void 0),o.jsxDEV("input",{id:"password",name:"password","aria-label":"كلمة المرور",type:"password",value:n,onChange:se=>a(se.target.value),className:"w-full bg-slate-900/50 border border-slate-700/50 rounded-2xl py-4 pr-12 pl-4 text-white font-bold placeholder:text-slate-600 focus:bg-slate-900/80 focus:border-teal-500/50 focus:ring-4 focus:ring-teal-500/10 outline-none transition-all",placeholder:"كلمة المرور"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:377,columnNumber:41},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:373,columnNumber:37},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:372,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:353,columnNumber:29},void 0),o.jsxDEV("div",{className:"flex items-center justify-between text-xs px-1",children:[o.jsxDEV("label",{className:"flex items-center gap-2 cursor-pointer text-slate-400 hover:text-slate-300 transition-colors",children:[o.jsxDEV("input",{id:"remember-me",name:"remember-me",type:"checkbox",checked:r,onChange:se=>d(se.target.checked),className:"rounded bg-slate-800 border-slate-600 text-teal-500 focus:ring-teal-500/50"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:393,columnNumber:37},void 0),"تذكرني"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:392,columnNumber:33},void 0),o.jsxDEV("a",{href:"#",className:"text-teal-400 hover:text-teal-300 font-bold transition-colors",children:"نسيت كلمة المرور؟"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:403,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:391,columnNumber:29},void 0),o.jsxDEV("button",{type:"submit",disabled:y,className:"w-full bg-gradient-to-r from-teal-600 to-indigo-600 text-white py-4 rounded-2xl font-bold text-lg shadow-lg shadow-teal-900/20 hover:shadow-teal-500/20 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-3 disabled:opacity-70 disabled:cursor-not-allowed border border-white/10",children:y?o.jsxDEV(o.Fragment,{children:[o.jsxDEV(ns,{size:24,className:"animate-spin"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:413,columnNumber:41},void 0)," جاري الدخول..."]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:412,columnNumber:37},void 0):o.jsxDEV(o.Fragment,{children:["تسجيل الدخول ",o.jsxDEV(_n,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:417,columnNumber:54},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:416,columnNumber:37},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:406,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:346,columnNumber:25},void 0),o.jsxDEV("div",{className:"mt-8 text-center",children:o.jsxDEV("p",{className:"text-[10px] text-slate-600 font-medium tracking-wider uppercase",children:["DAFTRIX ERP v2.5.0 © ",new Date().getFullYear()]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:424,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:423,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:330,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:326,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:324,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/LoginScreen.tsx",lineNumber:298,columnNumber:9},void 0)},Xe=({className:t})=>o.jsxDEV("div",{className:`animate-pulse bg-slate-200/80 rounded-md ${t}`},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ui/Skeleton.tsx",lineNumber:9,columnNumber:9},void 0),No=()=>o.jsxDEV("div",{className:"space-y-6 pb-10 animate-fade-in",children:[o.jsxDEV("div",{className:"bg-white/50 border border-white/60 rounded-2xl p-6 flex flex-col md:flex-row justify-between items-center gap-4 relative overflow-hidden",children:[o.jsxDEV("div",{className:"space-y-3 w-full md:w-1/2 relative z-10",children:[o.jsxDEV(Xe,{className:"h-4 w-32"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:10,columnNumber:21},void 0),o.jsxDEV(Xe,{className:"h-8 w-64"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:11,columnNumber:21},void 0),o.jsxDEV(Xe,{className:"h-4 w-96"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:12,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:9,columnNumber:17},void 0),o.jsxDEV(Xe,{className:"h-12 w-12 rounded-full relative z-10"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:14,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:8,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(t=>o.jsxDEV("div",{className:"bg-white p-4 rounded-xl border border-slate-100 shadow-sm flex items-center gap-4",children:[o.jsxDEV(Xe,{className:"h-12 w-12 rounded-lg"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:21,columnNumber:25},void 0),o.jsxDEV("div",{className:"space-y-2 flex-1",children:[o.jsxDEV(Xe,{className:"h-3 w-24"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:23,columnNumber:29},void 0),o.jsxDEV(Xe,{className:"h-6 w-32"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:24,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:22,columnNumber:25},void 0)]},t,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:20,columnNumber:21},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:18,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:[1,2,3,4,5].map(t=>o.jsxDEV("div",{className:"bg-white/50 p-4 rounded-2xl border border-slate-100 h-32 flex flex-col justify-between",children:[o.jsxDEV("div",{className:"flex items-center gap-3",children:[o.jsxDEV(Xe,{className:"h-10 w-10 rounded-xl"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:35,columnNumber:29},void 0),o.jsxDEV(Xe,{className:"h-5 w-24"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:36,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:34,columnNumber:25},void 0),o.jsxDEV("div",{className:"space-y-2",children:o.jsxDEV(Xe,{className:"h-8 w-full rounded-lg"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:39,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:38,columnNumber:25},void 0)]},t,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:33,columnNumber:21},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:31,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxDEV("div",{className:"bg-white/50 p-5 rounded-2xl border border-slate-100 h-80 flex flex-col",children:[o.jsxDEV("div",{className:"flex justify-between mb-6",children:[o.jsxDEV(Xe,{className:"h-6 w-40"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:50,columnNumber:25},void 0),o.jsxDEV(Xe,{className:"h-6 w-24 rounded-full"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:51,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:49,columnNumber:21},void 0),o.jsxDEV("div",{className:"grid grid-cols-3 gap-4 flex-1",children:[1,2,3,4,5,6].map(t=>o.jsxDEV(Xe,{className:"h-full w-full rounded-xl"},t,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:55,columnNumber:29},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:53,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:48,columnNumber:17},void 0),o.jsxDEV("div",{className:"bg-white/50 p-5 rounded-2xl border border-slate-100 h-80 flex flex-col",children:[o.jsxDEV("div",{className:"flex justify-between mb-6",children:[o.jsxDEV(Xe,{className:"h-6 w-40"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:63,columnNumber:25},void 0),o.jsxDEV(Xe,{className:"h-4 w-16"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:64,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:62,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-3 flex-1",children:[1,2,3,4,5].map(t=>o.jsxDEV("div",{className:"flex gap-4",children:[o.jsxDEV(Xe,{className:"h-10 w-20 rounded-lg"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:69,columnNumber:33},void 0),o.jsxDEV(Xe,{className:"h-10 flex-1 rounded-lg"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:70,columnNumber:33},void 0),o.jsxDEV(Xe,{className:"h-10 w-24 rounded-lg"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:71,columnNumber:33},void 0)]},t,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:68,columnNumber:29},void 0))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:66,columnNumber:21},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:61,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:46,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/dashboard/DashboardSkeleton.tsx",lineNumber:6,columnNumber:9},void 0);class on extends b.Component{constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.handleReload=()=>{window.location.reload()},this.handleGoHome=()=>{window.location.href="/"},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,s){this.setState({error:e,errorInfo:s})}render(){return this.state.hasError?o.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:o.jsxDEV("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-2xl overflow-hidden",children:[o.jsxDEV("div",{className:"bg-gradient-to-r from-rose-500 to-rose-600 p-8 text-white",children:o.jsxDEV("div",{className:"flex items-center gap-4 mb-4",children:[o.jsxDEV("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center",children:o.jsxDEV(_t,{size:32,className:"text-white"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:65,columnNumber:37},this)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:64,columnNumber:33},this),o.jsxDEV("div",{children:[o.jsxDEV("h1",{className:"text-3xl font-bold",children:"عذراً، حدث خطأ!"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:68,columnNumber:37},this),o.jsxDEV("p",{className:"text-rose-100 mt-1",children:"Something went wrong"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:69,columnNumber:37},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:67,columnNumber:33},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:63,columnNumber:29},this)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:62,columnNumber:25},this),o.jsxDEV("div",{className:"p-8",children:[o.jsxDEV("div",{className:"mb-6",children:[o.jsxDEV("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"لقد واجه التطبيق مشكلة غير متوقعة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:77,columnNumber:33},this),o.jsxDEV("p",{className:"text-slate-600",children:"نعتذر عن الإزعاج. يمكنك المحاولة مرة أخرى أو العودة للصفحة الرئيسية."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:80,columnNumber:33},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:76,columnNumber:29},this),this.state.error&&o.jsxDEV("div",{className:"mb-6",children:o.jsxDEV("details",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[o.jsxDEV("summary",{className:"cursor-pointer font-bold text-slate-700 hover:text-slate-900 flex items-center gap-2",children:[o.jsxDEV("span",{children:"تفاصيل الخطأ (للمطورين)"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:90,columnNumber:45},this),o.jsxDEV("span",{className:"text-xs text-slate-500",children:"انقر للعرض"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:91,columnNumber:45},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:89,columnNumber:41},this),o.jsxDEV("div",{className:"mt-4 space-y-3",children:[o.jsxDEV("div",{children:[o.jsxDEV("div",{className:"text-xs font-bold text-slate-500 mb-1",children:"Error Message:"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:95,columnNumber:49},this),o.jsxDEV("div",{className:"bg-rose-50 border border-rose-200 rounded p-3 text-sm text-rose-800 font-mono",children:this.state.error.toString()},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:96,columnNumber:49},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:94,columnNumber:45},this),this.state.errorInfo&&o.jsxDEV("div",{children:[o.jsxDEV("div",{className:"text-xs font-bold text-slate-500 mb-1",children:"Component Stack:"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:102,columnNumber:53},this),o.jsxDEV("div",{className:"bg-slate-100 border border-slate-200 rounded p-3 text-xs text-slate-700 font-mono overflow-auto max-h-48",children:o.jsxDEV("pre",{children:this.state.errorInfo.componentStack},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:104,columnNumber:57},this)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:103,columnNumber:53},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:101,columnNumber:49},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:93,columnNumber:41},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:88,columnNumber:37},this)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:87,columnNumber:33},this),o.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-3",children:[o.jsxDEV("button",{onClick:this.handleReset,className:"flex-1 bg-gradient-to-r from-indigo-600 to-indigo-700 text-white px-6 py-3 rounded-xl font-bold hover:from-indigo-700 hover:to-indigo-800 transition-all shadow-lg shadow-indigo-200 flex items-center justify-center gap-2",children:[o.jsxDEV(rs,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:119,columnNumber:37},this),"المحاولة مرة أخرى"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:115,columnNumber:33},this),o.jsxDEV("button",{onClick:this.handleReload,className:"flex-1 bg-white border-2 border-slate-300 text-slate-700 px-6 py-3 rounded-xl font-bold hover:bg-slate-50 hover:border-slate-400 transition-all flex items-center justify-center gap-2",children:[o.jsxDEV(rs,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:126,columnNumber:37},this),"إعادة تحميل الصفحة"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:122,columnNumber:33},this),o.jsxDEV("button",{onClick:this.handleGoHome,className:"flex-1 bg-white border-2 border-slate-300 text-slate-700 px-6 py-3 rounded-xl font-bold hover:bg-slate-50 hover:border-slate-400 transition-all flex items-center justify-center gap-2",children:[o.jsxDEV(Rs,{size:20},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:133,columnNumber:37},this),"الصفحة الرئيسية"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:129,columnNumber:33},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:114,columnNumber:29},this),o.jsxDEV("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:o.jsxDEV("p",{className:"text-sm text-blue-800",children:[o.jsxDEV("strong",{children:"نصيحة:"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:141,columnNumber:37},this)," إذا استمرت المشكلة، حاول مسح ذاكرة التخزين المؤقت للمتصفح أو تسجيل الخروج ثم تسجيل الدخول مرة أخرى."]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:140,columnNumber:33},this)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:139,columnNumber:29},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:75,columnNumber:25},this),o.jsxDEV("div",{className:"bg-slate-50 border-t border-slate-200 p-4 text-center",children:o.jsxDEV("p",{className:"text-xs text-slate-500",children:["Cloud ERP System • ",new Date().getFullYear()]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:148,columnNumber:29},this)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:147,columnNumber:25},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:60,columnNumber:21},this)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/ErrorBoundary.tsx",lineNumber:59,columnNumber:17},this):this.props.children}}const Ro=({onLogout:t})=>{const[e,s]=b.useState(!1),[n,a]=b.useState(0);b.useEffect(()=>{const p=()=>{const C=Zs();if(a(C),C===0){gs(),t();return}Zn()?s(!0):s(!1)};p();const y=setInterval(p,1e4);return()=>clearInterval(y)},[t]);const r=()=>{eo(),s(!1)},d=()=>{gs(),t()},c=p=>{const y=Math.floor(p/6e4),C=Math.floor(p%6e4/1e3);return`${y}:${C.toString().padStart(2,"0")}`};return e?o.jsxDEV(o.Fragment,{children:[o.jsxDEV("style",{children:`
                @keyframes slide-up {
                    from {
                        transform: translateY(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateY(0);
                        opacity: 1;
                    }
                }
                .animate-slide-up {
                    animation: slide-up 0.3s ease-out;
                }
            `},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:61,columnNumber:13},void 0),o.jsxDEV("div",{className:"fixed bottom-4 right-4 z-50 animate-slide-up",children:o.jsxDEV("div",{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-xl shadow-2xl p-6 max-w-md border-2 border-amber-400",children:o.jsxDEV("div",{className:"flex items-start gap-4",children:[o.jsxDEV("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center flex-shrink-0 animate-pulse",children:o.jsxDEV(Un,{size:24},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:80,columnNumber:29},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:79,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("h3",{className:"font-bold text-lg mb-1",children:"⚠️ تنبيه: الجلسة على وشك الانتهاء"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:83,columnNumber:29},void 0),o.jsxDEV("p",{className:"text-sm text-amber-50 mb-3",children:["سيتم تسجيل خروجك تلقائياً خلال"," ",o.jsxDEV("span",{className:"font-mono font-bold text-white bg-white/20 px-2 py-0.5 rounded",children:c(n)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:86,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:84,columnNumber:29},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:r,className:"flex-1 bg-white text-amber-600 px-4 py-2.5 rounded-lg font-bold hover:bg-amber-50 transition-all transform hover:scale-105 shadow-lg flex items-center justify-center gap-2",children:[o.jsxDEV(rs,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:95,columnNumber:37},void 0),"تمديد الجلسة"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:91,columnNumber:33},void 0),o.jsxDEV("button",{onClick:d,className:"px-4 py-2.5 bg-white/20 hover:bg-white/30 rounded-lg font-bold transition-all flex items-center gap-2 border border-white/30",children:[o.jsxDEV(Ks,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:102,columnNumber:37},void 0),"تسجيل خروج"]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:98,columnNumber:33},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:90,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:82,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:78,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:77,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:76,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/SessionTimeout.tsx",lineNumber:60,columnNumber:9},void 0):null},Co="Africa/Cairo",an=t=>{const s=(t?new Date(t):new Date).toLocaleString("en-US",{timeZone:Co});return new Date(s)},Po=t=>{if(!t)return"";const e=an(t),s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${s}-${n}-${a}`},ga=()=>Po(new Date),rn=()=>{const e=an(new Date),s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),d=String(e.getMinutes()).padStart(2,"0"),c=String(e.getSeconds()).padStart(2,"0");return`${s}-${n}-${a} ${r}:${d}:${c}`},yo=t=>{if(t==null)return"0";const e=Number(t);return isNaN(e)?"0":Number.isInteger(e)?e.toString():parseFloat(e.toFixed(5)).toString()};var B=(t=>(t.INVOICE_SALE="INVOICE_SALE",t.INVOICE_PURCHASE="INVOICE_PURCHASE",t.RETURN_SALE="RETURN_SALE",t.RETURN_PURCHASE="RETURN_PURCHASE",t.QUOTATION="QUOTATION",t.RECEIPT="RECEIPT",t.PAYMENT="PAYMENT",t.JOURNAL="JOURNAL",t.STOCK_PERMIT_IN="STOCK_PERMIT_IN",t.STOCK_PERMIT_OUT="STOCK_PERMIT_OUT",t.STOCK_TRANSFER="STOCK_TRANSFER",t.DISCOUNT_ALLOWED="DISCOUNT_ALLOWED",t.DISCOUNT_EARNED="DISCOUNT_EARNED",t.CHEQUE_RECEIVED="CHEQUE_RECEIVED",t.CHEQUE_ISSUED="CHEQUE_ISSUED",t.CHEQUE_DEPOSIT="CHEQUE_DEPOSIT",t.CHEQUE_COLLECT="CHEQUE_COLLECT",t.CHEQUE_BOUNCE="CHEQUE_BOUNCE",t.CHEQUE_CASHED="CHEQUE_CASHED",t.ASSET_DEPRECIATION="ASSET_DEPRECIATION",t))(B||{}),St=(t=>(t.DRAFT="DRAFT",t.POSTED="POSTED",t.VOID="VOID",t.PAID="PAID",t.PARTIAL="PARTIAL",t))(St||{}),ze=(t=>(t.CASH="CASH",t.BANK="BANK",t.CREDIT="CREDIT",t.CHEQUE="CHEQUE",t.MIXED="MIXED",t))(ze||{}),ut=(t=>(t.PENDING="PENDING",t.UNDER_COLLECTION="UNDER_COLLECTION",t.COLLECTED="COLLECTED",t.BOUNCED="BOUNCED",t.CASHED="CASHED",t.ENDORSED="ENDORSED",t))(ut||{}),vo=(t=>(t.PURCHASE="PURCHASE",t.SALE="SALE",t.RETURN_IN="RETURN_IN",t.RETURN_OUT="RETURN_OUT",t.PRODUCTION_USE="PRODUCTION_USE",t.PRODUCTION_OUTPUT="PRODUCTION_OUTPUT",t.ADJUSTMENT="ADJUSTMENT",t.TRANSFER_IN="TRANSFER_IN",t.TRANSFER_OUT="TRANSFER_OUT",t.OPENING_BALANCE="OPENING_BALANCE",t.SCRAP="SCRAP",t))(vo||{}),go=(t=>(t.PLANNED="PLANNED",t.CONFIRMED="CONFIRMED",t.WAITING_MATERIALS="WAITING_MATERIALS",t.IN_PROGRESS="IN_PROGRESS",t.COMPLETED="COMPLETED",t.CANCELLED="CANCELLED",t))(go||{}),xo=(t=>(t.MONTHLY="MONTHLY",t.DAILY="DAILY",t))(xo||{}),wo=(t=>(t.ACTIVE="ACTIVE",t.INACTIVE="INACTIVE",t.TERMINATED="TERMINATED",t))(wo||{}),To=(t=>(t.PRESENT="PRESENT",t.ABSENT="ABSENT",t.LATE="LATE",t.LEAVE="LEAVE",t))(To||{}),Lo=(t=>(t.DRAFT="DRAFT",t.REVIEW="REVIEW",t.APPROVED="APPROVED",t.PAID="PAID",t))(Lo||{});const So=(t,e="")=>{const s=t.map(r=>{if(!r.startsWith(e))return 0;const d=r.slice(e.length);return/^\d+$/.test(d)?parseInt(d,10):0}).filter(r=>!isNaN(r)&&r>0),a=(s.length>0?Math.max(...s):0)+1;return`${e}${a}`},ln=t=>{const e=Math.floor(1e5+Math.random()*9e5);return`${{[B.INVOICE_SALE]:"INV",[B.INVOICE_PURCHASE]:"PUR",[B.RETURN_SALE]:"RET-S",[B.RETURN_PURCHASE]:"RET-P",[B.RECEIPT]:"REC",[B.PAYMENT]:"PAY",[B.QUOTATION]:"QUO"}[t]||t.substring(0,3)}-${e}`},xa=async(t,e="Document",s)=>{let n="";if(s)n=s;else{const r=document.getElementById(t);if(!r)return;n=r.innerHTML}const a=`
    <!DOCTYPE html>
    <html dir="rtl" lang="ar">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>${e}</title>
      <script src="https://cdn.tailwindcss.com"><\/script>
      <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
      <style>
        body { background: #fff; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; }
        @media print {
           @page { size: A4; margin: 0; }
           body { margin: 0; padding: 0; }
           .no-print { display: none !important; }
           .paper { width: 100% !important; max-width: 100% !important; margin: 0 !important; box-shadow: none !important; border: none !important; }
           * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
      </style>
    </head>
    <body>
      <div class="w-full h-full">
         <div class="no-print flex justify-between items-center bg-gray-100 p-4 border-b border-gray-200 sticky top-0 z-50">
             <div class="text-sm text-slate-500 font-bold">${e}</div>
             <button onclick="window.print()" class="bg-slate-800 text-white px-6 py-2 rounded-lg font-bold">طباعة</button>
         </div>
         <div class="paper w-full">${n}</div>
      </div>
    </body>
    </html>
  `;try{const{Capacitor:r}=await he(async()=>{const{Capacitor:d}=await Promise.resolve().then(()=>ho);return{Capacitor:d}},void 0);r.isNativePlatform()?Do(e,a):Us(e,a)}catch{Us(e,a)}},Us=(t,e)=>{const s=window.open("","_blank","width=1100,height=900");if(!s){alert("Please allow popups to print.");return}s.document.write(e),s.document.close()},Do=(t,e)=>{const s=document.createElement("div");s.id="mobile-print-overlay",s.style.cssText=`
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: white;
        z-index: 99999;
        overflow: auto;
        padding: 0;
    `;const n=document.createElement("div");n.style.cssText=`
        position: sticky;
        top: 0;
        z-index: 100000;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        background: #1e293b;
        color: white;
    `,n.innerHTML=`
        <span style="font-weight: bold; font-size: 14px;">${t}</span>
        <div style="display: flex; gap: 8px;">
            <button id="mobile-print-btn" style="background: #10b981; color: white; padding: 8px 20px; border-radius: 8px; font-weight: bold; border: none;">طباعة</button>
            <button id="mobile-print-close" style="background: #ef4444; color: white; padding: 8px 20px; border-radius: 8px; font-weight: bold; border: none;">إغلاق</button>
        </div>
    `;const a=document.createElement("div");a.innerHTML=e,s.appendChild(n),s.appendChild(a),document.body.appendChild(s),document.getElementById("mobile-print-close")?.addEventListener("click",()=>{s.remove()}),document.getElementById("mobile-print-btn")?.addEventListener("click",()=>{n.style.display="none",window.print(),n.style.display="flex"})},wa=t=>{const e=window.open("","_blank","width=400,height=700");if(!e){alert("Please allow popups to print.");return}const s=`
    <!DOCTYPE html>
    <html dir="rtl" lang="ar">
    <head>
      <meta charset="UTF-8">
      <title>إيصال #${t.invoiceId}</title>
      <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
          font-family: 'Courier New', monospace;
          font-size: 12px;
          width: 80mm;
          max-width: 80mm;
          margin: 0 auto;
          padding: 5mm;
          background: #fff;
          direction: rtl;
        }
        .header { text-align: center; border-bottom: 1px dashed #000; padding-bottom: 8px; margin-bottom: 8px; }
        .company-name { font-size: 16px; font-weight: bold; margin-bottom: 4px; }
        .company-phone { font-size: 11px; color: #333; }
        .invoice-info { text-align: center; margin-bottom: 8px; font-size: 11px; }
        .divider { border-bottom: 1px dashed #000; margin: 8px 0; }
        .customer { margin-bottom: 8px; }
        .items { width: 100%; margin-bottom: 8px; }
        .items th, .items td { text-align: right; padding: 3px 0; font-size: 11px; }
        .items th { border-bottom: 1px solid #000; }
        .item-name { font-weight: bold; }
        .item-details { font-size: 10px; color: #555; }
        .totals { margin-top: 8px; border-top: 1px dashed #000; padding-top: 8px; }
        .total-row { display: flex; justify-content: space-between; padding: 2px 0; }
        .grand-total { font-size: 16px; font-weight: bold; border-top: 2px solid #000; margin-top: 4px; padding-top: 4px; }
        .footer { text-align: center; margin-top: 16px; font-size: 10px; color: #666; }
        .thanks { font-size: 14px; font-weight: bold; margin-bottom: 8px; }
        .no-print { text-align: center; margin-bottom: 10px; padding: 10px; background: #f0f0f0; }
        @media print {
          @page { size: 80mm auto; margin: 0; }
          body { width: 80mm; padding: 2mm; }
          .no-print { display: none !important; }
        }
      </style>
    </head>
    <body>
      <div class="no-print">
        <button onclick="window.print()" style="padding: 10px 30px; font-size: 14px; cursor: pointer; background: #333; color: white; border: none; border-radius: 5px;">طباعة الإيصال</button>
      </div>
      
      <div class="header">
        ${t.companyLogo?`<div style="text-align: center; margin-bottom: 8px;"><img src="${t.companyLogo}" alt="Logo" style="max-width: 50mm; max-height: 20mm; object-fit: contain;" /></div>`:""}
        <div class="company-name">${t.companyName||"متجرنا"}</div>
        ${t.companyPhone?`<div class="company-phone">📞 ${t.companyPhone}</div>`:""}
      </div>
      
      <div class="invoice-info">
        <div><strong>فاتورة رقم:</strong> ${t.invoiceId}</div>
        <div><strong>التاريخ:</strong> ${new Date(t.date).toLocaleDateString("ar-EG")} ${new Date(t.date).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"})}</div>
        ${t.cashierName?`<div><strong>الكاشير:</strong> ${t.cashierName}</div>`:""}
      </div>
      
      <div class="divider"></div>
      
      <div class="customer">
        <strong>العميل:</strong> ${t.customerName}
      </div>
      
      <table class="items" width="100%">
        <thead>
          <tr>
            <th style="width: 50%">الصنف</th>
            <th style="width: 15%; text-align: center">ك</th>
            <th style="width: 15%; text-align: left">سعر</th>
            <th style="width: 20%; text-align: left">المجموع</th>
          </tr>
        </thead>
        <tbody>
          ${t.lines.map(n=>`
            <tr>
              <td class="item-name">${n.name}</td>
              <td style="text-align: center">${yo(n.qty)}</td>
              <td style="text-align: left">${n.price.toLocaleString()}</td>
              <td style="text-align: left">${n.total.toLocaleString()}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
      
      <div class="totals">
        <div class="total-row">
          <span>المجموع الفرعي:</span>
          <span>${t.subtotal.toLocaleString()} ج.م</span>
        </div>
        ${t.discount&&t.discount>0?`
        <div class="total-row" style="color: green;">
          <span>الخصم:</span>
          <span>-${t.discount.toLocaleString()} ج.م</span>
        </div>
        `:""}
        ${t.tax&&t.tax>0?`
        <div class="total-row">
          <span>الضريبة:</span>
          <span>${t.tax.toLocaleString()} ج.م</span>
        </div>
        `:""}
        <div class="total-row grand-total">
          <span>الإجمالي:</span>
          <span>${t.total.toLocaleString()} ج.م</span>
        </div>
        ${t.paymentMethod?`
        <div class="total-row" style="font-size: 11px; margin-top: 4px;">
          <span>طريقة الدفع:</span>
          <span>${t.paymentMethod}</span>
        </div>
        `:""}
      </div>
      
      ${t.notes?`<div class="divider"></div><div style="font-size: 10px; color: #666;">ملاحظات: ${t.notes}</div>`:""}
      
      <div class="footer">
        <div class="thanks">شكراً لزيارتكم!</div>
        <div>نتطلع لخدمتكم مجدداً</div>
        <div style="margin-top: 8px;">================================</div>
      </div>
      
      <script>
        // Auto print after load
        setTimeout(() => { window.print(); }, 500);
      <\/script>
    </body>
    </html>
    `;e.document.write(s),e.document.close()},W=(t,e,s,n)=>({accountId:t.id,accountName:t.name,debit:e,credit:s,costCenterId:n}),mt=t=>Math.round(t*100)/100,H={CASH:"101",BANK:"10201",INVENTORY:"103",AR:"104",NOTES_RECEIVABLE:"106",CHEQUES_UNDER_COLLECTION:"107",WHT_RECEIVABLE:"108",AP:"201",NOTES_PAYABLE:"203",WHT_PAYABLE:"205",SALES:"401",COGS:"501",DISCOUNT_ALLOWED:"502",DISCOUNT_EARNED:"402",TAX_PAYABLE:"202",TAX_RECEIVABLE:"105",SHIPPING_REV:"403",SHIPPING_EXP:"503"},Ta=(t,e)=>{if(t.length===0)return;const s=Object.keys(t[0]),n=[];n.push(s.join(","));for(const c of t){const p=s.map(y=>`"${(""+c[y]).replace(/"/g,'\\"')}"`);n.push(p.join(","))}const a=new Blob([n.join(`
`)],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(a),d=document.createElement("a");d.setAttribute("href",r),d.setAttribute("download",`${e}.csv`),document.body.appendChild(d),d.click(),document.body.removeChild(d)},Kt=(t,e)=>{if(e&&e.fiscalLockDate&&new Date(t)<=new Date(e.fiscalLockDate))throw new Error(`الفترة المالية مغلقة حتى تاريخ ${e.fiscalLockDate}. لا يمكن التعديل.`)},Mt=(t,e)=>{const s=t.filter(r=>Math.abs(r.debit)>.001||Math.abs(r.credit)>.001);if(s.length===0)return[];const n=s.reduce((r,d)=>r+d.debit,0),a=s.reduce((r,d)=>r+d.credit,0);if(Math.abs(n-a)>.01)throw new Error(`القيد غير متوازن. المدين: ${n.toLocaleString()}, الدائن: ${a.toLocaleString()}`);return s},dn=(t,e,s,n,a,r,d=[])=>{Kt(t.date,r);let c=[...s],p=[...n],y=[...a],C=[...d];const P=(N,m,I)=>{if(!m)return;const x=C.findIndex(S=>S.productId===N&&S.warehouseId===m);x>-1?C[x]={...C[x],stock:Number(C[x].stock)+Number(I)}:C.push({id:st(),productId:N,warehouseId:m,stock:Number(I)})};return t.status!==St.POSTED?{updatedProducts:c,updatedPartners:p,updatedAccounts:y,updatedProductStocks:C}:(t.type===B.INVOICE_SALE?t.lines.forEach(N=>{P(N.productId,t.warehouseId,N.quantity)}):t.type===B.INVOICE_PURCHASE?t.lines.forEach(N=>{P(N.productId,t.warehouseId,-N.quantity)}):t.type===B.RETURN_SALE?t.lines.forEach(N=>{P(N.productId,t.warehouseId,-N.quantity)}):t.type===B.RETURN_PURCHASE&&t.lines.forEach(N=>{P(N.productId,t.warehouseId,N.quantity)}),p=p.map(N=>{if(N.id===t.partnerId){let m=0;const I=t.total-(t.whtAmount||0);return N.type==="CUSTOMER"?t.type===B.INVOICE_SALE?m=-I:(t.type===B.RETURN_SALE||t.type===B.RECEIPT||t.type===B.DISCOUNT_ALLOWED)&&(m=I):t.type===B.INVOICE_PURCHASE?m=I:(t.type===B.RETURN_PURCHASE||t.type===B.PAYMENT||t.type===B.DISCOUNT_EARNED)&&(m=-I),{...N,balance:mt(N.balance+m)}}return N}),e&&(y=y.map(N=>{const m=e.lines.filter(x=>x.accountId===N.id);if(m.length===0)return N;let I=0;return m.forEach(x=>{["ASSET","EXPENSE"].includes(N.type)?I+=x.credit-x.debit:I+=x.debit-x.credit}),{...N,balance:mt(N.balance+I)}})),{updatedProducts:c,updatedPartners:p,updatedAccounts:y,updatedProductStocks:C})},Ao=(t,e,s,n,a,r,d,c=[],p=[],y={})=>{if(Kt(t.date,d),a&&Kt(a.date,d),t.paymentMethod===ze.MIXED){if(!t.paymentBreakdown)throw new Error("بيانات الدفع المختلط مفقودة");const{cash:R,cheque:K,bank:Q}=t.paymentBreakdown,de=R+K+Q;if(Math.abs(de-(t.total||0))>.01)throw new Error(`إجمالي طرق الدفع (${de.toLocaleString()}) لا يساوي قيمة الفاتورة (${(t.total||0).toLocaleString()})`)}const C=t.lines||[],P=C.reduce((R,K)=>R+(Number(K.price)*Number(K.quantity)-(Number(K.discount)||0)),0),N=Number(t.globalDiscount||0),m=Number(t.shippingFee||0),I=P-N+m,x=t.taxAmount>0?Number(t.taxAmount):0,S=t.total?Number(t.total):Math.round((I+x)*100)/100,X=new Map(e.map(R=>[R.id,R])),Y=C.reduce((R,K)=>{const Q=X.get(K.productId),de=K.cost!==void 0?K.cost:Q?.cost||0;return R+K.quantity*de},0),U={...t,id:t.id||ln(t.type),total:S,taxAmount:x,posted:t.status===St.POSTED,referenceNumber:t.referenceNumber||(()=>{const K={[B.INVOICE_SALE]:"INV-",[B.INVOICE_PURCHASE]:"PUR-",[B.RETURN_SALE]:"RET-S-",[B.RETURN_PURCHASE]:"RET-P-",[B.RECEIPT]:"REC-",[B.PAYMENT]:"PAY-"}[t.type]||"TRX-",Q=p.filter(de=>de.type===t.type&&de.referenceNumber).map(de=>de.referenceNumber);return So(Q,K)})()};let te=[...e],V=[...n],G=[...s],ie=[...c];const ue=(R,K,Q)=>{if(!K)return;const de=ie.findIndex(xe=>xe.productId===R&&xe.warehouseId===K);de>-1?ie[de]={...ie[de],stock:Number(ie[de].stock)+Number(Q)}:ie.push({id:st(),productId:R,warehouseId:K,stock:Number(Q)})};if(a&&a.status===St.POSTED){const R=dn(a,r,te,V,G,d,ie);te=R.updatedProducts,V=R.updatedPartners,G=R.updatedAccounts,ie=R.updatedProductStocks}if(t.status===St.DRAFT||t.status===St.VOID)return{invoice:U,journal:null,updatedProducts:te,updatedPartners:V,updatedAccounts:G,updatedProductStocks:ie,updatedInvoices:[],paymentAllocations:[],newCheques:[]};const h=t.whtAmount||0,k=S-h;if(t.type===B.INVOICE_SALE){for(const R of t.lines)ue(R.productId,t.warehouseId,-R.quantity);V=V.map(R=>R.id===t.partnerId?{...R,balance:mt(R.balance+k)}:R)}else if(t.type===B.INVOICE_PURCHASE){for(const R of t.lines){const K=te.findIndex(_e=>_e.id===R.productId);if(K===-1)throw new Error("Product not found");const Q=te[K],de=Q.stock,xe=Q.cost||0,je=R.quantity,ke=R.price;let nt=xe;if(je>0){const _e=de*xe+je*ke,Ye=de+je;nt=Ye>0?_e/Ye:0}te[K]={...Q,cost:nt,warehouseId:t.warehouseId||Q.warehouseId},ue(R.productId,t.warehouseId,je)}V=V.map(R=>R.id===t.partnerId?{...R,balance:mt(R.balance-S)}:R)}else if(t.type===B.RETURN_SALE){for(const R of t.lines)ue(R.productId,t.warehouseId,R.quantity);V=V.map(R=>R.id===t.partnerId?{...R,balance:mt(R.balance-S)}:R)}else if(t.type===B.RETURN_PURCHASE){for(const R of t.lines)ue(R.productId,t.warehouseId,-R.quantity);V=V.map(R=>R.id===t.partnerId?{...R,balance:mt(R.balance+S)}:R)}else t.type===B.RECEIPT||t.type===B.DISCOUNT_ALLOWED?V=V.map(R=>R.id===t.partnerId?{...R,balance:mt(R.balance-S)}:R):(t.type===B.PAYMENT||t.type===B.DISCOUNT_EARNED)&&(V=V.map(R=>R.id===t.partnerId?{...R,balance:mt(R.balance+S)}:R));const J=[],se=t.paymentMethod===ze.CHEQUE||t.paymentMethod===ze.MIXED&&(t.paymentBreakdown?.cheque||0)>0;se&&t.transactionCheques&&t.transactionCheques.length>0?t.transactionCheques.forEach(R=>{R.type==="NEW"&&(t.type===B.RECEIPT||t.type===B.INVOICE_SALE?J.push({id:st(),number:R.number||"N/A",amount:R.amount,bankName:R.bankName||"Unknown",dueDate:R.dueDate||t.date,status:ut.PENDING,type:"RECEIVABLE",partnerId:t.partnerId,partnerName:t.partnerName,createdDate:t.date,description:t.notes,transactionId:U.id}):(t.type===B.PAYMENT||t.type===B.INVOICE_PURCHASE)&&J.push({id:st(),number:R.number||"N/A",amount:R.amount,bankName:R.bankName||"Unknown",dueDate:R.dueDate||t.date,status:ut.PENDING,type:"PAYABLE",partnerId:t.partnerId,partnerName:t.partnerName,createdDate:t.date,bankAccountId:R.bankAccountId||t.bankAccountId,description:t.notes,transactionId:U.id}))}):se&&t.chequeEntryMode!=="ENDORSE"&&(t.type===B.RECEIPT||t.type===B.INVOICE_SALE?J.push({id:st(),number:t.chequeNumber||"N/A",amount:t.paymentBreakdown?.cheque||t.total,bankName:t.bankName||"Unknown",dueDate:t.dueDate||t.date,status:ut.PENDING,type:"RECEIVABLE",partnerId:t.partnerId,partnerName:t.partnerName,createdDate:t.date,description:t.notes,transactionId:U.id}):(t.type===B.PAYMENT||t.type===B.INVOICE_PURCHASE)&&J.push({id:st(),number:t.chequeNumber||"N/A",amount:t.paymentBreakdown?.cheque||t.total,bankName:t.bankName||"Unknown",dueDate:t.dueDate||t.date,status:ut.PENDING,type:"PAYABLE",partnerId:t.partnerId,partnerName:t.partnerName,createdDate:t.date,bankAccountId:t.bankAccountId,description:t.notes,transactionId:U.id}));const T=[],D=R=>{let K=G.find(Q=>Q.code===R);if(!K)throw new Error(`الحساب المحاسبي كود ${R} غير موجود في النظام.`);return K},oe=()=>{if(t.paymentMethod===ze.BANK&&t.bankAccountId){const R=G.find(K=>K.id===t.bankAccountId);if(R)return R}return t.paymentMethod===ze.BANK?D(H.BANK):D(H.CASH)};if(t.type===B.INVOICE_SALE){T.push(W(D(H.SALES),0,P,t.costCenterId)),x>0&&T.push(W(D(H.TAX_PAYABLE),0,x)),m>0&&T.push(W(D(H.SHIPPING_REV),0,m,t.costCenterId)),N>0&&T.push(W(D(H.DISCOUNT_ALLOWED),N,0,t.costCenterId)),h>0&&T.push(W(D(H.WHT_RECEIVABLE),h,0));const R=t.paymentMethod===ze.CREDIT?D(H.AR):t.paymentMethod===ze.CHEQUE?D(H.NOTES_RECEIVABLE):t.paymentMethod===ze.BANK?D(H.AR):oe();T.push(W(R,k,0)),Y>0&&(T.push(W(D(H.COGS),Y,0,t.costCenterId)),T.push(W(D(H.INVENTORY),0,Y)))}else if(t.type===B.INVOICE_PURCHASE){T.push(W(D(H.INVENTORY),P,0)),x>0&&T.push(W(D(H.TAX_RECEIVABLE),x,0)),m>0&&T.push(W(D(H.SHIPPING_EXP),m,0,t.costCenterId));const R=t.paymentMethod===ze.CREDIT?D(H.AP):t.paymentMethod===ze.CHEQUE?D(H.NOTES_PAYABLE):t.paymentMethod===ze.BANK?D(H.AP):oe();T.push(W(R,0,S)),N>0&&T.push(W(D(H.DISCOUNT_EARNED),0,N,t.costCenterId))}else if(t.type===B.RETURN_SALE)T.push(W(D(H.SALES),P,0,t.costCenterId)),x>0&&T.push(W(D(H.TAX_PAYABLE),x,0)),m>0&&T.push(W(D(H.SHIPPING_REV),m,0,t.costCenterId)),N>0&&T.push(W(D(H.DISCOUNT_ALLOWED),0,N,t.costCenterId)),t.paymentMethod===ze.CREDIT?T.push(W(D(H.AR),0,S)):T.push(W(oe(),0,S)),Y>0&&(T.push(W(D(H.INVENTORY),Y,0)),T.push(W(D(H.COGS),0,Y,t.costCenterId)));else if(t.type===B.RETURN_PURCHASE)t.paymentMethod===ze.CREDIT?T.push(W(D(H.AP),S,0)):T.push(W(oe(),S,0)),T.push(W(D(H.INVENTORY),0,P)),x>0&&T.push(W(D(H.TAX_RECEIVABLE),0,x)),N>0&&T.push(W(D(H.DISCOUNT_EARNED),N,0,t.costCenterId));else if(t.type===B.RECEIPT){T.push(W(D(H.AR),0,S,t.costCenterId));const R=S-h;if(h>0&&T.push(W(D(H.WHT_RECEIVABLE),h,0)),t.paymentMethod===ze.MIXED&&t.paymentBreakdown){const{cash:K,bank:Q,cheque:de}=t.paymentBreakdown;K>0&&T.push(W(D(H.CASH),K,0)),Q>0&&T.push(W(D(H.BANK),Q,0)),de>0&&T.push(W(D(H.NOTES_RECEIVABLE),de,0))}else t.paymentMethod===ze.CHEQUE?T.push(W(D(H.NOTES_RECEIVABLE),R,0)):T.push(W(oe(),R,0))}else if(t.type===B.PAYMENT){T.push(W(D(H.AP),S,0,t.costCenterId));const R=S-h;if(h>0&&T.push(W(D(H.WHT_PAYABLE),0,h)),t.paymentMethod===ze.MIXED&&t.paymentBreakdown){const{cash:K,bank:Q,cheque:de}=t.paymentBreakdown;K>0&&T.push(W(D(H.CASH),0,K)),Q>0&&T.push(W(D(H.BANK),0,Q)),de>0&&T.push(W(D(H.NOTES_PAYABLE),0,de))}else t.paymentMethod===ze.CHEQUE?t.transactionCheques&&t.transactionCheques.length>0?t.transactionCheques.forEach(K=>{K.type==="ENDORSE"?T.push(W(D(H.NOTES_RECEIVABLE),0,K.amount)):T.push(W(D(H.NOTES_PAYABLE),0,K.amount))}):t.chequeEntryMode==="ENDORSE"?T.push(W(D(H.NOTES_RECEIVABLE),0,R)):T.push(W(D(H.NOTES_PAYABLE),0,R)):T.push(W(oe(),0,R))}else t.type===B.DISCOUNT_ALLOWED?(T.push(W(D(H.DISCOUNT_ALLOWED),S,0,t.costCenterId)),T.push(W(D(H.AR),0,S))):t.type===B.DISCOUNT_EARNED&&(T.push(W(D(H.AP),S,0)),T.push(W(D(H.DISCOUNT_EARNED),0,S,t.costCenterId)));const ve=Mt(T);G=G.map(R=>{const K=ve.filter(de=>de.accountId===R.id);if(K.length===0)return R;let Q=0;return K.forEach(de=>{["ASSET","EXPENSE"].includes(R.type)?Q+=de.debit-de.credit:Q+=de.credit-de.debit}),{...R,balance:mt(R.balance+Q)}});const ge=J.length>0?` - شيكات: ${J.map(R=>R.number).join(", ")}`:"",Ne={id:st(),date:t.date,description:`${un(t.type)} #${U.id} - ${t.partnerName}${ge}`,referenceId:U.id,lines:ve},be=[],Fe=[];return Object.keys(y).length>0&&Object.entries(y).forEach(([R,K])=>{if(K<=0)return;const Q=p.find(de=>de.id===R);if(Q){const xe=Number(Q.paidAmount||0)+K;let je=Q.status;Math.abs(xe-Q.total)<.01?je=St.PAID:xe>0&&(je=St.PARTIAL),be.push({...Q,paidAmount:xe,status:je}),Fe.push({id:st(),paymentId:U.id,invoiceId:R,amount:K})}}),{invoice:U,journal:Ne,updatedProducts:te,updatedPartners:V,updatedAccounts:G,newCheques:J,updatedProductStocks:ie,updatedInvoices:be,paymentAllocations:Fe}},Io=(t,e,s,n,a)=>{const r=[],d=m=>s.find(I=>I.code===m)||{id:"mock",code:m,name:"N/A",type:"ASSET",balance:0};B.JOURNAL;let c="",p=[...n];if(t.type==="RECEIVABLE"){if(e===ut.UNDER_COLLECTION){const m=d(H.CHEQUES_UNDER_COLLECTION);r.push(W(m,t.amount,0)),r.push(W(d(H.NOTES_RECEIVABLE),0,t.amount)),B.CHEQUE_DEPOSIT,c=`إيداع شيك رقم ${t.number} للتحصيل`}else if(e===ut.COLLECTED){const I=(a?s.find(S=>S.id===a):d(H.BANK))||d(H.BANK);let x;t.status===ut.UNDER_COLLECTION?x=d(H.CHEQUES_UNDER_COLLECTION):x=d(H.NOTES_RECEIVABLE),r.push(W(I,t.amount,0)),r.push(W(x,0,t.amount)),B.CHEQUE_COLLECT,c=`تحصيل شيك رقم ${t.number}`}else if(e===ut.BOUNCED){let m;t.status===ut.UNDER_COLLECTION?m=d(H.CHEQUES_UNDER_COLLECTION):(t.status,ut.ENDORSED,m=d(H.NOTES_RECEIVABLE)),r.push(W(d(H.AR),t.amount,0)),r.push(W(m,0,t.amount)),B.CHEQUE_BOUNCE,c=`ارتجاع شيك رقم ${t.number} (${t.bounceReason||""})`,p=n.map(I=>I.id===t.partnerId?{...I,balance:mt(I.balance+t.amount)}:I)}}else if(e===ut.CASHED){r.push(W(d(H.NOTES_PAYABLE),t.amount,0));const m=a||t.bankAccountId,I=m?s.find(x=>x.id===m):d(H.BANK);r.push(W(I||d(H.BANK),0,t.amount)),B.CHEQUE_CASHED,c=`صرف شيك مورد رقم ${t.number}`}else e===ut.BOUNCED&&(r.push(W(d(H.NOTES_PAYABLE),t.amount,0)),r.push(W(d(H.AP),0,t.amount)),B.CHEQUE_BOUNCE,c=`ارتجاع شيك صادر رقم ${t.number}`,p=n.map(m=>m.id===t.partnerId?{...m,balance:mt(m.balance-t.amount)}:m));const y=Mt(r),C=s.map(m=>{const I=y.filter(S=>S.accountId===m.id);if(I.length===0)return m;let x=0;return I.forEach(S=>{["ASSET","EXPENSE"].includes(m.type)?x+=S.debit-S.credit:x+=S.credit-S.debit}),{...m,balance:mt(m.balance+x)}}),P={...t,status:e,...a?{bankAccountId:a}:{}},N={id:st(),date:rn(),description:c,referenceId:t.number,lines:y};return{updatedCheque:P,journal:N,updatedAccounts:C,updatedPartners:p}},Fo=(t,e,s,n)=>{let a=[...e],r=0;if(t.type===B.STOCK_PERMIT_IN)for(const m of t.items){const I=a.findIndex(x=>x.id===m.productId);if(I>-1){const x=a[I],S=x.stock,X=x.cost||0,Y=m.quantity,U=m.cost!==void 0?m.cost:X;let te=X;if(Y>0){const V=S*X,G=Y*U,ie=S+Y;ie>0?te=(V+G)/ie:te=U}a[I]={...x,stock:x.stock+m.quantity,cost:te},r+=m.quantity*U}}else if(t.type===B.STOCK_PERMIT_OUT)for(const m of t.items){const I=a.findIndex(x=>x.id===m.productId);if(I>-1){const x=a[I];a[I]={...x,stock:x.stock-m.quantity},r+=m.quantity*(x.cost||0)}}else if(t.type===B.STOCK_TRANSFER){if(!t.destWarehouseId)throw new Error("Destination Warehouse required for transfer");for(const m of t.items){const I=a.findIndex(X=>X.id===m.productId);if(I===-1)continue;const x=a[I];a[I]={...x,stock:x.stock-m.quantity};const S=a.findIndex(X=>X.sku===x.sku&&X.warehouseId===t.destWarehouseId);if(S>-1){const X=a[S],Y=X.stock,U=X.cost||0,te=m.quantity,V=m.cost||x.cost||0;let G=U;Y+te>0?G=(Y*U+te*V)/(Y+te):G=V,a[S]={...X,stock:X.stock+te,cost:G}}else{const X={...x,id:st(),warehouseId:t.destWarehouseId,stock:m.quantity,cost:m.cost||x.cost||0};a.push(X)}}}const d=t.id||ln(t.type),c={...t,id:d};let p=null;const y=(m,I,x)=>s.find(S=>S.code===m)||s.find(S=>x&&S.name.includes(x))||s.find(S=>S.type===I),C=y("103","ASSET","مخزون")||{id:"103",name:"Inventory"},P=y("501","EXPENSE","تسوية")||s.find(m=>m.code==="504")||{id:"501",name:"Adjustment"};if(r>0&&t.type!==B.STOCK_TRANSFER){const m=[],I=(x,S,X)=>({accountId:x.id,accountName:x.name,debit:S,credit:X});if(t.type===B.STOCK_PERMIT_IN?(m.push(I(C,r,0)),m.push(I(P,0,r))):(m.push(I(P,r,0)),m.push(I(C,0,r))),C.id&&P.id)try{const x=Mt(m,s);p={id:st(),date:t.date,description:`${un(t.type)} - ${t.description}`,referenceId:c.id,lines:x}}catch{}}let N=s;return p&&(N=s.map(m=>{const I=p.lines.filter(S=>S.accountId===m.id);if(I.length===0)return m;let x=0;return I.forEach(S=>{["ASSET","EXPENSE"].includes(m.type)?x+=S.debit-S.credit:x+=S.credit-S.debit}),{...m,balance:m.balance+x}})),{permit:c,updatedProducts:a,journal:p,updatedAccounts:N}},$s=(t,e)=>{let s=[...e];return t.type===B.STOCK_PERMIT_IN?t.items.forEach(n=>{const a=s.findIndex(r=>r.id===n.productId);a>-1&&(s[a]={...s[a],stock:s[a].stock-n.quantity})}):t.type===B.STOCK_PERMIT_OUT&&t.items.forEach(n=>{const a=s.findIndex(r=>r.id===n.productId);a>-1&&(s[a]={...s[a],stock:s[a].stock+n.quantity})}),{updatedProducts:s}},jo=(t,e,s)=>{Kt(t.date,s);const n=t.lines.map(c=>{const p=e.find(y=>y.id===c.accountId);if(!p)throw new Error(`Account not found: ${c.accountId}`);return{accountId:c.accountId,accountName:p.name,debit:c.debit,credit:c.credit}}),a=Mt(n),r={id:t.id||st(),date:t.date,description:t.description,referenceId:t.referenceId||"MANUAL",lines:a},d=e.map(c=>{const p=a.filter(C=>C.accountId===c.id);if(p.length===0)return c;let y=0;return p.forEach(C=>{["ASSET","EXPENSE"].includes(c.type)?y+=C.debit-C.credit:y+=C.credit-C.debit}),{...c,balance:c.balance+y}});return{journal:r,updatedAccounts:d}},Bo=(t,e)=>{const s=t.lines.map(c=>({...c,debit:c.credit,credit:c.debit})),n=Mt(s),a=t.referenceId&&t.referenceId!=="MANUAL"?`#${t.referenceId}`:t.description.length>50?t.description.substring(0,50)+"...":t.description,r={id:st(),date:rn(),description:`عكس قيد: ${a}`,referenceId:`REV-${t.id.substr(0,8)}`,lines:n},d=e.map(c=>{const p=n.filter(C=>C.accountId===c.id);if(p.length===0)return c;let y=0;return p.forEach(C=>{["ASSET","EXPENSE"].includes(c.type)?y+=C.debit-C.credit:y+=C.credit-C.debit}),{...c,balance:c.balance+y}});return{journal:r,updatedAccounts:d}},ko=(t,e,s,n)=>{Kt(e,n);const a=[];let r=0;const d=[...t];if(d.forEach((C,P)=>{if(C.status!=="ACTIVE")return;if(C.lastDepreciationDate){const m=new Date(C.lastDepreciationDate),I=new Date(e);if(m.getFullYear()===I.getFullYear()&&m.getMonth()===I.getMonth())return}const N=(C.purchaseCost-C.salvageValue)/(C.lifeYears*12);N>0&&(a.push({accountId:C.expenseAccountId,accountName:s.find(m=>m.id===C.expenseAccountId)?.name||"Depr Expense",debit:N,credit:0}),a.push({accountId:C.accumulatedDepreciationAccountId,accountName:s.find(m=>m.id===C.accumulatedDepreciationAccountId)?.name||"Accum Depr",debit:0,credit:N}),r+=N,d[P]={...C,lastDepreciationDate:e})}),r===0)throw new Error("لا يوجد إهلاك مستحق للفترة المحددة، أو تم ترحيله مسبقاً.");const c=Mt(a),p={id:st(),date:e,description:`إهلاك الأصول الثابتة - ${e}`,referenceId:"DEPR-RUN",lines:c},y=s.map(C=>{const P=c.filter(m=>m.accountId===C.id);if(P.length===0)return C;let N=0;return P.forEach(m=>{["ASSET","EXPENSE"].includes(C.type)?N+=m.debit-m.credit:N+=m.credit-m.debit}),{...C,balance:C.balance+N}});return{journal:p,updatedAccounts:y,updatedAssets:d}},un=t=>{switch(t){case B.INVOICE_SALE:return"فاتورة مبيعات";case B.INVOICE_PURCHASE:return"فاتورة شراء";case B.RETURN_SALE:return"مرتجع مبيعات";case B.RETURN_PURCHASE:return"مرتجع مشتريات";case B.QUOTATION:return"عرض سعر";case B.STOCK_PERMIT_IN:return"إذن إضافة";case B.STOCK_PERMIT_OUT:return"إذن صرف";case B.STOCK_TRANSFER:return"تحويل مخزني";case B.RECEIPT:return"سند قبض";case B.PAYMENT:return"سند صرف";case B.DISCOUNT_ALLOWED:return"خصم مسموح به";case B.DISCOUNT_EARNED:return"خصم مكتسب";case B.CHEQUE_DEPOSIT:return"إيداع شيك";case B.CHEQUE_COLLECT:return"تحصيل شيك";case B.CHEQUE_BOUNCE:return"ارتجاع شيك";case B.ASSET_DEPRECIATION:return"إهلاك أصول";default:return"عملية"}},as=1e3,De=60*as,hs=60*De,Oe={invoices:5*as,productStocks:10*as,auditLogs:30*as,journals:1*De,cheques:2*De,stockPermits:2*De,partners:10*De,products:10*De,accounts:15*De,priceLists:10*De,boms:10*De,branches:30*De,warehouses:30*De,categories:30*De,salesmen:30*De,costCenters:30*De,cashCategories:30*De,banks:30*De,systemConfig:60*De,stockSessions:15*De},He={invoices:15*De,journals:30*De,partners:60*De,products:60*De,accounts:60*De,systemConfig:2*hs,branches:2*hs,warehouses:2*hs,default:30*De},Ie={products:t=>["products",t],productDetail:t=>["products",t],partners:t=>["partners",t],partnerDetail:t=>["partners",t],accounts:()=>["accounts"],users:()=>["users"],invoices:t=>["invoices",t],invoiceDetail:t=>["invoices",t],journals:t=>["journals",t],branches:()=>["master","branches"],warehouses:()=>["master","warehouses"],categories:()=>["master","categories"],salesmen:()=>["master","salesmen"],taxes:()=>["master","taxes"],costCenters:()=>["master","cost-centers"],cashCategories:()=>["master","cash-categories"],partnerGroups:()=>["master","partner-groups"],banks:()=>["banks"],cheques:t=>["cheques",t],productStocks:()=>["product-stocks"],stockPermits:t=>["stock-permits",t],stockSessions:()=>["stock-sessions"],boms:()=>["boms"],productionOrders:t=>["production-orders",t],stockMovements:t=>["stock-movements",t],config:()=>["system-config"],permissions:()=>["permissions"],auditLogs:t=>["audit-logs",t],priceLists:()=>["price-lists"],assets:()=>["fixed-assets"]};function La(){return Ae({queryKey:Ie.products(),queryFn:()=>l.getProducts(),staleTime:Oe.products,gcTime:He.products})}function Sa(t){const{enabled:e=!0,...s}=t||{};return Ae({queryKey:Ie.partners(s),queryFn:()=>l.getPartners(s),staleTime:Oe.partners,gcTime:He.partners,placeholderData:n=>n,enabled:e})}function Da(t){const{enabled:e=!0,minimal:s=!0,...n}=t||{};return Ae({queryKey:Ie.invoices({...n,minimal:s}),queryFn:()=>l.getInvoices({...n,minimal:s}),staleTime:Oe.invoices,gcTime:He.invoices,placeholderData:a=>a,enabled:e})}function Aa(){return Ae({queryKey:Ie.accounts(),queryFn:()=>l.getAccounts(),staleTime:Oe.accounts,gcTime:He.accounts})}function Ia(t){return Ae({queryKey:Ie.journals(t),queryFn:()=>l.getJournalEntries(t),staleTime:Oe.journals,gcTime:He.journals,placeholderData:e=>e})}function Fa(){return Ae({queryKey:Ie.users(),queryFn:()=>l.getUsers(),staleTime:10*60*1e3})}function ja(){return Ae({queryKey:Ie.branches(),queryFn:()=>l.getMasterData("branches"),staleTime:Oe.branches,gcTime:He.branches})}function Ba(){return Ae({queryKey:Ie.warehouses(),queryFn:()=>l.getMasterData("warehouses"),staleTime:Oe.warehouses,gcTime:He.warehouses})}function ka(){return Ae({queryKey:Ie.categories(),queryFn:()=>l.getMasterData("categories"),staleTime:Oe.categories,gcTime:He.default})}function Va(){return Ae({queryKey:Ie.salesmen(),queryFn:()=>l.getMasterData("salesmen"),staleTime:Oe.salesmen,gcTime:He.default})}function Oa(){return Ae({queryKey:Ie.costCenters(),queryFn:()=>l.getMasterData("cost-centers"),staleTime:Oe.costCenters,gcTime:He.default})}function Ha(){return Ae({queryKey:Ie.cashCategories(),queryFn:()=>l.getMasterData("cash-categories"),staleTime:Oe.cashCategories,gcTime:He.default})}function _a(){return Ae({queryKey:Ie.banks(),queryFn:()=>l.getBanks(),staleTime:Oe.banks,gcTime:He.default})}function Ua(t){return Ae({queryKey:Ie.cheques(t),queryFn:()=>l.getCheques(t),staleTime:Oe.cheques,gcTime:He.default,placeholderData:e=>e})}function $a(){return Ae({queryKey:Ie.productStocks(),queryFn:()=>l.getProductStocks(),staleTime:Oe.productStocks,gcTime:He.default})}function Ma(t){return Ae({queryKey:Ie.stockPermits(t),queryFn:()=>l.getStockPermits(t),staleTime:Oe.stockPermits,gcTime:He.default,placeholderData:e=>e})}function qa(){return Ae({queryKey:Ie.stockSessions(),queryFn:()=>l.getStockTakingSessions(),staleTime:Oe.stockSessions,gcTime:He.default})}function Xa(){return Ae({queryKey:Ie.boms(),queryFn:()=>l.getBOMs(),staleTime:Oe.boms,gcTime:He.default})}function za(){return Ae({queryKey:Ie.config(),queryFn:()=>l.getSystemConfig(),staleTime:Oe.systemConfig,gcTime:He.systemConfig})}function Wa(t){return Ae({queryKey:Ie.auditLogs(t),queryFn:()=>l.getAuditLogs(t),staleTime:Oe.auditLogs,gcTime:He.default,placeholderData:e=>e})}function Ka(){return Ae({queryKey:Ie.priceLists(),queryFn:()=>l.getPriceLists(),staleTime:Oe.priceLists,gcTime:He.default})}function Ya(){return Ae({queryKey:Ie.assets(),queryFn:()=>l.getFixedAssets(),staleTime:10*60*1e3})}function Vo(){const t=Ys();return{invalidateProducts:()=>t.invalidateQueries({queryKey:["products"]}),invalidatePartners:()=>t.invalidateQueries({queryKey:["partners"]}),invalidateInvoices:()=>t.refetchQueries({queryKey:["invoices"],type:"all"}),invalidateJournals:()=>t.invalidateQueries({queryKey:["journals"]}),invalidateAccounts:()=>t.invalidateQueries({queryKey:["accounts"]}),invalidateBanks:()=>t.invalidateQueries({queryKey:["banks"]}),invalidateProductStocks:()=>t.invalidateQueries({queryKey:["product-stocks"]}),invalidateStockPermits:()=>t.invalidateQueries({queryKey:["stock-permits"]}),invalidateStockSessions:()=>t.invalidateQueries({queryKey:["stock-sessions"]}),invalidateWarehouses:()=>t.invalidateQueries({queryKey:["master","warehouses"]}),invalidateCategories:()=>t.invalidateQueries({queryKey:["master","categories"]}),invalidateUsers:()=>t.invalidateQueries({queryKey:["users"]}),invalidateSettings:()=>t.invalidateQueries({queryKey:["system-config"]}),invalidateBranches:()=>t.invalidateQueries({queryKey:["master","branches"]}),invalidateSalesmen:()=>t.invalidateQueries({queryKey:["master","salesmen"]}),invalidateTaxes:()=>t.invalidateQueries({queryKey:["master","taxes"]}),invalidateCostCenters:()=>t.invalidateQueries({queryKey:["master","cost-centers"]}),invalidateCashCategories:()=>t.invalidateQueries({queryKey:["master","cash-categories"]}),invalidatePartnerGroups:()=>t.invalidateQueries({queryKey:["master","partner-groups"]}),invalidatePriceLists:()=>t.invalidateQueries({queryKey:["price-lists"]}),invalidateAll:()=>t.invalidateQueries()}}const Ms=["temp_data"],Nt={getItem:t=>{try{return(Ms.includes(t)?sessionStorage:localStorage).getItem(t)}catch{return null}},setItem:(t,e)=>{try{(Ms.includes(t)?sessionStorage:localStorage).setItem(t,e)}catch{}},removeItem:t=>{try{sessionStorage.removeItem(t),localStorage.removeItem(t)}catch{}}};class Oo{constructor(){this.socket=null,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.listeners=new Map,this.fallbackAttempted=!1,this.mobileServerUrl=null}setMobileServerUrl(e){this.mobileServerUrl=e}connect(e,s){this.socket?.connected||(s&&(this.mobileServerUrl=s),this.attemptConnection(e,!1))}attemptConnection(e,s){let n="/";try{window.Capacitor?.isNativePlatform?.()&&this.mobileServerUrl&&(n=this.mobileServerUrl)}catch{}this.socket=Xn(n,{auth:{token:e},reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:this.maxReconnectAttempts,transports:["websocket","polling"],path:"/socket.io",timeout:1e4}),this.socket.on("connect",()=>{this.reconnectAttempts=0,this.emit("connection:status",{connected:!0})}),this.socket.on("disconnect",a=>{this.emit("connection:status",{connected:!1,reason:a})}),this.socket.on("connect_error",a=>{this.reconnectAttempts++,this.reconnectAttempts>=this.maxReconnectAttempts&&this.emit("connection:failed",{error:a})}),this.setupDefaultListeners()}setupDefaultListeners(){this.socket&&(this.socket.on("users:online",e=>{this.emit("users:online",e)}),this.socket.on("notification:receive",e=>{this.emit("notification",e)}),this.socket.on("lock:acquired",e=>{this.emit("lock:acquired",e)}),this.socket.on("lock:released",e=>{this.emit("lock:released",e)}),this.socket.on("invoice:new",e=>{this.emit("invoice:new",e)}),this.socket.on("invoice:changed",e=>{this.emit("invoice:changed",e)}),this.socket.on("invoice:removed",e=>{this.emit("invoice:removed",e)}),this.socket.on("product:changed",e=>{this.emit("product:changed",e)}),this.socket.on("stock:updated",e=>{this.emit("stock:updated",e)}),this.socket.on("partner:changed",e=>{this.emit("partner:changed",e)}),this.socket.on("entity:changed",e=>{this.emit("entity:changed",e)}),this.socket.on("entity:deleted",e=>{this.emit("entity:deleted",e)}),this.socket.on("chat:message",e=>{this.emit("chat:message",e)}),this.socket.on("chat:system",e=>{this.emit("chat:system",e)}),this.socket.on("chat:private",e=>{this.emit("chat:private",e)}),this.socket.on("chat:typing",e=>{this.emit("chat:typing",e)}),this.socket.on("settlement:approved",e=>{this.emit("settlement:approved",e)}))}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.listeners.clear())}on(e,s){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(s)}off(e,s){const n=this.listeners.get(e);n&&n.delete(s)}emit(e,s){const n=this.listeners.get(e);n&&n.forEach(a=>a(s))}setCurrentView(e){this.socket?.emit("user:viewing",{view:e})}requestLock(e,s){return new Promise(n=>{this.socket?.emit("lock:request",{type:e,id:s},n)})}releaseLock(e,s){this.socket?.emit("lock:release",{type:e,id:s})}broadcastInvoiceCreated(e){this.socket?.emit("invoice:created",e)}broadcastInvoiceUpdated(e){this.socket?.emit("invoice:updated",e)}broadcastInvoiceDeleted(e){this.socket?.emit("invoice:deleted",e)}broadcastProductUpdated(e){this.socket?.emit("product:updated",e)}broadcastStockChanged(e,s){this.socket?.emit("stock:changed",{productId:e,newStock:s})}broadcastPartnerUpdated(e){this.socket?.emit("partner:updated",e)}broadcastEntityChanged(e,s){this.socket?.emit("entity:changed",{entityType:e,entity:s})}broadcastEntityDeleted(e,s){this.socket?.emit("entity:deleted",{entityType:e,entityId:s})}sendNotification(e,s,n){}sendChatMessage(e){this.socket?.emit("chat:send",e)}sendPrivateMessage(e,s,n){this.socket?.emit("chat:private",{targetUserId:e,message:s,id:n})}sendTypingIndicator(e,s){this.socket?.emit("chat:typing",{targetUserId:e,isTyping:s})}getSocket(){return this.socket}isConnected(){return this.socket?.connected??!1}}const ee=new Oo,Pt=$t("Preferences",{web:()=>he(()=>import("./web-DSiDojuC.js"),__vite__mapDeps([0,1,2,3,4,5])).then(t=>new t.PreferencesWeb)}),Ho=Object.freeze(Object.defineProperty({__proto__:null,Preferences:Pt},Symbol.toStringTag,{value:"Module"}));class _o{constructor(e){this.sqlite=e,this._connectionDict=new Map}async initWebStore(){try{return await this.sqlite.initWebStore(),Promise.resolve()}catch(e){return Promise.reject(e)}}async saveToStore(e){try{return await this.sqlite.saveToStore({database:e}),Promise.resolve()}catch(s){return Promise.reject(s)}}async saveToLocalDisk(e){try{return await this.sqlite.saveToLocalDisk({database:e}),Promise.resolve()}catch(s){return Promise.reject(s)}}async getFromLocalDiskToStore(e){const s=e??!0;try{return await this.sqlite.getFromLocalDiskToStore({overwrite:s}),Promise.resolve()}catch(n){return Promise.reject(n)}}async echo(e){try{const s=await this.sqlite.echo({value:e});return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async isSecretStored(){try{const e=await this.sqlite.isSecretStored();return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async setEncryptionSecret(e){try{return await this.sqlite.setEncryptionSecret({passphrase:e}),Promise.resolve()}catch(s){return Promise.reject(s)}}async changeEncryptionSecret(e,s){try{return await this.sqlite.changeEncryptionSecret({passphrase:e,oldpassphrase:s}),Promise.resolve()}catch(n){return Promise.reject(n)}}async clearEncryptionSecret(){try{return await this.sqlite.clearEncryptionSecret(),Promise.resolve()}catch(e){return Promise.reject(e)}}async checkEncryptionSecret(e){try{const s=await this.sqlite.checkEncryptionSecret({passphrase:e});return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async addUpgradeStatement(e,s){try{return e.endsWith(".db")&&(e=e.slice(0,-3)),await this.sqlite.addUpgradeStatement({database:e,upgrade:s}),Promise.resolve()}catch(n){return Promise.reject(n)}}async createConnection(e,s,n,a,r){try{e.endsWith(".db")&&(e=e.slice(0,-3)),await this.sqlite.createConnection({database:e,encrypted:s,mode:n,version:a,readonly:r});const d=new qs(e,r,this.sqlite),c=r?`RO_${e}`:`RW_${e}`;return this._connectionDict.set(c,d),Promise.resolve(d)}catch(d){return Promise.reject(d)}}async closeConnection(e,s){try{e.endsWith(".db")&&(e=e.slice(0,-3)),await this.sqlite.closeConnection({database:e,readonly:s});const n=s?`RO_${e}`:`RW_${e}`;return this._connectionDict.delete(n),Promise.resolve()}catch(n){return Promise.reject(n)}}async isConnection(e,s){const n={};e.endsWith(".db")&&(e=e.slice(0,-3));const a=s?`RO_${e}`:`RW_${e}`;return n.result=this._connectionDict.has(a),Promise.resolve(n)}async retrieveConnection(e,s){e.endsWith(".db")&&(e=e.slice(0,-3));const n=s?`RO_${e}`:`RW_${e}`;if(this._connectionDict.has(n)){const a=this._connectionDict.get(n);return typeof a<"u"?Promise.resolve(a):Promise.reject(`Connection ${e} is undefined`)}else return Promise.reject(`Connection ${e} does not exist`)}async getNCDatabasePath(e,s){try{const n=await this.sqlite.getNCDatabasePath({path:e,database:s});return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async createNCConnection(e,s){try{await this.sqlite.createNCConnection({databasePath:e,version:s});const n=new qs(e,!0,this.sqlite),a=`RO_${e})`;return this._connectionDict.set(a,n),Promise.resolve(n)}catch(n){return Promise.reject(n)}}async closeNCConnection(e){try{await this.sqlite.closeNCConnection({databasePath:e});const s=`RO_${e})`;return this._connectionDict.delete(s),Promise.resolve()}catch(s){return Promise.reject(s)}}async isNCConnection(e){const s={},n=`RO_${e})`;return s.result=this._connectionDict.has(n),Promise.resolve(s)}async retrieveNCConnection(e){if(this._connectionDict.has(e)){const s=`RO_${e})`,n=this._connectionDict.get(s);return typeof n<"u"?Promise.resolve(n):Promise.reject(`Connection ${e} is undefined`)}else return Promise.reject(`Connection ${e} does not exist`)}async isNCDatabase(e){try{const s=await this.sqlite.isNCDatabase({databasePath:e});return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async retrieveAllConnections(){return this._connectionDict}async closeAllConnections(){const e=new Map;try{for(const s of this._connectionDict.keys()){const n=s.substring(3),a=s.substring(0,3)==="RO_";await this.sqlite.closeConnection({database:n,readonly:a}),e.set(s,null)}for(const s of e.keys())this._connectionDict.delete(s);return Promise.resolve()}catch(s){return Promise.reject(s)}}async checkConnectionsConsistency(){try{const e=[...this._connectionDict.keys()],s=[],n=[];for(const r of e)s.push(r.substring(0,2)),n.push(r.substring(3));const a=await this.sqlite.checkConnectionsConsistency({dbNames:n,openModes:s});return a.result||(this._connectionDict=new Map),Promise.resolve(a)}catch(e){return this._connectionDict=new Map,Promise.reject(e)}}async importFromJson(e){try{const s=await this.sqlite.importFromJson({jsonstring:e});return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async isJsonValid(e){try{const s=await this.sqlite.isJsonValid({jsonstring:e});return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async copyFromAssets(e){const s=e??!0;try{return await this.sqlite.copyFromAssets({overwrite:s}),Promise.resolve()}catch(n){return Promise.reject(n)}}async getFromHTTPRequest(e,s){const n=s??!0;try{return await this.sqlite.getFromHTTPRequest({url:e,overwrite:n}),Promise.resolve()}catch(a){return Promise.reject(a)}}async isDatabaseEncrypted(e){e.endsWith(".db")&&(e=e.slice(0,-3));try{const s=await this.sqlite.isDatabaseEncrypted({database:e});return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async isInConfigEncryption(){try{const e=await this.sqlite.isInConfigEncryption();return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async isInConfigBiometricAuth(){try{const e=await this.sqlite.isInConfigBiometricAuth();return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async isDatabase(e){e.endsWith(".db")&&(e=e.slice(0,-3));try{const s=await this.sqlite.isDatabase({database:e});return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async getDatabaseList(){try{const s=(await this.sqlite.getDatabaseList()).values;s.sort();const n={values:s};return Promise.resolve(n)}catch(e){return Promise.reject(e)}}async getMigratableDbList(e){const s=e||"default";try{const n=await this.sqlite.getMigratableDbList({folderPath:s});return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async addSQLiteSuffix(e,s){const n=e||"default",a=s||[];try{const r=await this.sqlite.addSQLiteSuffix({folderPath:n,dbNameList:a});return Promise.resolve(r)}catch(r){return Promise.reject(r)}}async deleteOldDatabases(e,s){const n=e||"default",a=s||[];try{const r=await this.sqlite.deleteOldDatabases({folderPath:n,dbNameList:a});return Promise.resolve(r)}catch(r){return Promise.reject(r)}}async moveDatabasesAndAddSuffix(e,s){const n=e||"default",a=s||[];return this.sqlite.moveDatabasesAndAddSuffix({folderPath:n,dbNameList:a})}}class qs{constructor(e,s,n){this.dbName=e,this.readonly=s,this.sqlite=n}getConnectionDBName(){return this.dbName}getConnectionReadOnly(){return this.readonly}async open(){try{return await this.sqlite.open({database:this.dbName,readonly:this.readonly}),Promise.resolve()}catch(e){return Promise.reject(e)}}async close(){try{return await this.sqlite.close({database:this.dbName,readonly:this.readonly}),Promise.resolve()}catch(e){return Promise.reject(e)}}async beginTransaction(){try{const e=await this.sqlite.beginTransaction({database:this.dbName});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async commitTransaction(){try{const e=await this.sqlite.commitTransaction({database:this.dbName});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async rollbackTransaction(){try{const e=await this.sqlite.rollbackTransaction({database:this.dbName});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async isTransactionActive(){try{const e=await this.sqlite.isTransactionActive({database:this.dbName});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async loadExtension(e){try{return await this.sqlite.loadExtension({database:this.dbName,path:e,readonly:this.readonly}),Promise.resolve()}catch(s){return Promise.reject(s)}}async enableLoadExtension(e){try{return await this.sqlite.enableLoadExtension({database:this.dbName,toggle:e,readonly:this.readonly}),Promise.resolve()}catch(s){return Promise.reject(s)}}async getUrl(){try{const e=await this.sqlite.getUrl({database:this.dbName,readonly:this.readonly});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async getVersion(){try{const e=await this.sqlite.getVersion({database:this.dbName,readonly:this.readonly});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async getTableList(){try{const e=await this.sqlite.getTableList({database:this.dbName,readonly:this.readonly});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async execute(e,s=!0,n=!0){try{if(this.readonly)return Promise.reject("not allowed in read-only mode");{const a=await this.sqlite.execute({database:this.dbName,statements:e,transaction:s,readonly:!1,isSQL92:n});return Promise.resolve(a)}}catch(a){return Promise.reject(a)}}async query(e,s,n=!0){let a;try{return s&&s.length>0?a=await this.sqlite.query({database:this.dbName,statement:e,values:s,readonly:this.readonly,isSQL92:!0}):a=await this.sqlite.query({database:this.dbName,statement:e,values:[],readonly:this.readonly,isSQL92:n}),a=await this.reorderRows(a),Promise.resolve(a)}catch(r){return Promise.reject(r)}}async run(e,s,n=!0,a="no",r=!0){let d;try{return this.readonly?Promise.reject("not allowed in read-only mode"):(s&&s.length>0?d=await this.sqlite.run({database:this.dbName,statement:e,values:s,transaction:n,readonly:!1,returnMode:a,isSQL92:!0}):d=await this.sqlite.run({database:this.dbName,statement:e,values:[],transaction:n,readonly:!1,returnMode:a,isSQL92:r}),d.changes=await this.reorderRows(d.changes),Promise.resolve(d))}catch(c){return Promise.reject(c)}}async executeSet(e,s=!0,n="no",a=!0){let r;try{return this.readonly?Promise.reject("not allowed in read-only mode"):(r=await this.sqlite.executeSet({database:this.dbName,set:e,transaction:s,readonly:!1,returnMode:n,isSQL92:a}),r.changes=await this.reorderRows(r.changes),Promise.resolve(r))}catch(d){return Promise.reject(d)}}async isExists(){try{const e=await this.sqlite.isDBExists({database:this.dbName,readonly:this.readonly});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async isTable(e){try{const s=await this.sqlite.isTableExists({database:this.dbName,table:e,readonly:this.readonly});return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async isDBOpen(){try{const e=await this.sqlite.isDBOpen({database:this.dbName,readonly:this.readonly});return Promise.resolve(e)}catch(e){return Promise.reject(e)}}async delete(){try{return this.readonly?Promise.reject("not allowed in read-only mode"):(await this.sqlite.deleteDatabase({database:this.dbName,readonly:!1}),Promise.resolve())}catch(e){return Promise.reject(e)}}async createSyncTable(){try{if(this.readonly)return Promise.reject("not allowed in read-only mode");{const e=await this.sqlite.createSyncTable({database:this.dbName,readonly:!1});return Promise.resolve(e)}}catch(e){return Promise.reject(e)}}async setSyncDate(e){try{return this.readonly?Promise.reject("not allowed in read-only mode"):(await this.sqlite.setSyncDate({database:this.dbName,syncdate:e,readonly:!1}),Promise.resolve())}catch(s){return Promise.reject(s)}}async getSyncDate(){try{const e=await this.sqlite.getSyncDate({database:this.dbName,readonly:this.readonly});let s="";return e.syncDate>0&&(s=new Date(e.syncDate*1e3).toISOString()),Promise.resolve(s)}catch(e){return Promise.reject(e)}}async exportToJson(e,s=!1){try{const n=await this.sqlite.exportToJson({database:this.dbName,jsonexportmode:e,readonly:this.readonly,encrypted:s});return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async deleteExportedRows(){try{return this.readonly?Promise.reject("not allowed in read-only mode"):(await this.sqlite.deleteExportedRows({database:this.dbName,readonly:!1}),Promise.resolve())}catch(e){return Promise.reject(e)}}async executeTransaction(e,s=!0){let n=0,a=!1;if(this.readonly)return Promise.reject("not allowed in read-only mode");if(await this.sqlite.beginTransaction({database:this.dbName}),a=await this.sqlite.isTransactionActive({database:this.dbName}),!a)return Promise.reject("After Begin Transaction, no transaction active");try{for(const c of e){if(typeof c!="object"||!("statement"in c))throw new Error("Error a task.statement must be provided");if("values"in c&&c.values&&c.values.length>0){const p=c.statement.toUpperCase().includes("RETURNING")?"all":"no",y=await this.sqlite.run({database:this.dbName,statement:c.statement,values:c.values,transaction:!1,readonly:!1,returnMode:p,isSQL92:s});if(y.changes.changes<0)throw new Error("Error in transaction method run ");n+=y.changes.changes}else{const p=await this.sqlite.execute({database:this.dbName,statements:c.statement,transaction:!1,readonly:!1});if(p.changes.changes<0)throw new Error("Error in transaction method execute ");n+=p.changes.changes}}const r=await this.sqlite.commitTransaction({database:this.dbName});n+=r.changes.changes;const d={changes:{changes:n}};return Promise.resolve(d)}catch(r){const d=r.message?r.message:r;return await this.sqlite.rollbackTransaction({database:this.dbName}),Promise.reject(d)}}async reorderRows(e){const s=e;if(e?.values&&typeof e.values[0]=="object"&&Object.keys(e.values[0]).includes("ios_columns")){const n=e.values[0].ios_columns,a=[];for(let r=1;r<e.values.length;r++){const d=e.values[r],c={};for(const p of n)c[p]=d[p];a.push(c)}s.values=a}return Promise.resolve(s)}}const Uo=$t("CapacitorSQLite",{web:()=>he(()=>import("./web-BM8CE2Hq.js"),__vite__mapDeps([6,1,2,3,4,5])).then(t=>new t.CapacitorSQLiteWeb),electron:()=>window.CapacitorCustomPlatform.plugins.CapacitorSQLite}),bs="DaftriXERP",$o=1,Lt={SERVER_URL:"erp_server_url",AUTH_TOKEN:"erp_auth_token",LAST_SYNC:"erp_last_sync"},cn=()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},Mo=[`CREATE TABLE IF NOT EXISTS products (
        id TEXT PRIMARY KEY NOT NULL,
        sku TEXT,
        barcode TEXT,
        name TEXT NOT NULL,
        price REAL DEFAULT 0,
        cost REAL DEFAULT 0,
        stock REAL DEFAULT 0,
        categoryId TEXT,
        categoryName TEXT,
        unit TEXT,
        image TEXT,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS partners (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT,
        name TEXT NOT NULL,
        phone TEXT,
        email TEXT,
        address TEXT,
        type TEXT NOT NULL,
        isCustomer INTEGER DEFAULT 0,
        isSupplier INTEGER DEFAULT 0,
        balance REAL DEFAULT 0,
        salesmanId TEXT,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS invoices (
        id TEXT PRIMARY KEY NOT NULL,
        number TEXT,
        date TEXT NOT NULL,
        type TEXT NOT NULL,
        status TEXT DEFAULT 'DRAFT',
        partnerId TEXT,
        partnerName TEXT,
        warehouseId TEXT,
        paymentMethod TEXT,
        total REAL DEFAULT 0,
        discount REAL DEFAULT 0,
        globalDiscount REAL DEFAULT 0,
        paidAmount REAL DEFAULT 0,
        previousBalance REAL,
        newBalance REAL,
        linesJson TEXT,
        salesmanId TEXT,
        salesmanName TEXT,
        createdBy TEXT,
        createdAt TEXT,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS accounts (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT NOT NULL,
        name TEXT NOT NULL,
        type TEXT NOT NULL,
        balance REAL DEFAULT 0,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS sync_metadata (
        entity TEXT PRIMARY KEY NOT NULL,
        lastSyncAt TEXT NOT NULL,
        itemCount INTEGER DEFAULT 0
    )`,`CREATE TABLE IF NOT EXISTS pending_sync (
        id TEXT PRIMARY KEY NOT NULL,
        entity TEXT NOT NULL,
        operation TEXT NOT NULL,
        entityId TEXT,
        data TEXT NOT NULL,
        createdAt TEXT NOT NULL,
        status TEXT DEFAULT 'PENDING',
        retryCount INTEGER DEFAULT 0,
        lastError TEXT,
        nextRetryAt TEXT,
        syncedAt TEXT
    )`,`CREATE TABLE IF NOT EXISTS warehouses (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT,
        name TEXT NOT NULL,
        type TEXT,
        location TEXT,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS payments (
        id TEXT PRIMARY KEY NOT NULL,
        type TEXT NOT NULL,
        partnerId TEXT,
        partnerName TEXT,
        amount REAL NOT NULL,
        date TEXT NOT NULL,
        method TEXT,
        reference TEXT,
        notes TEXT,
        status TEXT DEFAULT 'PENDING',
        syncedAt TEXT
    )`,`CREATE TABLE IF NOT EXISTS branches (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT,
        name TEXT NOT NULL,
        address TEXT,
        phone TEXT,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS categories (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT,
        name TEXT NOT NULL,
        parentId TEXT,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS priceLists (
        id TEXT PRIMARY KEY NOT NULL,
        name TEXT NOT NULL,
        type TEXT,
        isDefault INTEGER DEFAULT 0,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS banks (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT,
        name TEXT NOT NULL,
        accountNumber TEXT,
        balance REAL DEFAULT 0,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS salesmen (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT,
        name TEXT NOT NULL,
        phone TEXT,
        commissionRate REAL DEFAULT 0,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS vehicles (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT,
        name TEXT NOT NULL,
        plateNumber TEXT,
        type TEXT,
        warehouseId TEXT,
        warehouseName TEXT,
        salesmanId TEXT,
        salesmanName TEXT,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS vehicle_inventory (
        id TEXT PRIMARY KEY NOT NULL,
        vehicleId TEXT NOT NULL,
        vehicleName TEXT,
        productId TEXT NOT NULL,
        productName TEXT,
        productCode TEXT,
        quantity REAL DEFAULT 0,
        unit TEXT,
        lastUpdated TEXT,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS routes (
        id TEXT PRIMARY KEY NOT NULL,
        name TEXT NOT NULL,
        salesmanId TEXT,
        salesmanName TEXT,
        partnersJson TEXT,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS visits (
        id TEXT PRIMARY KEY NOT NULL,
        partnerId TEXT NOT NULL,
        partnerName TEXT,
        partnerAddress TEXT,
        partnerPhone TEXT,
        scheduledDate TEXT,
        status TEXT DEFAULT 'PENDING',
        notes TEXT,
        salesmanId TEXT,
        routeId TEXT,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS product_stocks (
        id TEXT PRIMARY KEY NOT NULL,
        productId TEXT NOT NULL,
        warehouseId TEXT NOT NULL,
        stock REAL DEFAULT 0,
        syncedAt TEXT NOT NULL,
        UNIQUE(productId, warehouseId)
    )`,`CREATE TABLE IF NOT EXISTS vehicle_operations (
        id TEXT PRIMARY KEY NOT NULL,
        vehicleId TEXT NOT NULL,
        vehicleName TEXT,
        operationType TEXT NOT NULL,
        date TEXT NOT NULL,
        warehouseId TEXT,
        warehouseName TEXT,
        notes TEXT,
        itemsJson TEXT,
        createdBy TEXT,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS visits (
        id TEXT PRIMARY KEY NOT NULL,
        vehicleId TEXT,
        vehicleName TEXT,
        salesmanId TEXT,
        salesmanName TEXT,
        customerId TEXT,
        customerName TEXT,
        visitDate TEXT NOT NULL,
        visitType TEXT DEFAULT 'UNPLANNED',
        result TEXT DEFAULT 'SALE',
        invoiceId TEXT,
        invoiceAmount REAL DEFAULT 0,
        paymentCollected REAL DEFAULT 0,
        paymentMethod TEXT,
        latitude REAL,
        longitude REAL,
        notes TEXT,
        duration INTEGER,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS vehicle_settlements (
        id TEXT PRIMARY KEY NOT NULL,
        vehicleId TEXT NOT NULL,
        vehicleName TEXT,
        settlementDate TEXT NOT NULL,
        salesmanId TEXT,
        salesmanName TEXT,
        totalCashSales REAL DEFAULT 0,
        totalCreditSales REAL DEFAULT 0,
        totalSales REAL DEFAULT 0,
        cashCollected REAL DEFAULT 0,
        totalCollections REAL DEFAULT 0,
        totalReturns REAL DEFAULT 0,
        openingInventoryValue REAL DEFAULT 0,
        closingInventoryValue REAL DEFAULT 0,
        expectedCash REAL DEFAULT 0,
        actualCash REAL DEFAULT 0,
        cashDifference REAL DEFAULT 0,
        status TEXT DEFAULT 'DRAFT',
        notes TEXT,
        approvedBy TEXT,
        approvedAt TEXT,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS vehicle_routes (
        id TEXT PRIMARY KEY NOT NULL,
        vehicleId TEXT NOT NULL,
        vehicleName TEXT,
        routeName TEXT NOT NULL,
        routeDate TEXT NOT NULL,
        status TEXT DEFAULT 'PLANNED',
        startTime TEXT,
        endTime TEXT,
        stopsCount INTEGER DEFAULT 0,
        completedStops INTEGER DEFAULT 0,
        stopsJson TEXT,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS pending_sync (
        id TEXT PRIMARY KEY NOT NULL,
        entity TEXT NOT NULL,
        operation TEXT NOT NULL,
        entityId TEXT,
        data TEXT NOT NULL,
        createdAt TEXT NOT NULL,
        status TEXT DEFAULT 'PENDING',
        retryCount INTEGER DEFAULT 0,
        lastError TEXT,
        nextRetryAt TEXT
    )`,`CREATE TABLE IF NOT EXISTS vehicle_stock (
        id TEXT PRIMARY KEY NOT NULL,
        vehicleId TEXT NOT NULL,
        productId TEXT NOT NULL,
        productName TEXT,
        quantity REAL DEFAULT 0,
        cost REAL DEFAULT 0,
        syncedAt TEXT
    )`,`CREATE TABLE IF NOT EXISTS customer_visits (
        id TEXT PRIMARY KEY NOT NULL,
        vehicleId TEXT NOT NULL,
        salesmanId TEXT,
        salesmanName TEXT,
        partnerId TEXT,
        partnerName TEXT,
        visitDate TEXT NOT NULL,
        visitType TEXT DEFAULT 'SALE',
        result TEXT DEFAULT 'PENDING',
        invoiceId TEXT,
        invoiceAmount REAL DEFAULT 0,
        paymentCollected REAL DEFAULT 0,
        paymentMethod TEXT,
        latitude REAL,
        longitude REAL,
        notes TEXT,
        duration INTEGER,
        syncedAt TEXT
    )`,`CREATE TABLE IF NOT EXISTS salesmen (
        id TEXT PRIMARY KEY NOT NULL,
        code TEXT,
        employeeName TEXT NOT NULL,
        phone TEXT,
        email TEXT,
        address TEXT,
        userId TEXT,
        userName TEXT,
        isActive INTEGER DEFAULT 1,
        syncedAt TEXT NOT NULL
    )`,`CREATE TABLE IF NOT EXISTS expenses (
        id TEXT PRIMARY KEY NOT NULL,
        category TEXT NOT NULL,
        amount REAL NOT NULL,
        description TEXT,
        date TEXT NOT NULL,
        vehicleId TEXT,
        salesmanId TEXT,
        salesmanName TEXT,
        settlementId TEXT,
        status TEXT DEFAULT 'PENDING',
        createdAt TEXT NOT NULL,
        syncedAt TEXT
    )`];class qo{constructor(){this.db=null,this.isInitialized=!1,this.initPromise=null,this.isAutoSyncRunning=!1,this.networkListenerHandle=null,this.syncDebounceTimer=null,this.sqlite=new _o(Uo)}isMobile(){try{return Ut.isNativePlatform()}catch{return!1}}getDb(){return this.db}async updateVehicleInventoryItem(e,s,n){this.db||await this.initialize(),this.db&&await this.db.run("UPDATE vehicle_inventory SET quantity = ?, syncedAt = '' WHERE vehicleId = ? AND productId = ?",[n,e,String(s)])}async addVehicleInventoryItem(e,s){if(this.db||await this.initialize(),!this.db)return;const n=`VS_${Date.now()}_${Math.random().toString(36).substr(2,6)}`;await this.db.run("INSERT INTO vehicle_inventory (id, vehicleId, productId, productName, quantity, syncedAt) VALUES (?, ?, ?, ?, ?, ?)",[n,e,s.productId,s.productName,s.quantity,""])}async upsertVehicleInventoryItem(e,s){if(this.db||await this.initialize(),!this.db)return;const n=await this.db.query("SELECT id FROM vehicle_inventory WHERE vehicleId = ? AND productId = ?",[e,String(s.productId)]);if(n?.values&&n.values.length>0)await this.db.run("UPDATE vehicle_inventory SET quantity = ?, productName = ?, syncedAt = '' WHERE vehicleId = ? AND productId = ?",[s.quantity,s.productName,e,String(s.productId)]);else{const a=`VS_${Date.now()}_${Math.random().toString(36).substr(2,6)}`;await this.db.run("INSERT INTO vehicle_inventory (id, vehicleId, productId, productName, quantity, syncedAt) VALUES (?, ?, ?, ?, ?, ?)",[a,e,String(s.productId),s.productName,s.quantity,""])}}async initialize(){return this.isMobile()?this.isInitialized?!0:this.initPromise?(await this.initPromise,this.isInitialized):(this.initPromise=this._doInitialize(),await this.initPromise,this.isInitialized):!1}async _doInitialize(){try{const e=await this.sqlite.checkConnectionsConsistency(),s=(await this.sqlite.isConnection(bs,!1)).result;e.result&&s?this.db=await this.sqlite.retrieveConnection(bs,!1):this.db=await this.sqlite.createConnection(bs,!1,"no-encryption",$o,!1),await this.db.open();for(const a of Mo)try{await this.db.execute(a)}catch(r){r.message?.includes("already exists")}try{await this.db.execute("DROP TABLE IF EXISTS visits"),await this.db.execute("DROP TABLE IF EXISTS customer_visits"),await this.db.execute(`
                    CREATE TABLE IF NOT EXISTS customer_visits (
                        id TEXT PRIMARY KEY NOT NULL,
                        vehicleId TEXT,
                        vehicleName TEXT,
                        salesmanId TEXT,
                        salesmanName TEXT,
                        partnerId TEXT,
                        partnerName TEXT,
                        visitDate TEXT NOT NULL,
                        visitType TEXT DEFAULT 'UNPLANNED',
                        result TEXT DEFAULT 'SALE',
                        invoiceId TEXT,
                        invoiceAmount REAL DEFAULT 0,
                        paymentCollected REAL DEFAULT 0,
                        paymentMethod TEXT,
                        latitude REAL,
                        longitude REAL,
                        notes TEXT,
                        duration INTEGER,
                        syncedAt TEXT
                    )
                `),await this.db.execute(`
                    CREATE TABLE IF NOT EXISTS vehicle_stock (
                        id TEXT PRIMARY KEY NOT NULL,
                        vehicleId TEXT NOT NULL,
                        productId TEXT NOT NULL,
                        productName TEXT,
                        quantity REAL DEFAULT 0,
                        cost REAL DEFAULT 0,
                        syncedAt TEXT
                    )
                `);try{await this.db.execute("ALTER TABLE partners ADD COLUMN salesmanId TEXT")}catch(a){a.message?.includes("duplicate column")}try{await this.db.execute("ALTER TABLE invoices ADD COLUMN previousBalance REAL"),await this.db.execute("ALTER TABLE invoices ADD COLUMN newBalance REAL")}catch{}try{await this.db.execute("ALTER TABLE invoices ADD COLUMN salesmanId TEXT"),await this.db.execute("ALTER TABLE invoices ADD COLUMN salesmanName TEXT"),await this.db.execute("ALTER TABLE invoices ADD COLUMN createdBy TEXT")}catch{}try{await this.db.execute("ALTER TABLE invoices ADD COLUMN discount REAL DEFAULT 0")}catch{}try{await this.db.execute("ALTER TABLE invoices ADD COLUMN globalDiscount REAL DEFAULT 0")}catch{}try{await this.db.execute("ALTER TABLE invoices ADD COLUMN createdAt TEXT")}catch{}}catch{}if(this.isInitialized=!0,!await this.verifyTables())throw new Error("Table verification failed")}catch(e){throw this.isInitialized=!1,e}}async verifyTables(){if(!this.db)return!1;try{const e=["products","partners","invoices","accounts"];for(const s of e){const n=await this.db.query("SELECT name FROM sqlite_master WHERE type='table' AND name=?",[s]);if(!n.values||n.values.length===0)return!1}return!0}catch{return!1}}async clearAllLocalData(){if(!(!this.db&&(await this.initialize(),!this.db)))try{await this.db.execute("DELETE FROM invoices"),await this.db.execute("DELETE FROM customer_visits"),await this.db.execute("DELETE FROM vehicle_settlements")}catch(e){throw e}}async getServerUrl(){const{value:e}=await Pt.get({key:Lt.SERVER_URL});return e||localStorage.getItem("erp_server_url")}async setServerUrl(e){await Pt.set({key:Lt.SERVER_URL,value:e}),localStorage.setItem("erp_server_url",e)}async getAuthToken(){const{value:e}=await Pt.get({key:Lt.AUTH_TOKEN});return e||localStorage.getItem("authToken")}async setAuthToken(e){await Pt.set({key:Lt.AUTH_TOKEN,value:e}),localStorage.setItem("authToken",e)}async downloadAllData(e){const s={products:0,partners:0,invoices:0,accounts:0,warehouses:0,vehicles:0,pendingPayments:0,lastSync:null};if(!this.isMobile())return{success:!0,message:"Not on mobile",stats:s};if(!await this.initialize()||!this.db)return{success:!1,message:"Database not initialized",stats:s};const a=await this.getServerUrl(),r=await this.getAuthToken();if(!a)return{success:!1,message:"Server URL not configured",stats:s};if(!r)return{success:!1,message:"Not authenticated",stats:s};const d={"Content-Type":"application/json",Authorization:`Bearer ${r}`},c=new Date().toISOString(),p={products:0,partners:0,invoices:0,accounts:0,warehouses:0,vehicles:0,pendingPayments:0,lastSync:c},y=[];let C=new Set;try{const P=await this.getPendingCount();P>0&&(e?.(`جاري رفع ${P} عمليات معلقة...`),await this.syncPendingOperations()),e?.("جاري مسح البيانات القديمة...");try{await this.db.execute("DELETE FROM invoices"),await this.db.execute("DELETE FROM customer_visits"),await this.db.execute("DELETE FROM vehicle_settlements")}catch{}try{const h=await fetch(`${a}/api/vehicles/settlements/approved`,{headers:d});if(h.ok){const J=(await h.json()).approvedSettlements||[];for(const se of J){const T=se.settlementDate?.slice(0,10);T&&C.add(T)}}}catch{}e?.("جاري تحميل البيانات الأساسية...");const N=async(h,k=3e4)=>{const J=new AbortController,se=setTimeout(()=>J.abort(),k);try{const T=await fetch(h,{headers:d,signal:J.signal});return clearTimeout(se),T}catch(T){throw clearTimeout(se),T}},m=Date.now(),[I,x,S,X]=await Promise.allSettled([N(`${a}/api/products`),N(`${a}/api/partners?includeRealBalance=true&limit=5000`),N(`${a}/api/accounts`),N(`${a}/api/product-stocks`)]);if(I.status==="fulfilled"&&I.value.ok){const h=await I.value.json(),k=Array.isArray(h)?h:h.products||[];await this.saveProducts(k,c),p.products=k.length}else I.status==="rejected"&&y.push(`Products: ${I.reason?.message||"Failed"}`);if(X.status==="fulfilled"&&X.value.ok){const h=await X.value.json();Array.isArray(h)&&await this.saveProductStocks(h,c)}else X.status==="rejected"&&y.push(`ProductStocks: ${X.reason?.message||"Failed"}`);if(x.status==="fulfilled"&&x.value.ok){const h=await x.value.json(),k=h.partners||(Array.isArray(h)?h:[]);await this.savePartners(k,c),p.partners=k.length}else x.status==="rejected"&&y.push(`Partners: ${x.reason?.message||"Failed"}`);e?.("جاري تحميل الفواتير...");try{const h=await fetch(`${a}/api/invoices?limit=500`,{headers:d});if(h.ok){const k=await h.json();let J=k.invoices||(Array.isArray(k)?k:[]);const se=J.length;J=J.filter(T=>{const D=T.date?.slice(0,10);return!C.has(D)}),await this.saveInvoices(J,c),p.invoices=J.length}}catch(h){y.push(`Invoices: ${h.message}`)}e?.("جاري تحميل الزيارات...");try{const h=await fetch(`${a}/api/vehicles/visits?limit=500`,{headers:d});if(h.ok){const k=await h.json();let J=Array.isArray(k)?k:k.visits||[];const se=J.length;J=J.filter(T=>{const D=(T.visitDate||T.date)?.slice(0,10);return!C.has(D)}),await this.saveVisits(J,c)}else await this.db.execute("DELETE FROM customer_visits WHERE syncedAt != '' AND syncedAt IS NOT NULL AND id NOT LIKE 'OFFLINE_%'")}catch(h){try{await this.db.execute("DELETE FROM customer_visits WHERE syncedAt != '' AND syncedAt IS NOT NULL AND id NOT LIKE 'OFFLINE_%'")}catch{}y.push(`Visits: ${h.message}`)}if(S.status==="fulfilled"&&S.value.ok){const h=await S.value.json();Array.isArray(h)&&(await this.saveAccounts(h,c),p.accounts=h.length)}else S.status==="rejected"&&y.push(`Accounts: ${S.reason?.message||"Failed"}`);e?.("جاري تحميل المناديب...");try{const h=await fetch(`${a}/api/master/salesmen`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveSalesmen(k,c)}}catch(h){y.push(`Salesmen: ${h.message}`)}e?.("جاري تحميل البيانات الإضافية...");const Y=Date.now(),[U,te,V,G,ie,ue]=await Promise.allSettled([N(`${a}/api/master/warehouses`),N(`${a}/api/master/branches`),N(`${a}/api/master/categories`),N(`${a}/api/price-lists`),N(`${a}/api/treasury/banks`),N(`${a}/api/master/salesmen`)]);if(U.status==="fulfilled"&&U.value.ok){const h=await U.value.json();Array.isArray(h)&&(await this.saveWarehouses(h,c),p.warehouses=h.length)}else U.status==="rejected"&&y.push(`Warehouses: ${U.reason?.message||"Failed"}`);if(te.status==="fulfilled"&&te.value.ok){const h=await te.value.json();Array.isArray(h)&&await this.saveBranches(h,c)}else te.status==="rejected"&&y.push(`Branches: ${te.reason?.message||"Failed"}`);if(V.status==="fulfilled"&&V.value.ok){const h=await V.value.json(),k=Array.isArray(h)?h:h.categories||[];await this.saveCategories(k,c)}else V.status==="rejected"&&y.push(`Categories: ${V.reason?.message||"Failed"}`);if(G.status==="fulfilled"&&G.value.ok){const h=await G.value.json();Array.isArray(h)&&await this.savePriceLists(h,c)}else G.status==="rejected"&&y.push(`PriceLists: ${G.reason?.message||"Failed"}`);if(ie.status==="fulfilled"&&ie.value.ok){const h=await ie.value.json();Array.isArray(h)&&await this.saveBanks(h,c)}else ie.status==="rejected"&&y.push(`Banks: ${ie.reason?.message||"Failed"}`);if(ue.status==="fulfilled"&&ue.value.ok){const h=await ue.value.json();Array.isArray(h)&&await this.saveSalesmen(h,c)}else ue.status==="rejected"&&y.push(`Salesmen: ${ue.reason?.message||"Failed"}`);e?.("جاري تحميل السيارات...");try{const h=await fetch(`${a}/api/vehicles`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveVehicles(k,c)}}catch(h){y.push(`Vehicles: ${h.message}`)}e?.("جاري تحميل محتويات السيارة...");try{const h=await fetch(`${a}/api/vehicles/inventory`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveVehicleInventory(k,c)}}catch(h){y.push(`VehicleInventory: ${h.message}`)}e?.("جاري تحميل خط السير...");try{const h=await fetch(`${a}/api/vehicles/routes`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveRoutes(k,c)}}catch(h){y.push(`Routes: ${h.message}`)}e?.("جاري تحميل الزيارات...");try{const h=await fetch(`${a}/api/vehicles/visits`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveVisits(k,c)}}catch(h){y.push(`Visits: ${h.message}`)}e?.("جاري تحميل عمليات السيارات...");try{const h=await fetch(`${a}/api/vehicles/operations?limit=200`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveVehicleOperations(k,c)}}catch(h){y.push(`VehicleOperations: ${h.message}`)}e?.("جاري تحميل زيارات العملاء...");try{const h=await fetch(`${a}/api/vehicles/customer-visits?limit=200`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveCustomerVisitsFromServer(k,c)}}catch{}e?.("جاري تحميل التسويات...");try{const h=await fetch(`${a}/api/vehicles/settlements?limit=100`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveSettlementsFromServer(k,c)}}catch{}e?.("جاري تحميل خطوط السير...");try{const h=await fetch(`${a}/api/vehicles/salesman-routes?limit=50`,{headers:d});if(h.ok){const k=await h.json();Array.isArray(k)&&await this.saveVehicleRoutesFromServer(k,c)}}catch{}if(await Pt.set({key:Lt.LAST_SYNC,value:c}),p.lastSync=c,y.length>0)return{success:!1,message:`Errors: ${y.join(", ")}`,stats:p};e?.("جاري التحقق من التسويات المعتمدة...");try{(await this.checkAndClearApprovedSettlements()).cleared}catch{}return{success:!0,message:"تم تحميل جميع البيانات الأساسية بنجاح",stats:p}}catch(P){return{success:!1,message:`Error: ${P.message}`,stats:p}}}async saveProducts(e,s){if(!this.db||e.length===0)return;const n=Date.now();try{const a=[];a.push({statement:"DELETE FROM products;"});const r=`INSERT OR REPLACE INTO products 
                 (id, sku, barcode, name, price, cost, stock, categoryId, categoryName, unit, image, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);`;for(const c of e)a.push({statement:r,values:[String(c.id),c.sku||null,c.barcode||null,c.name||"",parseFloat(c.price)||0,parseFloat(c.cost)||0,parseFloat(c.stock)||0,c.categoryId?String(c.categoryId):null,c.categoryName||null,c.unit||null,c.image||null,c.isActive!==!1?1:0,s]});await this.db.executeTransaction(a);const d=Date.now()-n}catch{await this.db.execute("DELETE FROM products");for(const r of e)await this.db.run(`INSERT OR REPLACE INTO products 
                     (id, sku, barcode, name, price, cost, stock, categoryId, categoryName, unit, image, isActive, syncedAt)
                     VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(r.id),r.sku||null,r.barcode||null,r.name||"",parseFloat(r.price)||0,parseFloat(r.cost)||0,parseFloat(r.stock)||0,r.categoryId?String(r.categoryId):null,r.categoryName||null,r.unit||null,r.image||null,r.isActive!==!1?1:0,s])}}async savePartners(e,s){if(!(!this.db||e.length===0))try{const n=[];n.push({statement:"DELETE FROM partners;"});const a=`INSERT OR REPLACE INTO partners 
                 (id, code, name, phone, email, address, type, isCustomer, isSupplier, balance, salesmanId, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);`;for(const r of e)n.push({statement:a,values:[String(r.id),r.code||null,r.name||"",r.phone||null,r.email||null,r.address||null,r.type||"CUSTOMER",r.isCustomer||r.type==="CUSTOMER"||r.type==="BOTH"?1:0,r.isSupplier||r.type==="SUPPLIER"||r.type==="BOTH"?1:0,parseFloat(r.balance)||0,r.salesmanId||null,s]});await this.db.executeTransaction(n)}catch{await this.db.execute("DELETE FROM partners");for(const a of e)await this.db.run(`INSERT OR REPLACE INTO partners 
                     (id, code, name, phone, email, address, type, isCustomer, isSupplier, balance, salesmanId, syncedAt)
                     VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(a.id),a.code||null,a.name||"",a.phone||null,a.email||null,a.address||null,a.type||"CUSTOMER",a.isCustomer||a.type==="CUSTOMER"||a.type==="BOTH"?1:0,a.isSupplier||a.type==="SUPPLIER"||a.type==="BOTH"?1:0,parseFloat(a.balance)||0,a.salesmanId||null,s])}}async updatePartnerBalance(e,s,n){if(this.db)try{const a=Number(s)-Number(n);await this.db.run("UPDATE partners SET balance = balance + ? WHERE id = ?",[a,String(e)])}catch(a){throw a}}async saveInvoices(e,s){if(!(!this.db||e.length===0))for(const n of e){const a=await this.db.query("SELECT id FROM invoices WHERE id = ? AND (syncedAt = '' OR syncedAt IS NULL OR id LIKE 'OFFLINE_%')",[String(n.id)]);if(a.values&&a.values.length>0)continue;let r=null;n.lines&&Array.isArray(n.lines)&&n.lines.length>0&&(r=JSON.stringify(n.lines)),await this.db.run(`INSERT OR REPLACE INTO invoices 
                 (id, number, date, type, status, partnerId, partnerName, total, discount, globalDiscount, paidAmount, previousBalance, newBalance, paymentMethod, salesmanId, salesmanName, createdBy, createdAt, linesJson, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.number||null,n.date||new Date().toISOString(),n.type||"SALE",n.status||"DRAFT",n.partnerId?String(n.partnerId):null,n.partnerName||n.partner?.name||null,parseFloat(n.total)||0,parseFloat(n.discount)||0,parseFloat(n.globalDiscount)||0,parseFloat(n.paidAmount)||0,n.previousBalance!=null?parseFloat(n.previousBalance):null,n.newBalance!=null?parseFloat(n.newBalance):null,n.paymentMethod||null,n.salesmanId||null,n.salesmanName||null,n.createdBy||null,n.createdAt||null,r,s])}}async saveAccounts(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM accounts");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO accounts 
                 (id, code, name, type, balance, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?)`,[String(n.id),n.code||"",n.name||"",n.type||"ASSET",parseFloat(n.balance)||0,s])}}async saveWarehouses(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM warehouses");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO warehouses 
                 (id, code, name, type, location, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.code||null,n.name||"",n.type||"MAIN",n.location||null,n.isActive!==!1?1:0,s])}}async saveProductStocks(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM product_stocks");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO product_stocks 
                 (id, productId, warehouseId, stock, syncedAt)
                 VALUES (?, ?, ?, ?, ?)`,[String(n.id),String(n.productId),String(n.warehouseId),parseFloat(n.stock)||0,s])}}async saveBranches(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM branches");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO branches 
                 (id, code, name, address, phone, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.code||null,n.name||"",n.address||null,n.phone||null,n.isActive!==!1?1:0,s])}}async saveCategories(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM categories");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO categories 
                 (id, code, name, parentId, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?)`,[String(n.id),n.code||null,n.name||"",n.parentId||null,n.isActive!==!1?1:0,s])}}async savePriceLists(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM priceLists");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO priceLists 
                 (id, name, type, isDefault, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?)`,[String(n.id),n.name||"",n.type||null,n.isDefault?1:0,n.isActive!==!1?1:0,s])}}async saveBanks(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM banks");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO banks 
                 (id, code, name, accountNumber, balance, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.code||null,n.name||"",n.accountNumber||null,parseFloat(n.balance)||0,n.isActive!==!1?1:0,s])}}async saveSalesmen(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM salesmen");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO salesmen 
                 (id, code, name, phone, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?)`,[String(n.id),n.code||null,n.employeeName||n.name||"",n.phone||null,n.isActive!==!1?1:0,s])}}async saveRoutes(e,s){if(!(!this.db||e.length===0)){await this.db.execute('DELETE FROM routes WHERE syncedAt != ""');for(const n of e){let a=null;n.stops&&Array.isArray(n.stops)?a=JSON.stringify(n.stops):n.partners&&Array.isArray(n.partners)&&(a=JSON.stringify(n.partners.map(r=>({id:r.id,customerId:r.partnerId||r.id,customerName:r.partnerName||r.name,address:r.address,phone:r.phone,sequence:r.sequence||0})))),await this.db.run(`INSERT OR REPLACE INTO routes 
                 (id, name, salesmanId, salesmanName, partnersJson, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.name||n.routeName||`خط سير ${n.id}`,n.salesmanId||null,n.salesmanName||null,a,n.isActive!==!1?1:0,s])}}}async saveVehicles(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM vehicles");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO vehicles 
                 (id, code, name, plateNumber, type, warehouseId, warehouseName, salesmanId, salesmanName, isActive, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.code||null,n.name||"",n.plateNumber||null,n.type||"VAN",n.warehouseId||null,n.warehouse?.name||n.warehouseName||null,n.salesmanId||null,n.salesman?.name||n.salesmanName||null,n.isActive!==!1?1:0,s])}}async saveVehicleInventory(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM vehicle_inventory");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO vehicle_inventory 
                 (id, vehicleId, vehicleName, productId, productName, productCode, quantity, unit, lastUpdated, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(n.id||`${n.vehicleId}_${n.productId}`),n.vehicleId||"",n.vehicleName||n.vehicle?.name||"",n.productId||"",n.productName||n.product?.name||"",n.productCode||n.product?.code||"",parseFloat(n.quantity)||0,n.unit||"قطعة",n.lastUpdated||new Date().toISOString(),s])}}async saveVisits(e,s){if(!(!this.db||e.length===0))for(const n of e)await this.db.run(`INSERT OR REPLACE INTO customer_visits 
                 (id, vehicleId, partnerId, partnerName, visitDate, visitType, result,
                  invoiceId, invoiceAmount, paymentCollected, notes, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.vehicleId||"",n.partnerId||n.customerId||"",n.partnerName||n.customerName||"",n.visitDate||n.scheduledDate||new Date().toISOString(),n.visitType||"UNPLANNED",n.result||n.status||"NO_SALE",n.invoiceId||null,n.invoiceAmount||0,n.paymentCollected||0,n.notes||null,s])}async saveVehicleOperations(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM vehicle_operations WHERE syncedAt != '' AND syncedAt IS NOT NULL AND id NOT LIKE 'OFFLINE_%'");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO vehicle_operations 
                 (id, vehicleId, vehicleName, operationType, date, warehouseId, warehouseName, notes, itemsJson, createdBy, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.vehicleId||"",n.vehicleName||n.vehicle?.name||"",n.operationType||n.type||"LOAD",n.date||new Date().toISOString(),n.warehouseId||null,n.warehouseName||n.warehouse?.name||null,n.notes||null,n.items?JSON.stringify(n.items):null,n.createdBy||null,s])}}async saveCustomerVisitsFromServer(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM customer_visits WHERE syncedAt != '' AND syncedAt IS NOT NULL AND id NOT LIKE 'OFFLINE_%'");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO customer_visits 
                 (id, vehicleId, vehicleName, salesmanId, salesmanName, customerId, customerName, 
                  visitDate, visitType, result, invoiceId, invoiceAmount, paymentCollected, 
                  paymentMethod, latitude, longitude, notes, duration, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.vehicleId||null,n.vehicleName||n.vehicle?.name||null,n.salesmanId||null,n.salesmanName||n.salesman?.name||null,n.customerId||n.partnerId||null,n.customerName||n.partnerName||n.customer?.name||null,n.visitDate||new Date().toISOString(),n.visitType||"UNPLANNED",n.result||"SALE",n.invoiceId||null,parseFloat(n.invoiceAmount)||0,parseFloat(n.paymentCollected)||0,n.paymentMethod||null,n.latitude||null,n.longitude||null,n.notes||null,n.duration||null,s])}}async saveSettlementsFromServer(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM vehicle_settlements WHERE syncedAt != '' AND syncedAt IS NOT NULL AND id NOT LIKE 'OFFLINE_%'");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO vehicle_settlements 
                 (id, vehicleId, vehicleName, settlementDate, salesmanId, salesmanName,
                  totalCashSales, totalCreditSales, totalSales, cashCollected, totalCollections,
                  totalReturns, openingInventoryValue, closingInventoryValue, expectedCash,
                  actualCash, cashDifference, status, notes, approvedBy, approvedAt, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.vehicleId||"",n.vehicleName||n.vehicle?.name||null,n.settlementDate||new Date().toISOString(),n.salesmanId||null,n.salesmanName||n.salesman?.name||null,parseFloat(n.totalCashSales)||0,parseFloat(n.totalCreditSales)||0,parseFloat(n.totalSales)||0,parseFloat(n.cashCollected)||0,parseFloat(n.totalCollections)||0,parseFloat(n.totalReturns)||0,parseFloat(n.openingInventoryValue)||0,parseFloat(n.closingInventoryValue)||0,parseFloat(n.expectedCash)||0,parseFloat(n.actualCash)||0,parseFloat(n.cashDifference)||0,n.status||"DRAFT",n.notes||null,n.approvedBy||null,n.approvedAt||null,s])}}async saveVehicleRoutesFromServer(e,s){if(!(!this.db||e.length===0)){await this.db.execute("DELETE FROM vehicle_routes WHERE syncedAt != '' AND syncedAt IS NOT NULL AND id NOT LIKE 'OFFLINE_%'");for(const n of e)await this.db.run(`INSERT OR REPLACE INTO vehicle_routes 
                 (id, vehicleId, vehicleName, routeName, routeDate, status, startTime, endTime,
                  stopsCount, completedStops, stopsJson, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[String(n.id),n.vehicleId||"",n.vehicleName||n.vehicle?.name||null,n.routeName||n.name||"",n.routeDate||n.date||new Date().toISOString(),n.status||"PLANNED",n.startTime||null,n.endTime||null,n.stopsCount||n.stops?.length||0,n.completedStops||0,n.stops?JSON.stringify(n.stops):null,s])}}async getProducts(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM products ORDER BY name")).values||[]).map(s=>({id:s.id,sku:s.sku,barcode:s.barcode,name:s.name,price:s.price||0,cost:s.cost||0,stock:s.stock||0,categoryId:s.categoryId,categoryName:s.categoryName,unit:s.unit,image:s.image,isActive:s.isActive===1}))}catch{return[]}}async searchProducts(e,s=20){if(this.db||await this.initialize(),!this.db)return[];try{const n=`%${e}%`;return((await this.db.query(`SELECT * FROM products 
                 WHERE name LIKE ? OR sku LIKE ? OR barcode LIKE ?
                 ORDER BY name LIMIT ?`,[n,n,n,s])).values||[]).map(r=>({id:r.id,sku:r.sku,barcode:r.barcode,name:r.name,price:r.price||0,cost:r.cost||0,stock:r.stock||0,categoryId:r.categoryId,categoryName:r.categoryName,unit:r.unit,image:r.image,isActive:r.isActive===1}))}catch{return[]}}async getPartners(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM partners ORDER BY name")).values||[]).map(s=>({id:s.id,code:s.code,name:s.name,phone:s.phone,email:s.email,address:s.address,type:s.type,isCustomer:s.isCustomer===1,isSupplier:s.isSupplier===1,balance:s.balance||0,salesmanId:s.salesmanId||null}))}catch{return[]}}async getPartner(e){if(this.db||await this.initialize(),!this.db)return null;try{const n=(await this.db.query("SELECT * FROM partners WHERE id = ?",[e])).values||[];if(n.length===0)return null;const a=n[0];return{id:a.id,code:a.code,name:a.name,phone:a.phone,email:a.email,address:a.address,type:a.type,isCustomer:a.isCustomer===1,isSupplier:a.isSupplier===1,balance:a.balance||0,salesmanId:a.salesmanId||null}}catch{return null}}async getInvoices(e){if(this.db||await this.initialize(),!this.db)return[];try{let s="SELECT * FROM invoices";const n=[],a=[];return e?.type&&(a.push("type = ?"),n.push(e.type)),e?.partnerId&&(a.push("partnerId = ?"),n.push(e.partnerId)),e?.date&&(a.push("date LIKE ?"),n.push(`${e.date}%`)),e?.status&&(a.push("status = ?"),n.push(e.status)),a.length>0&&(s+=" WHERE "+a.join(" AND ")),s+=" ORDER BY date DESC",((await this.db.query(s,n)).values||[]).map(d=>({id:d.id,number:d.number,date:d.date,type:d.type,status:d.status,partnerId:d.partnerId,partnerName:d.partnerName,total:d.total||0,discount:d.discount||0,paidAmount:d.paidAmount||0,previousBalance:d.previousBalance,newBalance:d.newBalance,paymentMethod:d.paymentMethod,salesmanId:d.salesmanId,salesmanName:d.salesmanName,createdBy:d.createdBy,createdAt:d.createdAt,linesJson:d.linesJson||null,lines:d.linesJson?JSON.parse(d.linesJson):[],syncedAt:d.syncedAt}))}catch{return[]}}async getInvoice(e){if(this.db||await this.initialize(),!this.db)return null;try{const s=await this.db.query("SELECT * FROM invoices WHERE id = ?",[e]);if(!s.values||s.values.length===0)return null;const n=s.values[0];let a=[];if(n.linesJson)try{a=JSON.parse(n.linesJson)}catch{}return{id:n.id,number:n.number,date:n.date,type:n.type,status:n.status,partnerId:n.partnerId,partnerName:n.partnerName,warehouseId:n.warehouseId,paymentMethod:n.paymentMethod,total:parseFloat(n.total)||0,paidAmount:parseFloat(n.paidAmount)||0,lines:a}}catch{return null}}async getAccounts(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM accounts ORDER BY code")).values||[]).map(s=>({id:s.id,code:s.code,name:s.name,type:s.type,balance:s.balance||0}))}catch{return[]}}async getWarehouses(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM warehouses WHERE isActive = 1 ORDER BY name")).values||[]).map(s=>({id:s.id,code:s.code,name:s.name,type:s.type,location:s.location,isActive:s.isActive===1}))}catch{return[]}}async getBranches(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM branches WHERE isActive = 1 ORDER BY name")).values||[]).map(s=>({id:s.id,code:s.code,name:s.name,address:s.address,phone:s.phone,isActive:s.isActive===1}))}catch{return[]}}async getCategories(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM categories WHERE isActive = 1 ORDER BY name")).values||[]).map(s=>({id:s.id,code:s.code,name:s.name,parentId:s.parentId,isActive:s.isActive===1}))}catch{return[]}}async getPriceLists(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM priceLists WHERE isActive = 1 ORDER BY name")).values||[]).map(s=>({id:s.id,name:s.name,type:s.type,isDefault:s.isDefault===1,isActive:s.isActive===1}))}catch{return[]}}async getBanks(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM banks WHERE isActive = 1 ORDER BY name")).values||[]).map(s=>({id:s.id,code:s.code,name:s.name,accountNumber:s.accountNumber,balance:s.balance||0,isActive:s.isActive===1}))}catch{return[]}}async getSalesmen(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM salesmen WHERE isActive = 1 ORDER BY name")).values||[]).map(s=>({id:s.id,code:s.code,name:s.name||"",phone:s.phone,isActive:s.isActive===1}))}catch{return[]}}async getRoutes(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM routes WHERE isActive = 1 ORDER BY name")).values||[]).map(s=>({id:s.id,name:s.name,salesmanId:s.salesmanId,salesmanName:s.salesmanName,partners:s.partnersJson?JSON.parse(s.partnersJson):[],isActive:s.isActive===1}))}catch{return[]}}async getVisits(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM visits ORDER BY scheduledDate")).values||[]).map(s=>({id:s.id,partnerId:s.partnerId,partnerName:s.partnerName,partnerAddress:s.partnerAddress,partnerPhone:s.partnerPhone,scheduledDate:s.scheduledDate,status:s.status,notes:s.notes}))}catch{return[]}}async getVehicles(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM vehicles WHERE isActive = 1 ORDER BY name")).values||[]).map(s=>({id:s.id,code:s.code,name:s.name,plateNumber:s.plateNumber,warehouseId:s.warehouseId,warehouseName:s.warehouseName,salesmanId:s.salesmanId,salesmanName:s.salesmanName,isActive:s.isActive===1}))}catch{return[]}}async getProductStock(e,s){if(this.db||await this.initialize(),!this.db)return 0;try{let n="SELECT stock FROM product_stocks WHERE productId = ?";const a=[e];s&&(n+=" AND warehouseId = ?",a.push(s));const r=await this.db.query(n,a);return r.values&&r.values.length>0?r.values.reduce((c,p)=>c+(parseFloat(p.stock)||0),0):0}catch{return 0}}async getWarehouseStocks(e){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT productId, stock FROM product_stocks WHERE warehouseId = ?",[e])).values||[]).map(n=>({productId:n.productId,stock:parseFloat(n.stock)||0}))}catch{return[]}}async getStats(){this.db||await this.initialize();const e={products:0,partners:0,invoices:0,accounts:0,warehouses:0,vehicles:0,pendingPayments:0,lastSync:null};if(!this.db)return e;try{const[s]=(await this.db.query("SELECT COUNT(*) as count FROM products")).values||[{count:0}],[n]=(await this.db.query("SELECT COUNT(*) as count FROM partners")).values||[{count:0}],[a]=(await this.db.query("SELECT COUNT(*) as count FROM invoices")).values||[{count:0}],[r]=(await this.db.query("SELECT COUNT(*) as count FROM accounts")).values||[{count:0}],[d]=(await this.db.query("SELECT COUNT(*) as count FROM warehouses")).values||[{count:0}],[c]=(await this.db.query("SELECT COUNT(*) as count FROM payments WHERE status = 'PENDING'")).values||[{count:0}],[p]=(await this.db.query("SELECT COUNT(*) as count FROM vehicles")).values||[{count:0}],{value:y}=await Pt.get({key:Lt.LAST_SYNC});return{products:s?.count||0,partners:n?.count||0,invoices:a?.count||0,accounts:r?.count||0,warehouses:d?.count||0,vehicles:p?.count||0,pendingPayments:c?.count||0,lastSync:y}}catch{return e}}async clearAll(){if(this.db)try{await this.db.execute("DELETE FROM products"),await this.db.execute("DELETE FROM partners"),await this.db.execute("DELETE FROM invoices"),await this.db.execute("DELETE FROM accounts"),await this.db.execute("DELETE FROM warehouses"),await this.db.execute("DELETE FROM payments"),await this.db.execute("DELETE FROM branches"),await this.db.execute("DELETE FROM categories"),await this.db.execute("DELETE FROM priceLists"),await this.db.execute("DELETE FROM banks"),await this.db.execute("DELETE FROM salesmen"),await this.db.execute("DELETE FROM vehicle_inventory"),await this.db.execute("DELETE FROM routes"),await this.db.execute("DELETE FROM customer_visits"),await this.db.execute("DELETE FROM pending_sync"),await Pt.remove({key:Lt.LAST_SYNC})}catch{}}async getOperations(e,s=100){if(this.db||await this.initialize(),!this.db)return[];try{let n="SELECT * FROM vehicle_operations";const a=[];return e&&(n+=" WHERE vehicleId = ?",a.push(e)),n+=` ORDER BY date DESC LIMIT ${s}`,((await this.db.query(n,a)).values||[]).map(d=>({id:d.id,vehicleId:d.vehicleId,vehicleName:d.vehicleName,operationType:d.operationType,date:d.date,warehouseId:d.warehouseId,warehouseName:d.warehouseName,notes:d.notes,items:d.itemsJson?JSON.parse(d.itemsJson):[],syncedAt:d.syncedAt}))}catch{return[]}}async getCustomerVisits(e){if(this.db||await this.initialize(),!this.db)return[];try{let s="SELECT * FROM customer_visits WHERE 1=1";const n=[];return e?.vehicleId&&(s+=" AND vehicleId = ?",n.push(e.vehicleId)),e?.salesmanId&&(s+=" AND salesmanId = ?",n.push(e.salesmanId)),e?.date&&(s+=" AND date(visitDate) = date(?)",n.push(e.date)),s+=` ORDER BY visitDate DESC LIMIT ${e?.limit||100}`,((await this.db.query(s,n)).values||[]).map(r=>({id:r.id,vehicleId:r.vehicleId,vehicleName:r.vehicleName,salesmanId:r.salesmanId,salesmanName:r.salesmanName,customerId:r.customerId,customerName:r.customerName,visitDate:r.visitDate,visitType:r.visitType,result:r.result,invoiceId:r.invoiceId,invoiceAmount:parseFloat(r.invoiceAmount)||0,paymentCollected:parseFloat(r.paymentCollected)||0,paymentMethod:r.paymentMethod,notes:r.notes,syncedAt:r.syncedAt}))}catch{return[]}}async saveCustomerVisit(e){if(this.db||await this.initialize(),!this.db)return;const s=new Date().toISOString();await this.db.run(`INSERT OR REPLACE INTO customer_visits 
             (id, vehicleId, vehicleName, salesmanId, salesmanName, customerId, customerName, 
              visitDate, visitType, result, invoiceId, invoiceAmount, paymentCollected, 
              paymentMethod, latitude, longitude, notes, duration, syncedAt)
             VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[e.id,e.vehicleId||null,e.vehicleName||null,e.salesmanId||null,e.salesmanName||null,e.customerId||null,e.customerName||null,e.visitDate||s,e.visitType||"UNPLANNED",e.result||"SALE",e.invoiceId||null,parseFloat(e.invoiceAmount)||0,parseFloat(e.paymentCollected)||0,e.paymentMethod||null,e.latitude||null,e.longitude||null,e.notes||null,e.duration||null,""])}async updateCustomerVisit(e,s){if(this.db||await this.initialize(),!this.db)return;const n=[],a=[];s.result!==void 0&&(n.push("result = ?"),a.push(s.result)),s.invoiceId!==void 0&&(n.push("invoiceId = ?"),a.push(s.invoiceId)),s.invoiceAmount!==void 0&&(n.push("invoiceAmount = ?"),a.push(s.invoiceAmount)),s.paymentCollected!==void 0&&(n.push("paymentCollected = ?"),a.push(s.paymentCollected)),s.paymentMethod!==void 0&&(n.push("paymentMethod = ?"),a.push(s.paymentMethod)),s.notes!==void 0&&(n.push("notes = ?"),a.push(s.notes)),n.length!==0&&(a.push(e),await this.db.run(`UPDATE customer_visits SET ${n.join(", ")} WHERE id = ?`,a))}async getSettlements(e){if(this.db||await this.initialize(),!this.db)return[];try{let s="SELECT * FROM vehicle_settlements";const n=[];return e&&(s+=" WHERE vehicleId = ?",n.push(e)),s+=" ORDER BY settlementDate DESC",((await this.db.query(s,n)).values||[]).map(r=>({id:r.id,vehicleId:r.vehicleId,vehicleName:r.vehicleName,settlementDate:r.settlementDate,salesmanId:r.salesmanId,salesmanName:r.salesmanName,totalCashSales:parseFloat(r.totalCashSales)||0,totalCreditSales:parseFloat(r.totalCreditSales)||0,totalSales:parseFloat(r.totalSales)||0,cashCollected:parseFloat(r.cashCollected)||0,totalCollections:parseFloat(r.totalCollections)||0,totalReturns:parseFloat(r.totalReturns)||0,closingInventoryValue:parseFloat(r.closingInventoryValue)||0,expectedCash:parseFloat(r.expectedCash)||0,actualCash:parseFloat(r.actualCash)||0,cashDifference:parseFloat(r.cashDifference)||0,status:r.status,notes:r.notes,approvedBy:r.approvedBy,approvedAt:r.approvedAt,syncedAt:r.syncedAt}))}catch{return[]}}async saveSettlement(e){this.db||await this.initialize(),this.db&&await this.db.run(`INSERT OR REPLACE INTO vehicle_settlements 
             (id, vehicleId, vehicleName, settlementDate, salesmanId, salesmanName,
              totalCashSales, totalCreditSales, totalSales, cashCollected, totalCollections,
              totalReturns, openingInventoryValue, closingInventoryValue, expectedCash,
              actualCash, cashDifference, status, notes, syncedAt)
             VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[e.id,e.vehicleId,e.vehicleName||null,e.settlementDate,e.salesmanId||null,e.salesmanName||null,e.totalCashSales||0,e.totalCreditSales||0,e.totalSales||0,e.cashCollected||0,e.totalCollections||0,e.totalReturns||0,e.openingInventoryValue||0,e.closingInventoryValue||0,e.expectedCash||0,e.actualCash||0,e.cashDifference||0,e.status||"DRAFT",e.notes||null,""])}async getVehicleRoutes(e){if(this.db||await this.initialize(),!this.db)return[];try{let s="SELECT * FROM vehicle_routes WHERE 1=1";const n=[];return e?.vehicleId&&(s+=" AND vehicleId = ?",n.push(e.vehicleId)),e?.date&&(s+=" AND date(routeDate) = date(?)",n.push(e.date)),s+=" ORDER BY routeDate DESC",((await this.db.query(s,n)).values||[]).map(r=>({id:r.id,vehicleId:r.vehicleId,vehicleName:r.vehicleName,routeName:r.routeName,routeDate:r.routeDate,status:r.status,stopsCount:r.stopsCount,completedStops:r.completedStops,stops:r.stopsJson?JSON.parse(r.stopsJson):[],syncedAt:r.syncedAt}))}catch{return[]}}async getVehicleRoute(e){if(this.db||await this.initialize(),!this.db)return null;try{const s=await this.db.query("SELECT * FROM vehicle_routes WHERE id = ?",[e]);if(!s.values||s.values.length===0)return null;const n=s.values[0];return{id:n.id,vehicleId:n.vehicleId,vehicleName:n.vehicleName,routeName:n.routeName,routeDate:n.routeDate,status:n.status,startTime:n.startTime,endTime:n.endTime,stopsCount:n.stopsCount,completedStops:n.completedStops,stops:n.stopsJson?JSON.parse(n.stopsJson):[],syncedAt:n.syncedAt}}catch{return null}}async saveVehicleRoute(e){if(this.db||await this.initialize(),!this.db)return;const s=e.stops?JSON.stringify(e.stops):null;await this.db.run(`INSERT OR REPLACE INTO vehicle_routes 
             (id, vehicleId, vehicleName, routeName, routeDate, status, startTime, endTime,
              stopsCount, completedStops, stopsJson, syncedAt)
             VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[e.id,e.vehicleId,e.vehicleName||null,e.routeName,e.routeDate,e.status||"PLANNED",e.startTime||null,e.endTime||null,e.stopsCount||e.stops?.length||0,e.completedStops||0,s,""])}async updateVehicleRoute(e,s){if(this.db||await this.initialize(),!this.db)return;const n=[],a=[];s.status!==void 0&&(n.push("status = ?"),a.push(s.status)),s.startTime!==void 0&&(n.push("startTime = ?"),a.push(s.startTime)),s.endTime!==void 0&&(n.push("endTime = ?"),a.push(s.endTime)),s.completedStops!==void 0&&(n.push("completedStops = ?"),a.push(s.completedStops)),s.stops!==void 0&&(n.push("stopsJson = ?"),a.push(JSON.stringify(s.stops))),n.length!==0&&(a.push(e),await this.db.run(`UPDATE vehicle_routes SET ${n.join(", ")} WHERE id = ?`,a))}async updateRouteStop(e,s,n){const a=await this.getVehicleRoute(e);if(!a||!a.stops)return;const r=a.stops.map(c=>c.id===s?{...c,...n}:c),d=r.filter(c=>c.status==="VISITED").length;await this.updateVehicleRoute(e,{stops:r,completedStops:d})}async getVehicleInventory(e){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query(`SELECT vi.*, p.price as unitPrice, p.cost
                 FROM vehicle_inventory vi
                 LEFT JOIN products p ON vi.productId = p.id
                 WHERE vi.vehicleId = ? AND vi.quantity > 0
                 ORDER BY vi.productName`,[e])).values||[]).map(a=>({id:a.id,vehicleId:a.vehicleId,productId:a.productId,productName:a.productName,productCode:a.productCode,quantity:a.quantity||0,unit:a.unit,unitPrice:a.unitPrice||0,cost:a.cost||0}))}catch{return[]}}async updateVehicleInventory(e,s,n){if(this.db||await this.initialize(),!!this.db)try{const a=await this.db.query("SELECT quantity FROM vehicle_inventory WHERE vehicleId = ? AND productId = ?",[e,s]);if(a.values&&a.values.length>0){const r=a.values[0].quantity||0,d=Math.max(0,r+n);await this.db.run(`UPDATE vehicle_inventory 
                     SET quantity = ?, lastUpdated = ? 
                     WHERE vehicleId = ? AND productId = ?`,[d,new Date().toISOString(),e,s])}}catch(a){throw a}}async getVanSalesStats(){if(this.db||await this.initialize(),!this.db)return{vehicles:0,vehicleInventory:0,operations:0,visits:0,settlements:0,routes:0};try{const[e]=(await this.db.query("SELECT COUNT(*) as count FROM vehicles")).values||[{count:0}],[s]=(await this.db.query("SELECT COUNT(*) as count FROM vehicle_inventory")).values||[{count:0}];let n=0,a=0,r=0,d=0;try{n=(await this.db.query("SELECT COUNT(*) as count FROM vehicle_operations")).values?.[0]?.count||0}catch{}try{a=(await this.db.query("SELECT COUNT(*) as count FROM customer_visits")).values?.[0]?.count||0}catch{}try{r=(await this.db.query("SELECT COUNT(*) as count FROM vehicle_settlements")).values?.[0]?.count||0}catch{}try{d=(await this.db.query("SELECT COUNT(*) as count FROM vehicle_routes")).values?.[0]?.count||0}catch{}return{vehicles:e?.count||0,vehicleInventory:s?.count||0,operations:n,visits:a,settlements:r,routes:d}}catch{return{vehicles:0,vehicleInventory:0,operations:0,visits:0,settlements:0,routes:0}}}async getEntitySyncMetadata(){if(this.db||await this.initialize(),!this.db)return{};try{const e={},s=["products","partners","invoices","accounts","warehouses","payments"];for(const n of s){const r=(await this.db.query(`SELECT COUNT(*) as count FROM ${n}`)).values?.[0]?.count||0,c=(await this.db.query(`SELECT syncedAt FROM ${n} WHERE syncedAt IS NOT NULL AND syncedAt != '' ORDER BY syncedAt DESC LIMIT 1`)).values?.[0]?.syncedAt||null;e[n]={count:r,lastSync:c}}return e}catch{return{}}}async getLastSync(){const{value:e}=await Pt.get({key:Lt.LAST_SYNC});return e}async syncPendingVanSalesOperations(){const e=await this.getServerUrl(),s=await this.getAuthToken();if(!e||!s)return{success:!1,synced:0,errors:["Missing server URL or auth token"]};const n={"Content-Type":"application/json",Authorization:`Bearer ${s}`},r=(await this.db?.query(`SELECT * FROM pending_sync 
             WHERE entity LIKE 'vehicle%' OR entity LIKE 'customer_visit%' OR entity LIKE 'route%'
             AND status IN ('PENDING', 'FAILED')
             ORDER BY createdAt ASC`))?.values||[];let d=0;const c=[];for(const p of r){const y=typeof p.data=="string"?JSON.parse(p.data):p.data;try{let C="",P="POST";switch(p.entity){case"vehicle_operation":C=`/api/vehicles/${y.vehicleId}/${p.operation.toLowerCase()}`;break;case"customer_visit":C=p.operation==="CREATE"?"/api/vehicles/visits":`/api/vehicles/visits/${y.id}`,P=p.operation==="CREATE"?"POST":"PUT";break;case"vehicle_settlement":C="/api/vehicles/settlements";break;case"vehicle_route":p.operation==="CREATE"?C="/api/vehicles/routes":p.operation==="START"?C=`/api/vehicles/routes/${y.id}/start`:p.operation==="COMPLETE"&&(C=`/api/vehicles/routes/${y.id}/complete`),P=p.operation==="CREATE"?"POST":"PUT";break;case"route_stop":C=`/api/vehicles/routes/${y.routeId}/stops/${y.stopId}/complete`,P="PUT";break;default:continue}const N=await fetch(`${e}${C}`,{method:P,headers:n,body:JSON.stringify(y)});N.ok?(await this.markOperationSynced(p.id),d++):c.push(`${p.entity}: ${await N.text()}`)}catch(C){c.push(`${p.entity}: ${C.message}`)}}return{success:c.length===0,synced:d,errors:c}}async saveInvoice(e){await this.createInvoice(e,{skipPendingSync:!0})}async healthCheck(){try{if(!this.isMobile())return{ok:!0,message:"Not on mobile"};if(await this.initialize(),!this.db)return{ok:!1,message:"Database not connected"};if(!await this.verifyTables())return{ok:!1,message:"Tables missing"};const s=await this.getStats();return{ok:!0,message:`OK: ${s.products}P/${s.partners}C/${s.invoices}I`}}catch(e){return{ok:!1,message:e.message}}}async addToPendingSync(e,s,n){if(!this.db)return;const a=`PENDING_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,r=new Date().toISOString();await this.db.run(`INSERT INTO pending_sync (id, entity, operation, entityId, data, createdAt, status)
             VALUES (?, ?, ?, ?, ?, ?, ?)`,[a,e,s,n.id||null,JSON.stringify(n),r,"PENDING"])}async getPendingCount(){if(this.db||await this.initialize(),!this.db)return 0;try{return(await this.db.query("SELECT COUNT(*) as count FROM pending_sync WHERE status IN ('PENDING', 'FAILED')")).values?.[0]?.count||0}catch{return 0}}async createInvoice(e,s){if(this.db||await this.initialize(),!this.db)return{success:!1,id:"",offline:!0};try{const n=new Date().toISOString(),a=e.id||`OFFLINE_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,r=(e.lines||[]).map(U=>({productId:U.productId,productName:U.productName||U.product?.name||"",quantity:parseFloat(U.quantity)||0,price:parseFloat(U.price)||0,cost:parseFloat(U.cost)||0,discount:parseFloat(U.discount)||0,total:parseFloat(U.total)||0,unitId:U.unitId||null,unitName:U.unitName||null,conversionFactor:parseFloat(U.conversionFactor)||1,baseQuantity:parseFloat(U.baseQuantity)||parseFloat(U.quantity)||0})),d=r.reduce((U,te)=>{const V=te.quantity*te.price-(te.discount||0);return U+V},0),c=parseFloat(e.taxAmount)||0,p=parseFloat(e.discount)||parseFloat(e.globalDiscount)||0,y=parseFloat(e.whtAmount)||0,C=d+c-y,P=C-p,N=parseFloat(e.total)||0,m=Math.abs(C-N)<=1,I=Math.abs(P-N)<=1;let x=N;(!m&&!I&&r.length>0||I&&!m&&p>0)&&(x=Math.round(C*100)/100);const S=r.length>0?JSON.stringify(r):null,X=e.status||"POSTED";await this.db.run(`INSERT OR REPLACE INTO invoices 
                 (id, number, date, type, status, partnerId, partnerName, warehouseId, paymentMethod, total, discount, paidAmount, linesJson, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[a,e.number||a,e.date||n,e.type||"SALE",X,e.partnerId?String(e.partnerId):null,e.partnerName||null,e.warehouseId||null,e.paymentMethod||"CASH",x,parseFloat(e.discount)||0,parseFloat(e.paidAmount)||0,S,""]);const Y={id:a,number:e.number||a,date:e.date||n,type:e.type||"SALE",status:X,partnerId:e.partnerId,partnerName:e.partnerName||"",warehouseId:e.warehouseId,paymentMethod:e.paymentMethod||"CASH",total:x,paidAmount:parseFloat(e.paidAmount)||0,lines:r,notes:e.notes||"",salesmanId:e.salesmanId,salesmanName:e.salesmanName};return s?.skipPendingSync||await this.addToPendingSync("invoice","CREATE",Y),r.forEach((U,te)=>{}),{success:!0,id:a,offline:!0}}catch{return{success:!1,id:"",offline:!0}}}async createVanSale(e){if(this.db||await this.initialize(),!this.db)return{success:!1,id:"",offline:!0};try{const s=new Date().toISOString(),n=`VAN_SALE_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,a=e.items.reduce((c,p)=>c+p.quantity*p.price,0)-(e.discount||0),r=e.items.map(c=>({productId:c.productId,productName:c.productName,quantity:c.quantity,price:c.price,cost:c.cost||0}));for(const c of e.items)try{await this.updateVehicleInventory(e.vehicleId,c.productId,-c.quantity)}catch{}const d=JSON.stringify(r.map(c=>({...c,total:c.quantity*c.price})));return await this.db.run(`INSERT OR REPLACE INTO invoices 
                 (id, number, date, type, status, partnerId, partnerName, warehouseId, paymentMethod, total, paidAmount, linesJson, salesmanId, salesmanName, createdBy, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[n,`VAN-${Date.now()}`,s,"INVOICE_SALE","POSTED",e.customerId,e.customerName,null,e.paymentMethod||"CASH",a,e.paymentCollected||0,d,e.salesmanId||null,e.salesmanName||null,e.salesmanName||null,""]),await this.addToPendingSync("van_sale","CREATE",{id:n,vehicleId:e.vehicleId,customerId:e.customerId,customerName:e.customerName,items:r,paymentMethod:e.paymentMethod||"CASH",paymentCollected:e.paymentCollected||0,discount:e.discount||0,notes:e.notes||"",total:a,date:s}),{success:!0,id:n,offline:!0}}catch{return{success:!1,id:"",offline:!0}}}async createPayment(e){if(this.db||await this.initialize(),!this.db)return{success:!1,id:"",offline:!0};try{const s=new Date().toISOString(),n=`OFFLINE_PAY_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return await this.db.run(`INSERT INTO payments 
                 (id, type, partnerId, partnerName, amount, date, method, reference, notes, status, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[n,e.type,e.partnerId||null,e.partnerName||null,e.amount,e.date||s,e.method||"CASH",e.reference||null,e.notes||null,"PENDING",null]),await this.addToPendingSync("payment","CREATE",{...e,id:n}),{success:!0,id:n,offline:!0}}catch{return{success:!1,id:"",offline:!0}}}async createVisit(e){if(this.db||await this.initialize(),!this.db)return{success:!1,id:"",offline:!0};try{const s=new Date().toISOString(),n=`OFFLINE_VISIT_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return await this.db.run(`INSERT INTO visits 
                 (id, vehicleId, customerId, customerName, visitDate, visitType, result, 
                  invoiceId, invoiceAmount, paymentCollected, notes, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[n,e.vehicleId,e.customerId,e.customerName,e.visitDate||s,e.visitType||"UNPLANNED",e.result||"SALE",e.invoiceId||null,e.invoiceAmount||0,e.paymentCollected||0,e.notes||null,""]),await this.addToPendingSync("visit","CREATE",{id:n,vehicleId:e.vehicleId,customerId:e.customerId,customerName:e.customerName,visitType:e.visitType,result:e.result,visitDate:e.visitDate||s,notes:e.notes,invoiceId:e.invoiceId,invoiceAmount:e.invoiceAmount,paymentCollected:e.paymentCollected}),{success:!0,id:n,offline:!0}}catch{return{success:!1,id:"",offline:!0}}}async getPendingOperationsDetailed(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query(`SELECT * FROM pending_sync 
                 WHERE status IN ('PENDING', 'FAILED', 'SYNCING') 
                 ORDER BY createdAt ASC`)).values||[]).map(s=>{const n=typeof s.data=="string"?JSON.parse(s.data||"{}"):s.data;let a="";return s.entity==="invoice"?a=`فاتورة ${n.type==="SALE"?"مبيعات":n.type==="PURCHASE"?"مشتريات":"فاتورة"} - ${n.partnerName||"عميل"} - ${n.total||0} جنيه`:s.entity==="payment"?a=`${n.type==="RECEIPT"?"مقبوضات":"مدفوعات"} - ${n.partnerName||"عام"} - ${n.amount||0} جنيه`:s.entity==="visit"?a=`زيارة عميل - ${n.customerName||"غير معروف"}`:s.entity==="partner"?a=`${s.operation==="CREATE"?"إضافة":"تحديث"} عميل - ${n.name||""}`:a=`${s.entity} - ${s.operation}`,{id:s.id,entity:s.entity,operation:s.operation,entityId:s.entityId,data:n,status:s.status,retryCount:s.retryCount||0,lastError:s.lastError,nextRetryAt:s.nextRetryAt,createdAt:s.createdAt,description:a}})}catch{return[]}}async getPendingOperations(){if(this.db||await this.initialize(),!this.db)return[];try{return((await this.db.query("SELECT * FROM pending_sync WHERE status = 'PENDING' ORDER BY createdAt")).values||[]).map(s=>({id:s.id,entity:s.entity,operation:s.operation,data:JSON.parse(s.data||"{}"),createdAt:s.createdAt}))}catch{return[]}}async markOperationSynced(e){this.db&&await this.db.run("UPDATE pending_sync SET status = 'SYNCED' WHERE id = ?",[e])}async removePendingOperation(e){this.db&&await this.db.run("DELETE FROM pending_sync WHERE id = ?",[e])}async syncPendingOperations(){const n=new Date().toISOString(),r=(await this.db?.query(`SELECT * FROM pending_sync 
             WHERE status IN ('PENDING', 'FAILED') 
             AND (nextRetryAt IS NULL OR nextRetryAt <= ?)
             AND retryCount < ?
             ORDER BY createdAt ASC`,[n,5]))?.values||[];if(r.length===0)return{synced:0,failed:0};let d=0,c=0;const p=await this.getServerUrl(),y=await this.getAuthToken();if(!p)return{synced:0,failed:r.length};if(!y)return{synced:0,failed:r.length};for(const C of r){const P=typeof C.data=="string"?JSON.parse(C.data):C.data;await this.db?.run("UPDATE pending_sync SET status = 'SYNCING' WHERE id = ?",[C.id]);try{let N;if(C.entity==="van_sale"&&C.operation==="CREATE"){const m=await this.db?.query(`SELECT id, syncedAt FROM invoices 
                         WHERE partnerId = ? AND ABS(total - ?) < 0.01 
                         AND syncedAt IS NOT NULL AND syncedAt != ''
                         AND datetime(date) > datetime('now', '-5 minutes')`,[P.customerId,P.total]);if(m?.values&&m.values.length>0){await this.db?.run("UPDATE pending_sync SET status = 'SYNCED', syncedAt = ?, lastError = 'Skipped - duplicate detected locally' WHERE id = ?",[new Date().toISOString(),C.id]),d++;continue}N=await fetch(`${p}/api/vehicles/visits/sale`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({vehicleId:P.vehicleId,customerId:P.customerId,customerName:P.customerName,items:P.items,paymentMethod:P.paymentMethod||"CASH",paymentCollected:P.paymentCollected||0,discount:P.discount||0,notes:P.notes,visitDate:P.date,createAutoVisit:!0,isReturn:P.isReturn||!1,bankAccountId:P.bankAccountId,transferReference:P.transferReference,creditPaymentType:P.creditPaymentType})})}else if(C.entity==="invoice"&&C.operation==="CREATE")P.lines&&P.lines.length>0&&P.lines.forEach((m,I)=>{}),N=await fetch(`${p}/api/sync/transaction`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({invoice:P})});else if(C.entity==="payment"&&C.operation==="CREATE"){const m=P.type==="RECEIPT"?`${p}/api/treasury/receipts`:`${p}/api/treasury/payments`;N=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({partnerId:P.partnerId,partnerName:P.partnerName,amount:P.amount,date:P.date,method:P.method||"CASH",reference:P.reference,notes:P.notes,bankAccountId:P.bankAccountId,salesmanId:P.salesmanId})})}else if(C.entity==="visit"&&C.operation==="CREATE"){const m={vehicleId:P.vehicleId,customerId:P.customerId,customerName:P.customerName,visitType:P.visitType,result:P.result,visitDate:P.visitDate,notes:P.notes,invoiceId:P.invoiceId,invoiceAmount:P.invoiceAmount,paymentCollected:P.paymentCollected};N=await fetch(`${p}/api/vehicles/visits`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(m)});const I=await N.text();N=new Response(I,{status:N.status,statusText:N.statusText,headers:N.headers})}else continue;if(N.ok){const m=new Date().toISOString();await this.db?.run("UPDATE pending_sync SET status = 'SYNCED', syncedAt = ?, lastError = NULL WHERE id = ?",[m,C.id]),C.entity==="invoice"?await this.db?.run("UPDATE invoices SET status = 'CONFIRMED', syncedAt = ? WHERE id = ?",[m,P.id]):C.entity==="payment"?await this.db?.run("UPDATE payments SET status = 'SYNCED', syncedAt = ? WHERE id = ?",[m,P.id]):C.entity==="visit"&&await this.db?.run("UPDATE visits SET syncedAt = ? WHERE id = ?",[m,P.id]),d++}else if(N.status===409){const m=await N.text();await this.db?.run("UPDATE pending_sync SET status = 'CONFLICT', lastError = ? WHERE id = ?",[`Conflict: ${m}`,C.id]),c++}else throw new Error(`Server returned ${N.status}: ${await N.text()}`)}catch(N){const m=(C.retryCount||0)+1,I=2e3*Math.pow(2,m),x=new Date(Date.now()+I).toISOString(),S=m>=5?"PERMANENTLY_FAILED":"FAILED";await this.db?.run(`UPDATE pending_sync 
                     SET status = ?, retryCount = ?, lastError = ?, nextRetryAt = ?
                     WHERE id = ?`,[S,m,N.message,x,C.id]),c++}}return{synced:d,failed:c}}async startAutoSync(){if(!this.networkListenerHandle)try{const{Network:e}=await he(async()=>{const{Network:n}=await import("./index-DLk8l80k.js");return{Network:n}},__vite__mapDeps([7,2,1,3,4,5]));this.networkListenerHandle=await e.addListener("networkStatusChange",async n=>{n.connected?(this.syncDebounceTimer&&clearTimeout(this.syncDebounceTimer),this.syncDebounceTimer=setTimeout(async()=>{this.isAutoSyncRunning||await this.triggerAutoSync()},2e3)):this.syncDebounceTimer&&(clearTimeout(this.syncDebounceTimer),this.syncDebounceTimer=null)}),(await e.getStatus()).connected&&setTimeout(()=>this.triggerAutoSync(),2e3)}catch{}}async triggerAutoSync(){if(!this.isAutoSyncRunning){this.isAutoSyncRunning=!0;try{await this.getPendingCount()>0&&(await this.syncPendingOperations()).failed>0&&setTimeout(()=>this.triggerAutoSync(),3e4)}catch{}finally{this.isAutoSyncRunning=!1}}}async stopAutoSync(){this.networkListenerHandle&&(await this.networkListenerHandle.remove(),this.networkListenerHandle=null)}async isOnline(){try{const{Network:e}=await he(async()=>{const{Network:n}=await import("./index-DLk8l80k.js");return{Network:n}},__vite__mapDeps([7,2,1,3,4,5]));return(await e.getStatus()).connected}catch{try{const e=await this.getServerUrl();return e?(await fetch(`${e}/api/health`,{method:"HEAD"})).ok:!1}catch{return!1}}}async syncWithProgress(e){if(e?.("جاري التحقق من الاتصال...",0),!await this.isOnline())return e?.("لا يوجد اتصال بالإنترنت",0),{synced:0,failed:0};const n=await this.getPendingOperations();if(n.length===0)return e?.("لا توجد عمليات معلقة",100),{synced:0,failed:0};e?.(`جاري مزامنة ${n.length} عملية...`,10);const a=await this.getServerUrl(),r=await this.getAuthToken();if(!a||!r)return e?.("خطأ في الإعدادات",0),{synced:0,failed:n.length};let d=0,c=0;for(let p=0;p<n.length;p++){const y=n[p],C=Math.round((p+1)/n.length*90)+10;try{let P=!1;if(y.entity==="invoice"&&y.operation==="CREATE")e?.(`جاري مزامنة فاتورة ${p+1}/${n.length}...`,C),P=(await fetch(`${a}/api/sync/transaction`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({invoice:y.data})})).ok,P&&(await this.markOperationSynced(y.id),await this.db.run("UPDATE invoices SET status = 'CONFIRMED', syncedAt = ? WHERE id = ?",[new Date().toISOString(),y.data.id]));else if(y.entity==="payment"&&y.operation==="CREATE"){e?.(`جاري مزامنة مدفوعات ${p+1}/${n.length}...`,C);const N=y.data.type==="RECEIPT"?`${a}/api/treasury/receipts`:`${a}/api/treasury/payments`;P=(await fetch(N,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({partnerId:y.data.partnerId,amount:y.data.amount,date:y.data.date,method:y.data.method,reference:y.data.reference,notes:y.data.notes})})).ok,P&&(await this.markOperationSynced(y.id),await this.db.run("UPDATE payments SET status = 'SYNCED', syncedAt = ? WHERE id = ?",[new Date().toISOString(),y.data.id]))}P?d++:c++}catch{c++}}return e?.(d>0?`✅ تم مزامنة ${d} عملية بنجاح`:"❌ فشلت المزامنة",100),{synced:d,failed:c}}async saveExpense(e){if(this.db||await this.initialize(),!this.db)throw new Error("Database not initialized");try{await this.db.run(`INSERT OR REPLACE INTO expenses (id, category, amount, description, date, vehicleId, salesmanId, salesmanName, status, createdAt, syncedAt)
                 VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,[e.id,e.category||"OTHER",e.amount||0,e.description||"",e.date,e.vehicleId||null,e.salesmanId||null,e.salesmanName||null,e.status||"PENDING",new Date().toISOString(),null])}catch(s){throw s}}async getExpenses(e){if(this.db||await this.initialize(),!this.db)return[];try{let s="SELECT * FROM expenses ORDER BY createdAt DESC",n=[];return e&&(s="SELECT * FROM expenses WHERE date = ? ORDER BY createdAt DESC",n=[e]),(await this.db.query(s,n)).values||[]}catch{return[]}}async getExpensesForSettlement(e,s){if(this.db||await this.initialize(),!this.db)return[];try{let n='SELECT * FROM expenses WHERE date = ? AND (settlementId IS NULL OR settlementId = "") ORDER BY createdAt',a=[e];return s&&(n='SELECT * FROM expenses WHERE date = ? AND vehicleId = ? AND (settlementId IS NULL OR settlementId = "") ORDER BY createdAt',a=[e,s]),(await this.db.query(n,a)).values||[]}catch{return[]}}async deleteExpense(e){if(this.db||await this.initialize(),!this.db)throw new Error("Database not initialized");try{await this.db.run("DELETE FROM expenses WHERE id = ?",[e])}catch(s){throw s}}async markExpensesInSettlement(e,s){if(this.db||await this.initialize(),!!this.db)try{for(const n of e)await this.db.run("UPDATE expenses SET settlementId = ?, status = ? WHERE id = ?",[s,"SETTLED",n])}catch{}}async clearTodayData(e){if(this.db||await this.initialize(),!this.db)return{invoices:0,payments:0,expenses:0,visits:0};const s=e==="ALL",n=s?null:e||cn(),a={invoices:0,payments:0,expenses:0,visits:0};try{if(s){const r=await this.db.run("DELETE FROM invoices");a.invoices=r?.changes?.changes||0}else{const r=await this.db.run("DELETE FROM invoices WHERE date LIKE ?",[`${n}%`]);a.invoices=r?.changes?.changes||0}if(s){const r=await this.db.run("DELETE FROM payments");a.payments=r?.changes?.changes||0}else{const r=await this.db.run("DELETE FROM payments WHERE date LIKE ?",[`${n}%`]);a.payments=r?.changes?.changes||0}if(s){const r=await this.db.run("UPDATE expenses SET status = 'CLEARED'");a.expenses=r?.changes?.changes||0}else{const r=await this.db.run("UPDATE expenses SET status = 'CLEARED' WHERE date = ?",[n]);a.expenses=r?.changes?.changes||0}if(s){const r=await this.db.run("DELETE FROM customer_visits");a.visits=r?.changes?.changes||0}else{const r=await this.db.run("DELETE FROM customer_visits WHERE visitDate LIKE ?",[`${n}%`]);a.visits=r?.changes?.changes||0}if(s)try{await this.db.run("DELETE FROM pending_operations")}catch{}return a}catch{return a}}async checkAndClearApprovedSettlements(e){const s={cleared:!1,dates:[]};try{const n=await this.getServerUrl(),a=await this.getAuthToken();if(!n||!a)return s;const{Preferences:r}=await he(async()=>{const{Preferences:m}=await Promise.resolve().then(()=>Ho);return{Preferences:m}},void 0),{value:d}=await r.get({key:"lastProcessedSettlementId"}),{value:c}=await r.get({key:"lastProcessedSettlementTime"}),p="v4",{value:y}=await r.get({key:"settlementClearVersion"});if(y!==p){const m=await this.clearTodayData("ALL");return await r.set({key:"settlementClearVersion",value:p}),await r.remove({key:"lastProcessedSettlementId"}),await r.remove({key:"lastProcessedSettlementTime"}),s.cleared=!0,s.dates.push("ALL"),s}const C=new URL(`${n}/api/vehicles/settlements/approved`);e&&C.searchParams.set("salesmanId",e);const P=await fetch(C.toString(),{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!P.ok)return s;const N=await P.json();if(N.count>0&&N.approvedSettlements){const m=N.approvedSettlements[0],I=m?.id,x=m?.approvedAt;if(I&&I===d)return s;if(c&&x){const X=new Date(c).getTime();if(new Date(x).getTime()<=X)return s}const S=await this.clearTodayData("ALL");await r.set({key:"lastProcessedSettlementId",value:I}),await r.set({key:"lastProcessedSettlementTime",value:new Date().toISOString()});for(const X of N.approvedSettlements){const Y=X.settlementDate?.slice(0,10);Y&&s.dates.push(Y)}s.cleared=!0}return s}catch{return s}}}const Qe=new qo,mn=Object.freeze(Object.defineProperty({__proto__:null,getLocalDate:cn,unifiedStorage:Qe},Symbol.toStringTag,{value:"Module"}));function Zt(t,e){let s=null;return(...n)=>{s&&clearTimeout(s),s=setTimeout(()=>{t(...n)},e)}}function Xo(){const[t,e]=b.useState([]);b.useEffect(()=>{const a=r=>{const d=`notif-${Date.now()}-${Math.random()}`;e(c=>[...c,{...r,id:d}]),setTimeout(()=>{e(c=>c.filter(p=>p.id!==d))},5e3)};return ee.on("notification",a),()=>{ee.off("notification",a)}},[]);const s=a=>{e(r=>r.filter(d=>d.id!==a))},n=a=>{switch(a){case"success":return"bg-green-500/20 border-green-500 text-green-400";case"warning":return"bg-yellow-500/20 border-yellow-500 text-yellow-400";case"error":return"bg-red-500/20 border-red-500 text-red-400";default:return"bg-blue-500/20 border-blue-500 text-blue-400"}};return o.jsxDEV("div",{className:"fixed top-20 right-4 z-50 space-y-2 pointer-events-none",children:t.map(a=>o.jsxDEV("div",{className:`
            ${n(a.type)}
            border rounded-lg p-4 shadow-lg
            max-w-md pointer-events-auto
            animate-in slide-in-from-right duration-300
            backdrop-blur-sm
          `,children:o.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("p",{className:"font-semibold text-sm",children:a.message},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/NotificationToast.tsx",lineNumber:62,columnNumber:29},this),a.from&&o.jsxDEV("p",{className:"text-xs opacity-70 mt-1",children:["From: ",a.from]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/NotificationToast.tsx",lineNumber:64,columnNumber:33},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/NotificationToast.tsx",lineNumber:61,columnNumber:25},this),o.jsxDEV("button",{onClick:()=>s(a.id),className:"opacity-50 hover:opacity-100 transition-opacity",children:o.jsxDEV(ss,{size:16},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/NotificationToast.tsx",lineNumber:71,columnNumber:29},this)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/NotificationToast.tsx",lineNumber:67,columnNumber:25},this)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/NotificationToast.tsx",lineNumber:60,columnNumber:21},this)},a.id,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/NotificationToast.tsx",lineNumber:50,columnNumber:17},this))},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/components/NotificationToast.tsx",lineNumber:48,columnNumber:9},this)}const zo=b.lazy(()=>he(()=>import("./DashboardV2-GMjWRwvh.js").then(t=>t.D),__vite__mapDeps([8,1,3,4,9,2])).then(t=>({default:t.DashboardV2})));b.lazy(()=>he(()=>import("./Invoices-CfyXk-y0.js"),__vite__mapDeps([10,1,11,12,3,4,2,13,14,15,16,5])).then(t=>({default:t.Invoices})));const Wo=b.lazy(()=>he(()=>import("./InvoicesV2-K41XWRZo.js"),__vite__mapDeps([17,1,11,12,3,4,2,13,14,15,16,5])).then(t=>({default:t.InvoicesV2}))),Ko=b.lazy(()=>he(()=>import("./DeletedInvoices-BYWnBbFE.js"),__vite__mapDeps([18,1,12,3,4,13,2,5])).then(t=>({default:t.DeletedInvoices}))),Yo=b.lazy(()=>he(()=>import("./InventoryV2-BpyJ_Xdm.js"),__vite__mapDeps([19,15,1,3,4,16,13,12,2,5])).then(t=>({default:t.InventoryV2}))),Jo=b.lazy(()=>he(()=>import("./AccountingV2-CgPn016f.js"),__vite__mapDeps([20,1,12,3,4,13,2,16,5])).then(t=>({default:t.AccountingV2}))),Go=b.lazy(()=>he(()=>import("./TreasuryV2-1twIJLVh.js"),__vite__mapDeps([21,1,16,3,4,12,13,2,5])).then(t=>({default:t.TreasuryV2}))),Qo=b.lazy(()=>he(()=>import("./Customers-CWRHd03Q.js"),__vite__mapDeps([22,1,23,2,16,3,4,12,14,13,15,24,5])).then(t=>({default:t.Customers}))),Zo=b.lazy(()=>he(()=>import("./CustomersV2-BA1BNIxN.js"),__vite__mapDeps([25,1,23,2,16,3,4,12,14,13,15,24,5])).then(t=>({default:t.CustomersV2}))),ea=b.lazy(()=>he(()=>import("./Suppliers-DCvOJXqT.js"),__vite__mapDeps([26,1,23,2,16,3,4,12,14,13,15,27,5])).then(t=>({default:t.Suppliers}))),ta=b.lazy(()=>he(()=>import("./SuppliersV2-BBYYoH8s.js"),__vite__mapDeps([28,1,23,2,16,3,4,12,14,13,15,27,5])).then(t=>({default:t.SuppliersV2}))),sa=b.lazy(()=>he(()=>import("./Settings-aV1E7TGe.js"),__vite__mapDeps([29,1,13,3,4,2,12,30,5])).then(t=>({default:t.Settings}))),na=b.lazy(()=>he(()=>import("./MasterDataV2-CT3l-oxX.js"),__vite__mapDeps([31,1,3,4,13,2,30,5])).then(t=>({default:t.MasterDataV2}))),oa=b.lazy(()=>he(()=>import("./Manufacturing-BZz3vo-S.js"),__vite__mapDeps([32,1,13,3,4,12,2,5])).then(t=>({default:t.Manufacturing}))),Xs=b.lazy(()=>he(()=>import("./Employees-DRUCcvOL.js"),__vite__mapDeps([33,1,3,4,2,5])).then(t=>({default:t.HREmployees}))),aa=b.lazy(()=>he(()=>import("./Attendance-CmPPa6r9.js"),__vite__mapDeps([34,1,3,4,2,5])).then(t=>({default:t.HRAttendance}))),ra=b.lazy(()=>he(()=>import("./Payroll-at1elLZV.js"),__vite__mapDeps([35,1,2,3,4,5])).then(t=>({default:t.HRPayroll}))),ia=b.lazy(()=>he(()=>import("./AdvancesTemplates-CGwJdeGt.js"),__vite__mapDeps([36,1,3,4,2,5])).then(t=>({default:t.HRAdvancesTemplates}))),la=b.lazy(()=>he(()=>import("./PayrollTemplates-DcGxtIvG.js"),__vite__mapDeps([37,1,3,4,2,5])).then(t=>({default:t.PayrollTemplates}))),da=b.lazy(()=>he(()=>import("./VanSales-kuQ8Gg0T.js"),__vite__mapDeps([38,1,9,2,3,4,5])).then(t=>({default:t.VanSales}))),ua=b.lazy(()=>he(()=>import("./SalesTeam-iQ5xulAW.js"),__vite__mapDeps([39,1,4,3,12,2,5])).then(t=>({default:t.SalesTeam}))),ca=b.lazy(()=>he(()=>import("./POS-RPHZVnRy.js"),__vite__mapDeps([40,1,3,4,2,5])).then(t=>({default:t.POS}))),ma=b.lazy(()=>he(()=>import("./POSShifts-D9p0Hv85.js"),__vite__mapDeps([41,1,3,4,2,5]))),Ea=b.lazy(()=>he(()=>import("./POSReports-CWFy5HPe.js"),__vite__mapDeps([42,1,3,4,2,5]))),es=()=>o.jsxDEV("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:o.jsxDEV("div",{className:"flex flex-col items-center gap-4",children:[o.jsxDEV(ns,{className:"w-10 h-10 text-teal-500 animate-spin"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:52,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-slate-500 font-medium",children:"جاري التحميل..."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:53,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:51,columnNumber:9},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:50,columnNumber:5},void 0),fa=()=>{const[t,e]=b.useState(()=>Nt.getItem("isAuthenticated")==="true"),{invalidatePartners:s,invalidateProducts:n,invalidateInvoices:a,invalidateAccounts:r,invalidateStockPermits:d,invalidateProductStocks:c,invalidateJournals:p,invalidateBanks:y,invalidateUsers:C,invalidateSettings:P,invalidateBranches:N,invalidateWarehouses:m,invalidateCategories:I,invalidateSalesmen:x,invalidateTaxes:S,invalidateCostCenters:X,invalidateCashCategories:Y,invalidatePartnerGroups:U,invalidatePriceLists:te}=Vo(),V=Ys(),[G,ie]=b.useState(()=>{const E=window.location.hash.substring(2);return E||Nt.getItem("currentView")||"dashboard"}),[ue,h]=b.useState(!0),[k,J]=b.useState([]),[se,T]=b.useState([]),[D,oe]=b.useState([]),[ve,ge]=b.useState([]),[Ne,be]=b.useState([]),[Fe,R]=b.useState([]),[K,Q]=b.useState([]),[de,xe]=b.useState([]),[je,ke]=b.useState([]),[nt,_e]=b.useState([]),[Ye,jt]=b.useState(null),[we,Dt]=b.useState({modules:{sales:!0,purchase:!0,inventory:!0,accounting:!0,treasury:!0,banks:!0,partners:!0,manufacturing:!0}}),[Ce,Ue]=b.useState([]),[ct,Bt]=b.useState(!1),[yt,Rt]=b.useState([]),[kt,ot]=b.useState([]),[at,vt]=b.useState([]),[rt,Ct]=b.useState([]),[gt,Je]=b.useState([]),[Be,Ze]=b.useState([]),[At,$e]=b.useState([]),[It,it]=b.useState([]),[Vt,lt]=b.useState([]),[xt,ht]=b.useState([]),[Yt,et]=b.useState([]),[Et,Me]=b.useState([]),[ft,We]=b.useState([]),[qt,u]=b.useState(null),[v,M]=b.useState([]),[Ve,Z]=b.useState(!1),[$,Pe]=b.useState(!1),[re,le]=b.useState(null),[Ge,i]=b.useState(null),w=()=>{gs(),e(!1),Nt.setItem("isAuthenticated","false"),ie("dashboard"),Nt.removeItem("currentView"),window.location.hash="#/dashboard"},j=E=>{if(Ve){le(E),Pe(!0);return}ie(E),Nt.setItem("currentView",E),window.location.hash=`/${E}`},ne=()=>{re&&(Z(!1),Pe(!1),ie(re),Nt.setItem("currentView",re),window.location.hash=`/${re}`,le(null))},pe=()=>{Pe(!1),le(null)};b.useEffect(()=>{t&&(async()=>{try{if(h(!0),(()=>{try{return window.Capacitor?.isNativePlatform?.()}catch{return!1}})()){const F=setTimeout(()=>{h(!1)},8e3);try{const z=await Qe.initialize(),[A,g,me,Ee,_,ae,q]=await Promise.all([Qe.getProducts(),Qe.getPartners(),Qe.getInvoices(),Qe.getAccounts(),Qe.getWarehouses(),Qe.getCategories(),Qe.getSalesmen()]);J(A),oe(g),ge(me),R(Ee),Je(_),Ze(ae),$e(q),Dt(we),Ue([]),We([]),Ct([]),T([]),be([]),Q([]),xe([]),ke([]),_e([]),it([]),lt([]),ht([]),et([]),clearTimeout(F)}catch{const A=(g,me=[])=>{try{return JSON.parse(localStorage.getItem(g)||JSON.stringify(me))}catch{return me}};J(A("mobile_products")),oe(A("mobile_partners")),ge(A("mobile_invoices")),R(A("mobile_accounts"))}h(!1),navigator.onLine&&l.loadInitialData().then(z=>{oe(z.partners?.partners||[]),ge(z.invoices?.invoices||[]),R(z.accounts||[])}).catch(z=>{});return}const L=await l.loadInitialData();oe(L.partners.partners||[]),R(L.accounts||[]),ge(L.invoices.invoices||[]),Dt(L.config||we),Ue(L.users||[]),We(L.permissions||[]),Ct(L.branches||[]),Je(L.warehouses||[]),J([]),T([]),be([]),Q([]),xe([]),ke([]),_e([]),Ze([]),$e([]),it([]),lt([]),ht([]),et([]),h(!1),L._backgroundLoad&&L._backgroundLoad.then(F=>{Ze(F.categories||[]),$e(F.salesmen||[]),it(F.taxes||[]),lt(F.costCenters||[]),ht(F.cashCategories||[]),et(F.partnerGroups||[]),_e(F.banks||[]),Q(F.cheques||[]),ot(F.stockSessions||[]),ke(F.assets||[]),T(F.productStocks||[]),xe(F.stockPermits||[]),M(F.auditLogs||[]);const z=F.journal,A=z&&typeof z=="object"&&"journals"in z?z.journals:Array.isArray(z)?z:[];be(A)}).catch(F=>{}),l.getBOMs().then(vt).catch(console.error),l.getPriceLists().then(Me).catch(F=>{}),(!L.permissions||L.permissions.length===0)&&he(async()=>{const{DEFAULT_PERMISSIONS:F}=await Promise.resolve().then(()=>ao);return{DEFAULT_PERMISSIONS:F}},void 0).then(({DEFAULT_PERMISSIONS:F})=>{Promise.all(F.map(z=>l.createPermission(z))).then(()=>We(F)).catch(z=>{})})}catch{try{if(window.Capacitor?.isNativePlatform?.()){await Qe.initialize();const[F,z,A,g]=await Promise.all([Qe.getProducts(),Qe.getPartners(),Qe.getInvoices(),Qe.getAccounts()]);oe(z),J(F),ge(A),R(g),h(!1);return}}catch{}alert("Failed to load data from server. Check console."),h(!1)}})()},[t]);const Re=E=>({accounts:Fe,banks:nt,branches:rt,warehouses:gt,categories:Be,salesmen:At,taxes:It,"cost-centers":Vt,"cash-categories":xt,"partner-groups":Yt,"price-lists":Et,users:Ce,cheques:K,journal:Ne,boms:at,assets:je})[E],fe=(E,f)=>{const F={accounts:R,banks:_e,branches:Ct,warehouses:Je,categories:Ze,salesmen:$e,taxes:it,"cost-centers":lt,"cash-categories":ht,"partner-groups":et,"price-lists":Me,users:Ue,cheques:Q,journal:be,boms:vt,assets:ke,products:J,partners:oe,permits:xe,"stock-sessions":ot}[E];F&&F(z=>z.find(g=>g&&g.id===f.id)?z.map(g=>g&&g.id===f.id?f:g):[...z,f])},ce=(E,f)=>{const F={accounts:R,banks:_e,branches:Ct,warehouses:Je,categories:Ze,salesmen:$e,taxes:it,"cost-centers":lt,"cash-categories":ht,"partner-groups":et,"price-lists":Me,users:Ue,cheques:Q,journal:be,boms:vt,assets:ke,products:J,partners:oe,permits:xe,"stock-sessions":ot}[E];F&&F(z=>z.filter(A=>A&&A.id!==f))},qe=E=>({accounts:"Account",banks:"Bank",branches:"Branch",warehouses:"Warehouse",categories:"Category",salesmen:"Salesman",taxes:"Tax","cost-centers":"Cost Center","cash-categories":"Cash Category","partner-groups":"Partner Group","price-lists":"Price List",users:"User",cheques:"Cheque",journal:"Journal Entry",boms:"BOM",assets:"Asset",products:"Product",partners:"Partner",permits:"Stock Permit","stock-sessions":"Stock Session"})[E]||E,Le=E=>({accounts:"💰",banks:"🏦",branches:"🏢",warehouses:"📦",categories:"📁",salesmen:"👨‍💼",taxes:"📊","cost-centers":"💼","cash-categories":"💵","partner-groups":"👥","price-lists":"💲",users:"👤",cheques:"💳",journal:"📒",boms:"🔧",assets:"🏗️",products:"📦",partners:"👥",permits:"📝","stock-sessions":"📋"})[E]||"📄";if(b.useEffect(()=>{if(t){const E=Nt.getItem("authToken");if(E){(async()=>{try{if(window.Capacitor?.isNativePlatform?.()){const me=await Qe.getServerUrl();me&&ee.setMobileServerUrl(me)}}catch{}ee.connect(E)})();const L=Zt(()=>{V.refetchQueries({queryKey:["invoices"],type:"all"})},300),F=Zt(()=>{x()},500),z=Zt(()=>{n(),c()},300),A=Zt(()=>{s()},300);ee.on("connection:status",({connected:g})=>{Bt(g)}),ee.on("users:online",g=>{Rt(g)}),ee.on("invoice:new",({invoice:g,createdBy:me})=>{ge(Ee=>Ee.find(ae=>ae.id===g.id)?Ee:[g,...Ee]),L(),F()}),ee.on("invoice:changed",({invoice:g,updatedBy:me})=>{ge(Ee=>Ee.find(q=>q.id===g.id)?Ee.map(q=>q.id===g.id?g:q):Ee),L(),F()}),ee.on("invoice:removed",({id:g,deletedBy:me})=>{ge(Ee=>Ee.filter(ae=>ae.id!==g)),L(),F()}),ee.on("partner:changed",({partner:g,updatedBy:me})=>{oe(Ee=>Ee.find(ae=>ae.id===g.id)?Ee.map(ae=>ae.id===g.id?g:ae):(ee.sendNotification(`👥 New ${g.isCustomer?"customer":"supplier"} added by ${me}`,"success"),[...Ee,g])),A()}),ee.on("product:changed",({product:g,updatedBy:me})=>{J(Ee=>Ee.find(ae=>ae.id===g.id)?Ee.map(ae=>ae.id===g.id?g:ae):(ee.sendNotification(`📦 New product added by ${me}`,"success"),[...Ee,g])),z()}),ee.on("stock:updated",({productId:g,newStock:me})=>{J(Ee=>Ee.map(_=>_.id===g?{..._,stock:me}:_)),z()}),ee.on("entity:changed",({entityType:g,entity:me,updatedBy:Ee})=>{me&&(Re(g)?.find(ae=>ae.id===me.id),fe(g,me)),g==="accounts"&&r(),(g==="permits"||g==="stock-permits")&&d(),g==="journal"&&p(),g==="banks"&&y(),g==="cheques"&&V.invalidateQueries({queryKey:["cheques"]}),g==="invoice"&&(a(),x()),g==="partner"&&s(),g==="product"&&n(),g==="users"&&C(),g==="settings"&&P(),g==="branches"&&N(),g==="warehouses"&&m(),g==="categories"&&I(),g==="salesmen"&&x(),g==="taxes"&&S(),g==="cost_centers"&&X(),g==="cash_categories"&&Y(),g==="partner_groups"&&U(),g==="price_lists"&&te();const _=qe(g);ee.sendNotification(`${Le(g)} ${_} updated by ${Ee}`,"success")}),ee.on("entity:deleted",({entityType:g,entityId:me,deletedBy:Ee})=>{ce(g,me),g==="journal"&&p(),g==="banks"&&y(),g==="cheques"&&V.invalidateQueries({queryKey:["cheques"]}),(g==="stock-permits"||g==="permits")&&d(),g==="invoice"&&(a(),x()),g==="partner"&&s(),g==="accounts"&&r(),g==="product"&&n(),g==="users"&&C(),g==="branches"&&N(),g==="warehouses"&&m(),g==="categories"&&I(),g==="salesmen"&&x(),g==="taxes"&&S(),g==="cost_centers"&&X(),g==="cash_categories"&&Y(),g==="partner_groups"&&U(),g==="price_lists"&&te();const _=qe(g);ee.sendNotification(`${Le(g)} ${_} deleted by ${Ee}`,"warning")})}}return()=>ee.disconnect()},[t]),b.useEffect(()=>{ct&&ee.setCurrentView(G)},[G,ct]),b.useEffect(()=>{t&&!Gn()&&w()},[]),b.useEffect(()=>{if(!t)return;const E=()=>{Qn()};let f;const L=()=>{f||(f=setTimeout(()=>{E(),f=null},3e4))};return window.addEventListener("mousemove",L),window.addEventListener("click",E),window.addEventListener("keypress",E),()=>{window.removeEventListener("mousemove",L),window.removeEventListener("click",E),window.removeEventListener("keypress",E),f&&clearTimeout(f)}},[t]),b.useEffect(()=>{const E=()=>{G&&window.location.hash!==`#/${G}`&&(window.location.hash=`#/${G}`)},f=()=>{const L=window.location.hash.substring(2);L&&L!==G&&(ie(L),Nt.setItem("currentView",L))};return E(),window.addEventListener("hashchange",f),()=>window.removeEventListener("hashchange",f)},[G]),b.useEffect(()=>{const f={dashboard:"الشاشة الرئيسية","master-data":"البيانات الأساسية","master-customers":"تعريف العملاء","master-suppliers":"تعريف الموردين","master-branches":"تعريف الفروع","master-warehouses":"تعريف المخازن","master-categories":"فئات الأصناف","master-price-lists":"قوائم الأسعار","master-items":"كارت الصنف","master-banks":"البنوك","master-salesmen":"المندوبين",suppliers:"الموردين","sup-payments":"مدفوعات للموردين","sup-statement":"حسابات الموردين","sup-balances":"حسابات الموردين الإجمالية","sup-discount":"خصم مكتسب",customers:"العملاء","cust-payments":"مقبوضات العملاء","cust-statement":"حسابات العملاء","cust-balances":"إجمالي حسابات العملاء","cust-prices":"أسعار العملاء","cust-discount":"خصم مسموح به",invoices:"الفواتير","inv-sale":"فاتورة بيع","inv-purchase":"فاتورة شراء","inv-ret-sale":"مرتجع مبيعات","inv-ret-purchase":"مرتجع مشتريات","inv-reports":"تقارير الفواتير","inv-deleted":"الفواتير المحذوفة",inventory:"المخزون","stock-balance":"رصيد المخزن","stock-period-report":"حركة المخزن (فترة)","stock-value":"قيمة المخزون","item-movement":"تقرير الحركة المخزنية","item-profits":"أرباح الأصناف","stock-taking":"جرد المخازن","permit-in":"إذن إضافة مخزني","permit-out":"إذن صرف مخزني","permit-transfer-br":"تحويل فروع","barcode-print":"طباعة الباركود","low-stock":"نواقص المخزون",manufacturing:"التصنيع","manufacturing-dashboard":"البيانات الأساسية للتصنيع","production-orders":"أوامر التصنيع","bom-manager":"قوائم المواد","stock-movements":"حركة المخزون","banks-module":"بنوك","money-transfer":"تحويل داخلي",banks:"كشف حساب بنك",cheques:"إدارة الشيكات",treasury:"الخزينة","daily-cash":"تسجيل نقدية","cash-closing":"جرد الخزينة","treasury-journal":"يومية الخزينة","treasury-report":"تقرير الخزينة","monthly-profit":"تقرير الأرباح الشهرى",accounting:"الحسابات",journal:"قيود اليومية","general-ledger":"الأستاذ العام","bank-recon":"تسوية البنك","fixed-assets":"الأصول الثابتة",coa:"شجرة الحسابات","cost-centers":"مراكز التكلفة","trial-balance":"ميزان المراجعة","balance-sheet":"الميزانية العمومية","income-statement":"قائمة الدخل",settings:"الإعدادات",users:"إدارة المستخدمين",config:"إعدادات النظام","audit-log":"سجل المراقبة",backup:"النسخ الاحتياطي"}[G]||"DaftriX ERP";document.title=f},[G]),!t)return o.jsxDEV(bo,{onLogin:()=>{e(!0),Nt.setItem("isAuthenticated","true"),ie("dashboard"),Nt.setItem("currentView","dashboard"),window.location.hash="#/dashboard"}},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:964,columnNumber:16},void 0);if(ue)return o.jsxDEV(Os,{currentView:"dashboard",onChangeView:()=>{},onLogout:()=>{},onUpdateConfig:()=>{},systemConfig:we,children:o.jsxDEV(No,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:986,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:979,columnNumber:13},void 0);const ye=E=>we.fiscalLockDate&&E<we.fiscalLockDate?we.fiscalLockType==="WARNING"?confirm(`تنبيه: هذا التاريخ (${E}) يقع في فترة مالية مغلقة (${we.fiscalLockDate}). هل أنت متأكد من المتابعة؟`):(alert(`عذراً، لا يمكن إجراء عمليات في تاريخ (${E}) لأنه يقع في فترة مالية مغلقة (${we.fiscalLockDate}).`),!1):!0,tt=async E=>{oe(f=>[...f,E]);try{await l.syncTransaction({partners:[E]}),ee.broadcastPartnerUpdated(E)}catch{alert("Failed to save partner")}},dt=async(E,f,L)=>{const F=ve.find(q=>q.id===E.id),z=Ne.find(q=>q.referenceId===E.id),A=Ao(E,f||k,Fe,D,F,z,we,se,ve,L);F?(ge(ve.map(q=>q.id===E.id?A.invoice:q)),A.journal&&z?be(Ne.map(q=>q.id===z.id?A.journal:q)):A.journal?be([...Ne,A.journal]):!A.journal&&z&&be(Ne.filter(q=>q.id!==z.id))):(ge([...ve,A.invoice]),A.journal&&be([...Ne,A.journal])),F?ee.broadcastInvoiceUpdated(A.invoice):ee.broadcastInvoiceCreated(A.invoice),A.updatedInvoices&&A.updatedInvoices.length>0&&ge(q=>q.map(Se=>A.updatedInvoices.find(wt=>wt.id===Se.id)||Se)),F&&Q(q=>q.filter(Se=>Se.transactionId!==E.id)),A.newCheques&&A.newCheques.length>0&&Q(q=>[...q,...A.newCheques]),J(A.updatedProducts),oe(A.updatedPartners),R(A.updatedAccounts),T(A.updatedProductStocks),A.updatedPartners.forEach(q=>ee.broadcastPartnerUpdated(q)),A.updatedAccounts.forEach(q=>ee.broadcastEntityChanged("accounts",q)),A.updatedProducts.forEach(q=>ee.broadcastProductUpdated(q));const g=new Set(E.lines?.map(q=>q.productId)||[]),me=A.updatedProducts.filter(q=>g.has(q.id)),Ee=A.updatedProductStocks.filter(q=>g.has(q.productId)),_=new Set(A.journal?.lines?.map(q=>q.accountId)||[]),ae=A.updatedAccounts.filter(q=>_.has(q.id));V.setQueryData(["product-stocks"],A.updatedProductStocks),V.setQueryData(["products"],A.updatedProducts),V.setQueryData(["partners"],q=>{if(!q)return A.updatedPartners;const Se=new Map(A.updatedPartners.map(bt=>[bt.id,bt]));return q.map(bt=>Se.get(bt.id)||bt)}),V.setQueryData(["accounts"],A.updatedAccounts);try{await l.post("/invoices",{...A.invoice,bankTransfers:E.bankTransfers,paymentBreakdown:E.paymentBreakdown,transactionCheques:E.transactionCheques,paymentCollected:E.paymentCollected||0,user:JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System"})}catch{}l.syncTransaction({invoice:A.invoice,invoices:A.updatedInvoices,allocations:A.paymentAllocations,journal:A.journal||void 0,products:me,partners:A.updatedPartners,accounts:ae,cheques:A.newCheques&&A.newCheques.length>0?A.newCheques:void 0,productStocks:Ee,deletedJournalId:z&&A.journal&&z.id!==A.journal.id||!A.journal&&z?z.id:void 0,user:JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System"}).then(()=>{a()}).catch(q=>{ee.sendNotification("فشل المزامنة مع قاعدة البيانات. حاول مرة أخرى.","error")})},pt=async E=>{const f=ve.find(F=>F.id===E);if(!f)return;const L=Ne.find(F=>F.referenceId===E);try{const F=dn(f,L,k,D,Fe,we,se);J(F.updatedProducts),oe(F.updatedPartners),R(F.updatedAccounts),T(F.updatedProductStocks),ge(_=>_.filter(ae=>ae.id!==E)),L&&be(_=>_.filter(ae=>ae.id!==L.id)),Q(_=>_.filter(ae=>ae.transactionId!==E)),ee.broadcastInvoiceDeleted(E),F.updatedPartners.forEach(_=>ee.broadcastPartnerUpdated(_)),F.updatedAccounts.forEach(_=>ee.broadcastEntityChanged("accounts",_)),F.updatedProducts.forEach(_=>ee.broadcastProductUpdated(_));const z=new Set(f.lines?.map(_=>_.productId)||[]),A=F.updatedProducts.filter(_=>z.has(_.id)),g=F.updatedProductStocks.filter(_=>z.has(_.productId)),me=new Set(L?.lines?.map(_=>_.accountId)||[]),Ee=F.updatedAccounts.filter(_=>me.has(_.id));V.setQueryData(["product-stocks"],F.updatedProductStocks),V.setQueryData(["products"],F.updatedProducts),V.setQueryData(["partners"],_=>{if(!_)return F.updatedPartners;const ae=new Map(F.updatedPartners.map(q=>[q.id,q]));return _.map(q=>ae.get(q.id)||q)}),V.setQueryData(["accounts"],F.updatedAccounts),l.syncTransaction({deletedInvoiceId:E,deletedJournalId:L?.id,products:A,partners:F.updatedPartners,accounts:Ee,productStocks:g,user:JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System"}).then(()=>{a()}).catch(_=>{ee.sendNotification("فشل المزامنة مع قاعدة البيانات. حاول مرة أخرى.","error")})}catch(F){alert(`Error deleting invoice: ${F.message}`)}},Ke=async E=>{try{const L=Array.isArray(E)?E:[E];let F=[...k],z=[...Fe],A=[],g=[],me=[];for(const _ of L){const ae=de.find(q=>q.id===_.id);if(ae){if(!ye(ae.date))return;F=$s(ae,F).updatedProducts,me.push(ae.id),await l.deleteStockPermit(ae.id)}}L.forEach(_=>{if(!ye(_.date))return;const ae=Fo(_,F,z);F=ae.updatedProducts,z=ae.updatedAccounts,A.push(ae.permit),ae.journal&&g.push(ae.journal)}),xe(_=>[..._.filter(q=>!me.includes(q.id)),...A]),J(F),R(z),be(_=>[..._,...g]),A.forEach(_=>ee.broadcastEntityChanged("permits",_)),F.forEach(_=>ee.broadcastProductUpdated(_)),z.forEach(_=>ee.broadcastEntityChanged("accounts",_));for(const _ of A)await l.createStockPermit(_);await l.syncTransaction({products:F,accounts:z,journals:g.length>0?g:void 0,user:JSON.parse(localStorage.getItem("currentUser")||"{}").name||"System"});const Ee=await l.getProductStocks();T(Ee),n(),c(),d()}catch(f){alert(`فشل حفظ الإذن: ${f.message}`)}},Xt=async E=>{try{let f;Ce.find(L=>L.id===E.id)?(f=await l.updateUser(E),Ue(Ce.map(L=>L.id===E.id?f:L))):(f=await l.createUser(E),Ue([...Ce,f]))}catch(f){throw f}},us=async E=>{try{await l.deleteUser(E),Ue(Ce.filter(f=>f.id!==E))}catch(f){throw f}},cs=async E=>{try{let f;E.id&&kt.find(L=>L.id===E.id)?(f=await l.updateStockTakingSession(E),ot(L=>L.map(F=>F.id===E.id?f:F)),ee.broadcastEntityChanged("stock-sessions",f)):(f=await l.createStockTakingSession(E),ot(L=>[...L,f]),ee.broadcastEntityChanged("stock-sessions",f))}catch(f){alert(`Error saving stock session: ${f.message}`)}},fn=async E=>{if(confirm("هل أنت متأكد من حذف جلسة الجرد هذه؟"))try{await l.deleteStockTakingSession(E),ot(f=>f.filter(L=>L.id!==E)),ee.broadcastEntityDeleted("stock-sessions",E)}catch(f){alert(`Error deleting stock session: ${f.message}`)}},pn={onSave:async E=>{try{if(E.id&&Et.find(f=>f.id===E.id)){const f=await l.updatePriceList(E.id,E);Me(Et.map(L=>L.id===E.id?f:L)),ee.broadcastEntityChanged("price-lists",f)}else{const f=await l.createPriceList(E);Me([...Et,f]),ee.broadcastEntityChanged("price-lists",f)}}catch(f){alert(`Failed to save: ${f.message}`)}},onDelete:async E=>{try{await l.deletePriceList(E),Me(Et.filter(f=>f.id!==E)),ee.broadcastEntityDeleted("price-lists",E)}catch(f){alert(`Failed to delete: ${f.message}`)}},onToggle:async E=>{try{const f=await l.togglePriceListStatus(E);Me(Et.map(L=>L.id===E?f:L)),ee.broadcastEntityChanged("price-lists",f)}catch(f){alert(`Failed to toggle: ${f.message}`)}}},hn={onSave:async E=>{try{if(E.id&&ft.find(f=>f.id===E.id)){const f=await l.updatePermission(E);We(ft.map(L=>L.id===E.id?f:L))}else{const f=await l.createPermission(E);We([...ft,f])}}catch(f){alert(`Failed to save: ${f.message}`)}},onDelete:async E=>{try{await l.deletePermission(E),We(ft.filter(f=>f.id!==E))}catch(f){alert(`Failed to delete: ${f.message}`)}}},bn={onResync:async E=>{try{await l.resyncBankGL(E);const f=await l.getAccounts();R(f),alert("تم تحديث رصيد الحساب بنجاح")}catch(f){alert("Error resyncing bank: "+f.message)}}},Nn=E=>{const f=de.find(L=>L.id===E);f&&ye(f.date)&&i(E)},Rn=async()=>{if(!Ge)return;const E=Ge,f=de.find(L=>L.id===E);if(f)try{const L=$s(f,k);J(L.updatedProducts),xe(z=>z.filter(A=>A.id!==E)),L.updatedProducts.forEach(z=>ee.broadcastProductUpdated(z)),await l.deleteStockPermit(E),await l.syncTransaction({products:L.updatedProducts});const F=await l.getProductStocks();T(F),i(null)}catch(L){alert(`فشل حذف الإذن: ${L.message}`)}},Cn=async(E,f,L)=>{const F=new Date().toISOString().split("T")[0];if(!ye(F))return;const z=Array.isArray(E)?E:[E];let A=[...Fe],g=[...D],me=[...K],Ee=[],_=[];try{for(const Se of z){const bt=me.find(Jt=>Jt.id===Se.id)||Se,wt=Io(bt,f,A,g,L);A=wt.updatedAccounts,g=wt.updatedPartners,Ee.push(wt.journal),_.push(wt.updatedCheque),me=me.map(Jt=>Jt.id===wt.updatedCheque.id?wt.updatedCheque:Jt)}R(A),oe(g),Q(me),be(Se=>[...Se,...Ee]),_.forEach(Se=>ee.broadcastEntityChanged("cheques",Se)),A.forEach(Se=>ee.broadcastEntityChanged("accounts",Se)),g.forEach(Se=>ee.broadcastPartnerUpdated(Se)),Ee.forEach(Se=>ee.broadcastEntityChanged("journal",Se));const ae=new Set(Ee.flatMap(Se=>Se.lines?.map(bt=>bt.accountId)||[])),q=A.filter(Se=>ae.has(Se.id));l.syncTransaction({journals:Ee,accounts:q,partners:g,cheques:_}).then(()=>{}).catch(Se=>{}),p(),r()}catch(ae){alert(`Error: ${ae.message}`)}},Ts=(E,f)=>{if(!ye(E.date))return;const L=jo(E,f||Fe,we);Ne.some(A=>A.id===L.journal.id)?be(Ne.map(A=>A.id===L.journal.id?L.journal:A)):be([...Ne,L.journal]),R(L.updatedAccounts),ee.broadcastEntityChanged("journal",L.journal),L.updatedAccounts.forEach(A=>ee.broadcastEntityChanged("accounts",A));const F=new Set(L.journal.lines?.map(A=>A.accountId)||[]),z=L.updatedAccounts.filter(A=>F.has(A.id));l.syncTransaction({journal:L.journal,accounts:z}).then(A=>{A&&A.journal&&be(g=>g.map(me=>me.id===L.journal.id?A.journal:me))}).catch(A=>{}),p(),r()},Pn=E=>{const f=new Date().toISOString().split("T")[0];if(!ye(f))return;const L=Bo(E,Fe);be([...Ne,L.journal]),R(L.updatedAccounts),l.syncTransaction({journal:L.journal,accounts:L.updatedAccounts}),p(),r()},yn=E=>{if(!ye(E))return;const f=ko(je,E,Fe,we);ke(f.updatedAssets),R(f.updatedAccounts),be([...Ne,f.journal]),l.syncTransaction({journal:f.journal,accounts:f.updatedAccounts}),p(),r()},vn=E=>{const f=k.map(L=>{const F=E.find(z=>z.productId===L.id);return F?{...L,cost:F.newCost}:L});J(f),l.syncTransaction({products:f})},Ls=async E=>{try{const f=await l.updateSystemConfig(E);Dt(f)}catch(f){alert(`فشل حفظ الإعدادات: ${f.message}`)}};let Te;const O=G.split("|")[0];return so(O)?O==="dashboard"||O.startsWith("salesman-")?Te=o.jsxDEV(zo,{onNavigate:j,currentView:G},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1822,columnNumber:19},void 0):O==="inv-deleted"?Te=o.jsxDEV(Ko,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1828,columnNumber:19},void 0):O.startsWith("inv-")||O==="invoices"?Te=o.jsxDEV(Wo,{viewType:G,onSaveInvoice:dt,onDeleteInvoice:pt,onAddPartner:tt},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1831,columnNumber:19},void 0):O==="manufacturing"||O==="bom-manager"||O==="production-orders"||O==="stock-movements"||O==="manufacturing-dashboard"?Te=o.jsxDEV(oa,{viewType:G},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1838,columnNumber:19},void 0):O.startsWith("hr-")?O==="hr-employees"?Te=o.jsxDEV(Xs,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1842,columnNumber:23},void 0):O==="hr-attendance"?Te=o.jsxDEV(aa,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1844,columnNumber:23},void 0):O==="hr-payroll"?Te=o.jsxDEV(ra,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1846,columnNumber:23},void 0):O==="hr-advances"?Te=o.jsxDEV(ia,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1848,columnNumber:23},void 0):O==="hr-templates"?Te=o.jsxDEV(la,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1850,columnNumber:23},void 0):Te=o.jsxDEV(Xs,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1852,columnNumber:23},void 0):O==="van-sales"||O.startsWith("van-")?Te=o.jsxDEV(da,{initialTab:O},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1856,columnNumber:19},void 0):O==="sales-team"||O.startsWith("salesteam-")?Te=o.jsxDEV(ua,{viewType:O,onNavigate:j},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1859,columnNumber:19},void 0):O==="inventory"||O.startsWith("stock-")||O.startsWith("permit-")||O.startsWith("item-")||O==="barcode-print"||O==="stagnant-items"||O==="low-stock"?Te=o.jsxDEV(Yo,{viewType:G,onSavePermit:Ke,onDeletePermit:Nn,onNavigate:j,onSaveStockSession:cs,onDeleteStockSession:fn,setIsDirty:Z},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1862,columnNumber:19},void 0):O.startsWith("accounting")||O==="journal"||O==="general-ledger"||O==="trial-balance"||O==="income-statement"||O==="balance-sheet"||O==="bank-recon"||O==="fixed-assets"||O==="cost-centers"||O==="period-closing"||O==="coa"?Te=o.jsxDEV(Jo,{viewType:G,onSaveJournal:Ts,onAddAccount:E=>{l.createAccount({...E,id:E.id||Math.random().toString()}).then(f=>{R([...Fe,f])}).catch(f=>alert("فشل إضافة الحساب"))},onUpdateAccount:E=>{l.updateAccount(E).then(f=>{R(Fe.map(L=>L.id===f.id?f:L))}).catch(f=>alert("فشل تحديث الحساب"))},onDeleteAccount:E=>{confirm("هل أنت متأكد من حذف الحساب؟")&&l.deleteAccount(E).then(()=>{R(Fe.filter(f=>f.id!==E))}).catch(f=>alert("فشل حذف الحساب"))},onUpdateCostCenters:lt,onUpdateProductCost:vn,onPostDepreciation:yn,onAddAsset:E=>{ke([...je,E]),l.syncTransaction({fixedAssets:[E]}).catch(f=>{alert("فشل حفظ الأصل")})},onDeleteAsset:E=>{confirm("هل أنت متأكد من حذف هذا الأصل؟")&&(ke(je.filter(f=>f.id!==E)),l.deleteFixedAsset(E).catch(f=>{alert("فشل حذف الأصل")}))},onEditJournal:E=>{be(Ne.map(f=>f.id===E.id?E:f))},onReverseJournal:Pn},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1873,columnNumber:19},void 0):O.startsWith("treasury")||O==="cheques"||O==="banks"||O==="daily-cash"||O==="cash-in"||O==="cash-out"||O==="money-transfer"||O==="monthly-profit"||O==="installments"?Te=o.jsxDEV(Go,{viewType:G,selectedBankId:qt,onAddAccount:E=>{R([...Fe,E]),l.createAccount(E).catch(f=>{alert("فشل إنشاء الحساب")})},onSaveVoucher:dt,onSaveJournal:Ts,onChequeAction:Cn,onAddCategory:async E=>{try{await l.createMasterData("cash-categories",E);const f=await l.getMasterData("cash-categories");ht(f),Y()}catch{alert("فشل إضافة البند")}},onResync:bn.onResync,onEditJournal:E=>{l.syncTransaction({journal:E}).then(f=>{const L=f&&f.journal?f.journal:E;be(Ne.map(F=>F.id===E.id?L:F))}).catch(f=>{alert("فشل تعديل القيد")})},onDeleteJournal:E=>{confirm("هل أنت متأكد من حذف هذا القيد؟")&&l.syncTransaction({deletedJournalId:E}).then(()=>{be(Ne.filter(f=>f.id!==E))}).catch(f=>alert("فشل حذف القيد"))},onNavigate:ie},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1933,columnNumber:19},void 0):O.startsWith("cust-")?Te=o.jsxDEV(Zo,{viewType:G,onSaveTransaction:dt,onDeleteInvoice:pt,setPartners:oe,onUpdateProducts:J,onNavigate:ie},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1993,columnNumber:19},void 0):O.startsWith("sup-")?Te=o.jsxDEV(ta,{viewType:G,onSaveTransaction:dt,onDeleteInvoice:pt,setPartners:oe,onNavigate:ie},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2003,columnNumber:19},void 0):O.startsWith("master-")?Te=o.jsxDEV(na,{viewType:G,onNavigate:ie,onSelectBank:u},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2011,columnNumber:19},void 0):O==="settings"||O==="users"||O==="config"||O==="audit-log"||O==="backup"||O==="price-lists"||O==="data-migration"?Te=o.jsxDEV(sa,{viewType:G,systemConfig:we,users:Ce,priceLists:Et,setPriceLists:Me,priceListHandlers:pn,onUpdateConfig:Ls,onUpdateUsers:Ue,onSaveUser:Xt,onDeleteUser:us,permissionsList:ft,onUpdatePermissions:We,permissionHandlers:hn,salesmen:At},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2018,columnNumber:19},void 0):O==="pos-screen"?Te=o.jsxDEV(b.Suspense,{fallback:o.jsxDEV(es,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2037,columnNumber:39},void 0),children:o.jsxDEV(ca,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2038,columnNumber:13},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2037,columnNumber:19},void 0):O==="pos-shifts"?Te=o.jsxDEV(b.Suspense,{fallback:o.jsxDEV(es,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2042,columnNumber:39},void 0),children:o.jsxDEV(ma,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2043,columnNumber:13},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2042,columnNumber:19},void 0):O==="pos-reports"?Te=o.jsxDEV(b.Suspense,{fallback:o.jsxDEV(es,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2047,columnNumber:39},void 0),children:o.jsxDEV(Ea,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2048,columnNumber:13},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2047,columnNumber:19},void 0):O==="customers"?Te=o.jsxDEV(Qo,{viewType:"cust-balances",partners:D,transactions:ve,products:k,onSaveTransaction:dt,setPartners:oe},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2051,columnNumber:49},void 0):O==="suppliers"?Te=o.jsxDEV(ea,{viewType:"sup-balances",partners:D,transactions:ve,onSaveTransaction:dt,setPartners:oe},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2052,columnNumber:54},void 0):Te=o.jsxDEV("div",{className:"p-10 text-center text-slate-400",children:["Page not found: ",G]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2053,columnNumber:24},void 0):Te=o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-slate-500 p-10",children:[o.jsxDEV(zs,{size:48,className:"text-rose-400 mb-4"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1816,columnNumber:17},void 0),o.jsxDEV("h2",{className:"text-2xl font-bold text-slate-700 mb-2",children:"غير مصرح بالدخول"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1817,columnNumber:17},void 0),o.jsxDEV("p",{children:"ليس لديك صلاحية للوصول إلى هذه الصفحة."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1818,columnNumber:17},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:1815,columnNumber:13},void 0),o.jsxDEV(o.Fragment,{children:[o.jsxDEV(Xo,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2060,columnNumber:13},void 0),$&&o.jsxDEV("div",{className:"fixed inset-0 z-[300] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:o.jsxDEV("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-slate-200",children:[o.jsxDEV("div",{className:"p-6 text-center space-y-4",children:[o.jsxDEV("div",{className:"w-16 h-16 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center mx-auto mb-2",children:o.jsxDEV(_t,{size:32},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2067,columnNumber:33},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2066,columnNumber:29},void 0),o.jsxDEV("h3",{className:"text-xl font-bold text-slate-800",children:"تنبيه: تغييرات غير محفوظة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2069,columnNumber:29},void 0),o.jsxDEV("p",{className:"text-slate-500",children:"لديك تعديلات لم يتم حفظها. هل أنت متأكد من أنك تريد مغادرة الصفحة؟ ستفقد جميع التغييرات غير المحفوظة."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2070,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2065,columnNumber:25},void 0),o.jsxDEV("div",{className:"p-4 bg-slate-50 border-t border-slate-100 flex gap-3",children:[o.jsxDEV("button",{onClick:pe,className:"flex-1 py-2.5 rounded-xl font-bold text-slate-600 hover:bg-white border border-transparent hover:border-slate-200 transition-all",children:"البقاء في الصفحة"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2075,columnNumber:29},void 0),o.jsxDEV("button",{onClick:ne,className:"flex-1 py-2.5 rounded-xl font-bold bg-rose-600 text-white hover:bg-rose-700 shadow-lg",children:"مغادرة وتجاهل التغييرات"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2081,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2074,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2064,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2063,columnNumber:17},void 0),Ge&&o.jsxDEV("div",{className:"fixed inset-0 z-[300] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:o.jsxDEV("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-slate-200",children:[o.jsxDEV("div",{className:"p-6 text-center space-y-4",children:[o.jsxDEV("div",{className:"w-16 h-16 bg-rose-100 text-rose-600 rounded-full flex items-center justify-center mx-auto mb-2",children:o.jsxDEV($n,{size:32},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2098,columnNumber:33},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2097,columnNumber:29},void 0),o.jsxDEV("h3",{className:"text-xl font-bold text-slate-800",children:"حذف إذن مخزني"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2100,columnNumber:29},void 0),o.jsxDEV("p",{className:"text-slate-500",children:"هل أنت متأكد من حذف هذا الإذن؟ سيتم عكس تأثيره على المخزون نهائياً."},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2101,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2096,columnNumber:25},void 0),o.jsxDEV("div",{className:"p-4 bg-slate-50 border-t border-slate-100 flex gap-3",children:[o.jsxDEV("button",{onClick:()=>i(null),className:"flex-1 py-2.5 rounded-xl font-bold text-slate-600 hover:bg-white border border-transparent hover:border-slate-200 transition-all",children:"إلغاء"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2106,columnNumber:29},void 0),o.jsxDEV("button",{onClick:Rn,className:"flex-1 py-2.5 rounded-xl font-bold bg-rose-600 text-white hover:bg-rose-700 shadow-lg",children:"نعم، حذف"},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2112,columnNumber:29},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2105,columnNumber:25},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2095,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2094,columnNumber:17},void 0),t&&o.jsxDEV(Ro,{onLogout:w},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2125,columnNumber:33},void 0),o.jsxDEV(on,{children:o.jsxDEV(Os,{currentView:G,onChangeView:j,onlineUsers:yt,globalData:{products:k,partners:D,invoices:ve,cheques:K},onLogout:w,systemConfig:we,onUpdateConfig:Ls,onSystemReset:async()=>{if(confirm("Final Warning: This will wipe all local data. Continue?"))try{localStorage.clear(),alert("System has been reset. Reloading..."),window.location.reload()}catch{alert("Failed to reset system")}},children:o.jsxDEV(b.Suspense,{fallback:o.jsxDEV(es,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2152,columnNumber:41},void 0),children:Te},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2152,columnNumber:21},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2128,columnNumber:17},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2127,columnNumber:13},void 0)]},void 0,!0,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/App.tsx",lineNumber:2059,columnNumber:9},void 0)},pa=new Mn({defaultOptions:{queries:{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,retry:1,retryDelay:1e3,staleTime:10*60*1e3,gcTime:60*60*1e3,networkMode:"offlineFirst"},mutations:{retry:1,retryDelay:1e3}}}),ha=({children:t})=>o.jsxDEV(qn,{client:pa,children:t},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/providers/QueryProvider.tsx",lineNumber:39,columnNumber:9},void 0),En=document.getElementById("root");if(!En)throw new Error("Root element not found");const ba=xn(En);ba.render(o.jsxDEV(Ns.StrictMode,{children:o.jsxDEV(on,{children:o.jsxDEV(ha,{children:o.jsxDEV(Wn,{children:o.jsxDEV(fa,{},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/index.tsx",lineNumber:18,columnNumber:11},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/index.tsx",lineNumber:17,columnNumber:9},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/index.tsx",lineNumber:16,columnNumber:7},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/index.tsx",lineNumber:15,columnNumber:5},void 0)},void 0,!1,{fileName:"F:/Codes/ERP/18 -12 B/Cloud ERP 12-16 H/Cloud ERP/index.tsx",lineNumber:14,columnNumber:3},void 0));export{ao as $,qa as A,va as B,Ut as C,Ia as D,Aa as E,Ya as F,_a as G,ut as H,St as I,Ua as J,Ha as K,wa as L,Wa as M,Kn as N,Xa as O,Pt as P,Fa as Q,ja as R,go as S,B as T,vo as U,wo as V,xo as W,To as X,Lo as Y,ds as Z,nn as _,l as a,ho as a0,mn as a1,Da as b,ze as c,Sa as d,La as e,Oa as f,cn as g,Ba as h,$a as i,o as j,Ka as k,Va as l,za as m,Vo as n,an as o,ga as p,yo as q,$t as r,xa as s,Po as t,Qe as u,So as v,ee as w,Ta as x,Ma as y,ka as z};
